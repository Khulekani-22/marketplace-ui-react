const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BannerInnerTwo-CFvZTN5k.js","assets/index-DGewQ82u.js","assets/index-BXSesTeZ.css"])))=>i.map(i=>d[i]);
import{r as y,a as G,c as I,j as t,R as ce,w as T,b as O,_ as Ae}from"./index-DGewQ82u.js";import{M as Ee}from"./MasterLayout-XUilH42m.js";import"./iconify-Ccvq_BdY.js";const _="/api/lms",ke=ce.lazy(()=>Ae(()=>import("./BannerInnerTwo-CFvZTN5k.js"),__vite__mapDeps([0,1,2]))),X="vendors_admin_draft_v1",Z="vendors_admin_undo_v1",le="vendors_admin_history_cache_v1";function K(e){try{return typeof e=="string"?JSON.parse(e):e}catch{return null}}function J(e){return JSON.parse(JSON.stringify(e))}function se(){return Date.now().toString(36)+"-"+Math.random().toString(36).slice(2,8)}function de(e){return new Date(e).toLocaleString()}function v(e){const o=((e==null?void 0:e.email)||(e==null?void 0:e.contactEmail)||"").toLowerCase(),d=(e==null?void 0:e.socials)??{},u=String((e==null?void 0:e.vendorId)??(e==null?void 0:e.id)??(e==null?void 0:e.uid)??o??se()),g=Array.isArray(e==null?void 0:e.categories)?e.categories:typeof(e==null?void 0:e.categories)=="string"?e.categories.split(",").map(N=>N.trim()).filter(Boolean):[],w=Array.isArray(e==null?void 0:e.tags)?e.tags:typeof(e==null?void 0:e.tags)=="string"?e.tags.split(",").map(N=>N.trim()).filter(Boolean):[];return{id:u,vendorId:u,name:(e==null?void 0:e.name)??(e==null?void 0:e.companyName)??(e==null?void 0:e.vendor)??"",companyName:(e==null?void 0:e.companyName)??(e==null?void 0:e.name)??"",contactEmail:o,email:o,ownerUid:(e==null?void 0:e.ownerUid)??(e==null?void 0:e.uid)??"",website:(e==null?void 0:e.website)??"",phone:(e==null?void 0:e.phone)??"",country:(e==null?void 0:e.country)??"",city:(e==null?void 0:e.city)??"",addressLine:(e==null?void 0:e.addressLine)??"",logoUrl:(e==null?void 0:e.logoUrl)??(e==null?void 0:e.logo)??"",bannerUrl:(e==null?void 0:e.bannerUrl)??"",description:(e==null?void 0:e.description)??"",categories:g,tags:w,foundedYear:(e==null?void 0:e.foundedYear)??"",teamSize:(e==null?void 0:e.teamSize)??"",registrationNo:(e==null?void 0:e.registrationNo)??"",status:((e==null?void 0:e.status)||"pending").toLowerCase(),socials:{twitter:d.twitter??"",linkedin:d.linkedin??"",facebook:d.facebook??"",instagram:d.instagram??"",youtube:d.youtube??"",github:d.github??""},lastUpdated:(e==null?void 0:e.lastUpdated)??"",raw:e}}function Le(e=[]){const o=e.length,d=e.reduce((g,w)=>{const N=(w.status||"unknown").toLowerCase();return g[N]=(g[N]||0)+1,g},{}),u=new Set(e.flatMap(g=>Array.isArray(g.categories)?g.categories:[]).map(g=>(g||"").trim()).filter(Boolean)).size;return{total:o,categories:u,byStatus:d}}function Ue(e){var d,u,g,w,N,C;const o=((e==null?void 0:e.contactEmail)||(e==null?void 0:e.email)||"").toLowerCase();return{id:String((e==null?void 0:e.vendorId)||(e==null?void 0:e.id)||""),name:(e==null?void 0:e.name)||(e==null?void 0:e.companyName)||"",contactEmail:o,ownerUid:(e==null?void 0:e.ownerUid)||"",phone:(e==null?void 0:e.phone)||"",website:(e==null?void 0:e.website)||"",description:(e==null?void 0:e.description)||"",logoUrl:(e==null?void 0:e.logoUrl)||(e==null?void 0:e.logo)||"",bannerUrl:(e==null?void 0:e.bannerUrl)||"",country:(e==null?void 0:e.country)||"",city:(e==null?void 0:e.city)||"",addressLine:(e==null?void 0:e.addressLine)||"",socials:{twitter:((d=e==null?void 0:e.socials)==null?void 0:d.twitter)||"",linkedin:((u=e==null?void 0:e.socials)==null?void 0:u.linkedin)||"",facebook:((g=e==null?void 0:e.socials)==null?void 0:g.facebook)||"",instagram:((w=e==null?void 0:e.socials)==null?void 0:w.instagram)||"",youtube:((N=e==null?void 0:e.socials)==null?void 0:N.youtube)||"",github:((C=e==null?void 0:e.socials)==null?void 0:C.github)||""},categories:Array.isArray(e==null?void 0:e.categories)?e.categories:[],tags:Array.isArray(e==null?void 0:e.tags)?e.tags:[],foundedYear:(e==null?void 0:e.foundedYear)||"",teamSize:(e==null?void 0:e.teamSize)||"",registrationNo:(e==null?void 0:e.registrationNo)||"",status:((e==null?void 0:e.status)||"pending").toLowerCase(),kycStatus:((e==null?void 0:e.status)||"pending")==="active"?"approved":(e==null?void 0:e.kycStatus)||"pending"}}function Je(){var re;const e=y.useMemo(()=>sessionStorage.getItem("tenantId")||"vendor",[]),[o,d]=y.useState(()=>K(localStorage.getItem(X))??G),u=y.useMemo(()=>{const a=[Array.isArray(o==null?void 0:o.startups)&&o.startups,Array.isArray(o==null?void 0:o.vendors)&&o.vendors,Array.isArray(o==null?void 0:o.companies)&&o.companies].filter(Boolean),s=new Map;return a.flat().forEach(i=>{const r=v(i),l=r.email||r.vendorId||r.id;s.has(l)||s.set(l,r)}),Array.from(s.values())},[o]),g=y.useMemo(()=>{const a=new Set;return u.forEach(s=>(s.categories||[]).forEach(i=>i&&a.add(i))),["All",...Array.from(a)]},[u]),w=y.useMemo(()=>Le(u),[u]),[N,C]=y.useState(()=>JSON.stringify(o,null,2)),[$,M]=y.useState("visual"),[P,R]=y.useState(!1),[c,q]=y.useState(null),[Q,S]=y.useState(null),j=y.useRef([]),[ee,te]=y.useState(()=>K(localStorage.getItem(le))??[]);async function B(){var a,s,i;S(null),R(!0);try{const r=await I.post("/api/data/vendors/migrate-startups").then(f=>f.data||{});k(`Migrated startups → vendors (scanned: ${r.scanned??0}, created: ${r.created??0}, updated: ${r.updated??0})`);try{await T({action:"VENDORS_MIGRATE",userEmail:(a=O.currentUser)==null?void 0:a.email,targetType:"vendors",targetId:"migration",metadata:r})}catch{}let l=G;try{const{data:f}=await I.get(`${_}/live`,{headers:{"x-tenant-id":e,"cache-control":"no-cache"}});f&&(l=f)}catch{l=G}try{const f=await I.get("/api/data/vendors").then(m=>m.data||[]),p=J(l);p.startups=Array.isArray(p.startups)?p.startups:[],f.forEach(m=>{const b=v(m),x=p.startups.findIndex(A=>String(A.vendorId||A.id)===b.vendorId||(A.email||A.contactEmail||"").toLowerCase()===(b.email||"").toLowerCase()&&b.email);x>=0?p.startups[x]={...p.startups[x],...b}:p.startups.push(b)}),l=p}catch{}d(l),C(JSON.stringify(l,null,2)),localStorage.setItem(X,JSON.stringify(l)),await F()}catch(r){S(((i=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:i.message)||(r==null?void 0:r.message)||"Migration failed")}finally{R(!1)}}const[z,n]=y.useState("All"),[E,D]=y.useState("All"),[L,ae]=y.useState(""),[W,H]=y.useState(((re=u[0])==null?void 0:re.vendorId)||""),me=y.useMemo(()=>u.filter(a=>{var s;return!(z!=="All"&&(a.status||"").toLowerCase()!==z||E!=="All"&&!((s=a.categories)!=null&&s.includes(E))||L&&!`${a.name} ${a.companyName} ${a.email} ${a.vendorId} ${a.city} ${a.country}`.toLowerCase().includes(L.toLowerCase()))}),[u,z,E,L]),h=y.useMemo(()=>u.find(a=>a.vendorId===W),[u,W]);function k(a){q(a),setTimeout(()=>q(null),2500)}function ue(a){const s=K(localStorage.getItem(Z))??[];s.unshift(a);const i=s.slice(0,10);localStorage.setItem(Z,JSON.stringify(i)),j.current=i}function V(a){ue(o),d(a),C(JSON.stringify(a,null,2)),localStorage.setItem(X,JSON.stringify(a))}function pe(a){var f,p;if(!h)return;const s=J(o),i=["startups","vendors","companies"];let r=!1;for(const m of i){if(!Array.isArray(s[m]))continue;const b=s[m].findIndex(x=>String(x.vendorId??x.id??x.uid)===h.vendorId||x.email&&x.email.toLowerCase()===h.email);b>=0&&(s[m][b]={...s[m][b],...a,vendorId:h.vendorId,id:h.vendorId},r=!0)}r||(s.startups=Array.isArray(s.startups)?s.startups:[],s.startups.push({...h.raw,...a,vendorId:h.vendorId,id:h.vendorId})),V(s);try{const m=h.status;typeof a.status<"u"&&a.status!==m?T({action:"VENDOR_STATUS_CHANGE",userEmail:(f=O.currentUser)==null?void 0:f.email,targetType:"vendor",targetId:h.vendorId,metadata:{from:m,to:a.status,email:h.email}}):T({action:"VENDOR_UPDATE",userEmail:(p=O.currentUser)==null?void 0:p.email,targetType:"vendor",targetId:h.vendorId,metadata:{patch:a,email:h.email}})}catch{}const l=Ue({...h,...a});if(l.name&&l.contactEmail&&l.id){if(!O.currentUser){S("Please sign in to save vendor changes.");return}(async()=>{var m,b,x,A,ne;try{await I.put(`/api/data/vendors/${encodeURIComponent(l.id)}`,l),k("Saved to API")}catch(U){const ie=(m=U==null?void 0:U.response)==null?void 0:m.status,oe=((x=(b=U==null?void 0:U.response)==null?void 0:b.data)==null?void 0:x.message)||(U==null?void 0:U.message)||"Failed to save vendor to API";if(ie===404||ie===400)try{await I.post("/api/data/vendors",l),k("Created vendor in API");return}catch(Y){const Ie=((ne=(A=Y==null?void 0:Y.response)==null?void 0:A.data)==null?void 0:ne.message)||(Y==null?void 0:Y.message)||oe;S(Ie);return}S(oe)}})()}}function he(){var r;const a=prompt("Vendor/company name?");if(!a)return;const s=se(),i=J(o);i.startups=Array.isArray(i.startups)?i.startups:[],i.startups.push(v({id:s,vendorId:s,name:a,companyName:a,status:"pending",email:""})),V(i),H(s);try{T({action:"VENDOR_CREATE",userEmail:(r=O.currentUser)==null?void 0:r.email,targetType:"vendor",targetId:s,metadata:{name:a}})}catch{}}function ge(){var r;if(!h)return;const a=se(),s=J(h);s.vendorId=a,s.id=a,s.name=`${s.name||s.companyName||"Vendor"} (Copy)`;const i=J(o);i.startups=Array.isArray(i.startups)?i.startups:[],i.startups.push(s),V(i),H(a);try{T({action:"VENDOR_DUPLICATE",userEmail:(r=O.currentUser)==null?void 0:r.email,targetType:"vendor",targetId:a,metadata:{sourceId:h.vendorId}})}catch{}}function xe(){var s,i;if(!h||!window.confirm(`Delete "${h.name||h.companyName||h.email}"?`))return;const a=J(o);["startups","vendors","companies"].forEach(r=>{Array.isArray(a[r])&&(a[r]=a[r].filter(l=>String(l.vendorId??l.id??l.uid)!==h.vendorId&&(l.email||"").toLowerCase()!==h.email))}),V(a),H(((i=(s=a==null?void 0:a.startups)==null?void 0:s[0])==null?void 0:i.vendorId)||"")}function fe(){const a=j.current.length>0?j.current:K(localStorage.getItem(Z))??[];if(!a.length)return;const s=a.shift();j.current=a,localStorage.setItem(Z,JSON.stringify(a)),d(s),C(JSON.stringify(s,null,2))}y.useEffect(()=>{(async()=>{var a,s,i;R(!0);try{let r=G;try{const{data:f}=await I.get(`${_}/live`,{headers:{"x-tenant-id":e,"cache-control":"no-cache"}});f&&(r=f)}catch{r=G}try{const f=await I.get("/api/data/vendors").then(m=>m.data||[]),p=J(r);p.startups=Array.isArray(p.startups)?p.startups:[],f.forEach(m=>{const b=v(m),x=p.startups.findIndex(A=>String(A.vendorId||A.id)===b.vendorId||(A.email||A.contactEmail||"").toLowerCase()===(b.email||"").toLowerCase()&&b.email);x>=0?p.startups[x]={...p.startups[x],...b}:p.startups.push(b)}),r=p}catch{}d(r),C(JSON.stringify(r,null,2)),localStorage.setItem(X,JSON.stringify(r));const l=((a=r==null?void 0:r.startups)==null?void 0:a[0])||((s=r==null?void 0:r.vendors)==null?void 0:s[0])||((i=r==null?void 0:r.companies)==null?void 0:i[0]);H(String((l==null?void 0:l.vendorId)??(l==null?void 0:l.id)??"")||""),await F()}catch{}finally{R(!1)}})()},[]);async function F(){try{const{data:a}=await I.get(`${_}/checkpoints`,{headers:{"x-tenant-id":e,"cache-control":"no-cache"}}),s=Array.isArray(a==null?void 0:a.items)?a.items:[];te(s),localStorage.setItem(le,JSON.stringify(s.slice(0,2)))}catch{}}async function be(){var a;S(null),R(!0);try{await I.put(`${_}/publish`,{data:o},{headers:{"Content-Type":"application/json","x-tenant-id":e}}),k("Published vendor directory to live");try{await T({action:"VENDORS_PUBLISH",userEmail:(a=O.currentUser)==null?void 0:a.email,targetType:"appData",targetId:"vendors",metadata:{count:u.length}})}catch{}await F()}catch(s){S(s.message||"Publish failed")}finally{R(!1)}}async function ye(a){var s;try{await I.post(`${_}/checkpoints`,{message:a||"Vendor admin update",data:o},{headers:{"Content-Type":"application/json","x-tenant-id":e}}),k("Checkpoint saved");try{await T({action:"VENDORS_CHECKPOINT",userEmail:(s=O.currentUser)==null?void 0:s.email,targetType:"vendors",targetId:"checkpoint",metadata:{message:a||""}})}catch{}await F()}catch(i){S(i.message||"Failed to save checkpoint")}}async function Ne(a){if(window.confirm("Restore this snapshot to LIVE appData.json?"))try{await I.post(`${_}/restore/${a}`,null,{headers:{"x-tenant-id":e}}),k("Restored snapshot"),await F();try{const{data:s}=await I.get(`${_}/live`,{headers:{"x-tenant-id":e,"cache-control":"no-cache"}});s&&V(s)}catch{}}catch(s){S(s.message||"Restore failed")}}async function je(){var a;if(window.confirm("Delete ALL checkpoints on the server?"))try{await I.delete(`${_}/checkpoints`,{headers:{"x-tenant-id":e}}),k("Cleared history");try{await T({action:"VENDORS_HISTORY_CLEAR",userEmail:(a=O.currentUser)==null?void 0:a.email,targetType:"vendors",targetId:"history"})}catch{}await F()}catch(s){S(s.message||"Failed to clear")}}function we(){try{const a=new Blob([JSON.stringify(o,null,2)],{type:"application/json;charset=utf-8"}),s=URL.createObjectURL(a),i=document.createElement("a");i.href=s;const r=new Date().toISOString().replace(/[:.]/g,"-");i.download=`appData-${e}-${r}.json`,document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(s),k("Exported current working copy")}catch(a){S("Export failed: "+((a==null?void 0:a.message)||"unknown error"))}}function Se(a){return!a||typeof a!="object"?"File is not valid JSON.":!Array.isArray(a.startups)&&!Array.isArray(a.vendors)&&!Array.isArray(a.companies)?"JSON should include vendors in startups[] or vendors[].":null}async function Ce(a){var i,r,l,f;S(null);const s=(i=a.target.files)==null?void 0:i[0];if(s)try{const p=await s.text(),m=K(p),b=Se(m);if(b){S(b);return}V(m);const x=((r=m==null?void 0:m.startups)==null?void 0:r[0])||((l=m==null?void 0:m.vendors)==null?void 0:l[0])||((f=m==null?void 0:m.companies)==null?void 0:f[0]);H(String((x==null?void 0:x.vendorId)??(x==null?void 0:x.id)??"")||""),k(`Imported ${s.name}`)}catch(p){S("Import failed: "+((p==null?void 0:p.message)||"unknown error"))}finally{a.target.value=""}}return t.jsx(Ee,{children:t.jsxs("div",{className:"container py-4",children:[t.jsx(ce.Suspense,{fallback:null,children:t.jsx("div",{className:"row mb-3",children:t.jsx(ke,{})})}),t.jsxs("div",{className:"row g-3 mb-3",children:[t.jsx("div",{className:"col-md-3 col-sm-6",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 bg-gradient-start-5 bg-animated-gradient text-center p-3",children:[t.jsx("i",{className:"bi bi-people text-primary fs-3 mb-2"}),t.jsx("h6",{className:"fw-bold mb-0",children:w.total}),t.jsx("small",{className:"text-muted",children:"Vendors"})]})}),t.jsx("div",{className:"col-md-3 col-sm-6",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 text-center p-3",children:[t.jsx("i",{className:"bi bi-grid text-success fs-3 mb-2"}),t.jsx("h6",{className:"fw-bold mb-0",children:w.categories}),t.jsx("small",{className:"text-muted",children:"Categories"})]})}),t.jsx("div",{className:"col-md-6 col-sm-12",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 p-3",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsx("i",{className:"bi bi-flag text-danger fs-4"}),t.jsx("div",{className:"fw-semibold",children:"Status"})]}),t.jsxs("span",{className:"badge text-bg-light",children:[Object.values(w.byStatus||{}).reduce((a,s)=>a+s,0)," total"]})]}),(()=>{const a=r=>r==="active"?"success":r==="pending"?"warning":r==="suspended"?"danger":"secondary",s=Object.entries(w.byStatus||{}),i=s.reduce((r,[,l])=>r+l,0);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"progress",style:{height:10},"aria-label":"Status proportions",children:s.map(([r,l])=>{const f=i?Math.round(l/i*100):0;return t.jsx("div",{className:`progress-bar bg-${a(r)}`,role:"progressbar",style:{width:`${f}%`},"aria-valuenow":f,"aria-valuemin":0,"aria-valuemax":100,title:`${r}: ${l} (${f}%)`},r)})}),t.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:s.map(([r,l])=>t.jsxs("span",{className:`d-inline-flex align-items-center gap-2 px-2 py-1 rounded-pill border border-${a(r)} text-${a(r)} bg-${a(r)}-subtle small`,children:[t.jsx("i",{className:`bi ${r==="active"?"bi-check-circle":r==="pending"?"bi-hourglass-split":"bi-pause-circle"}`}),t.jsx("span",{className:"text-capitalize",children:r}),t.jsx("span",{className:"badge text-bg-light",children:l})]},r))})]})})()]})})]}),t.jsxs("div",{className:"pt-4 d-flex gap-2 mb-3",children:[t.jsxs("label",{className:"btn btn-light mb-0",children:["Import JSON",t.jsx("input",{type:"file",accept:"application/json",hidden:!0,onChange:Ce})]}),t.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white",onClick:we,children:"Export Current"}),t.jsx("button",{className:"btn btn-outline-warning",onClick:()=>{if(P)return;window.confirm("This will convert all items under 'startups' into 'vendors' (idempotent) and clear startups. Proceed?")&&B()},disabled:P,title:"Convert all startups to vendors and upsert into vendor directory",children:"Migrate startups → vendors"}),t.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:be,disabled:P,title:"Write working copy to live appData.json on the server",children:P?"Publishing…":"Publish to live"})]}),c&&t.jsx("div",{className:"alert alert-success py-2",children:c}),Q&&t.jsx("div",{className:"alert alert-danger py-2",children:Q}),t.jsx(Oe,{onSave:ye,onClear:je,onUndo:fe,disabled:P}),t.jsxs("div",{className:"d-flex gap-3",children:[t.jsxs("div",{className:"flex-grow-1",children:[t.jsxs("ul",{className:"nav nav-tabs mb-3",children:[t.jsx("li",{className:"nav-item",children:t.jsx("button",{className:`nav-link ${$==="visual"?"active":""}`,onClick:()=>M("visual"),children:"Visual editor"})}),t.jsx("li",{className:"nav-item",children:t.jsx("button",{className:`nav-link ${$==="json"?"active":""}`,onClick:()=>M("json"),children:"JSON editor"})})]}),$==="json"?t.jsx(_e,{text:N,setText:C,onApply:()=>{const a=K(N);if(!a){S("Invalid JSON");return}V(a),k("Applied JSON to working copy")}}):t.jsx($e,{vendors:u,category:E,setCategory:D,status:z,setStatus:n,allCategories:g,search:L,setSearch:ae,filtered:me,selectedId:W,setSelectedId:H,selected:h,addVendor:he,duplicateVendor:ge,deleteVendor:xe,updateVendor:pe,doSetData:V,data:o})]}),t.jsx("div",{style:{width:380},children:t.jsx(Re,{items:ee,onRestore:Ne})})]})]})})}function Oe({onSave:e,onClear:o,onUndo:d,disabled:u}){const[g,w]=y.useState("");return t.jsxs("div",{className:"d-flex align-items-center gap-2 mb-3",children:[t.jsx("input",{className:"form-control",placeholder:"Checkpoint message (e.g. 'Approved vendors batch #3')",value:g,onChange:N=>w(N.target.value)}),t.jsx("button",{className:"btn btn-sm rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:()=>e(g),disabled:u,children:"Save checkpoint"}),t.jsx("button",{className:"btn btn-sm rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white",onClick:o,children:"Clear history"}),t.jsx("button",{className:"btn btn-outline-secondary",onClick:d,children:"Undo"})]})}function _e({text:e,setText:o,onApply:d}){return t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header fw-semibold",children:"Working copy (JSON)"}),t.jsxs("div",{className:"card-body",children:[t.jsx("textarea",{value:e,onChange:u=>o(u.target.value),rows:22,spellCheck:!1,className:"form-control font-monospace"}),t.jsxs("div",{className:"d-flex justify-content-between mt-2",children:[t.jsxs("small",{className:"text-muted",children:["Tip: Press ",t.jsx("kbd",{children:"⌘/Ctrl"}),"+",t.jsx("kbd",{children:"A"})," then ",t.jsx("kbd",{children:"⌘/Ctrl"}),"+",t.jsx("kbd",{children:"C"})," to copy."]}),t.jsx("button",{className:"btn btn-outline-primary",onClick:d,children:"Apply JSON"})]})]})]})}function $e(e){const{vendors:o,category:d,setCategory:u,status:g,setStatus:w,allCategories:N,search:C,setSearch:$,filtered:M,selectedId:P,setSelectedId:R,selected:c,addVendor:q,duplicateVendor:Q,deleteVendor:S,updateVendor:j,doSetData:ee,data:te}=e;function B(n){c&&j({status:n,lastUpdated:new Date().toISOString()})}function z(){if(!c)return;const n=c.vendorId,E=(c.email||c.contactEmail||"").toLowerCase(),D=J(te);D.services=Array.isArray(D.services)?D.services:[],D.services=D.services.map(L=>{const ae=String(L.vendorId||"")===String(n),W=(L.contactEmail||"").toLowerCase()===E;return ae||W?{...L,vendor:c.name||c.companyName||""}:L}),ee(D)}return t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[t.jsx("span",{className:"fw-semibold",children:"Vendor approvals"}),t.jsx("span",{className:"text-muted small",children:"CRUD for vendor directory"})]}),t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"row g-2 align-items-end mb-3",children:[t.jsxs("div",{className:"col-12 col-md-3",children:[t.jsx("label",{className:"form-label",children:"Status"}),t.jsx("select",{className:"form-select",value:g,onChange:n=>w(n.target.value),children:["All","active","pending","suspended"].map(n=>t.jsx("option",{value:n,children:n},n))})]}),t.jsxs("div",{className:"col-12 col-md-3",children:[t.jsx("label",{className:"form-label",children:"Category"}),t.jsx("select",{className:"form-select",value:d,onChange:n=>u(n.target.value),children:N.map(n=>t.jsx("option",{value:n,children:n},n))})]}),t.jsxs("div",{className:"col",children:[t.jsx("label",{className:"form-label",children:"Search"}),t.jsx("input",{className:"form-control",placeholder:"Name, email, vendorId, city, country…",value:C,onChange:n=>$(n.target.value)})]}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 w-100",onClick:q,children:"+ Add vendor"})}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white w-100",onClick:Q,disabled:!c,children:"Duplicate"})}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn btn-danger-500 rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white w-100",onClick:S,disabled:!c,children:"Delete"})})]}),t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-4",children:[t.jsxs("div",{className:"list-group mb-2",style:{maxHeight:480,overflow:"auto"},children:[M.map(n=>t.jsxs("button",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center "+(P===n.vendorId?"active":""),onClick:()=>R(n.vendorId),title:n.email||"",children:[t.jsxs("span",{className:"text-truncate",children:[n.name||n.companyName||"(unnamed)",t.jsx("span",{className:"text-muted",children:" · "}),t.jsx("span",{className:"text-truncate",children:n.email||"—"})]}),t.jsx("span",{className:"badge text-uppercase "+(n.status==="active"?"text-bg-success":n.status==="pending"?"text-bg-warning":"text-bg-danger"),children:n.status||"—"})]},n.vendorId)),!M.length&&t.jsx("div",{className:"text-muted small p-2",children:"No vendors match your filters."})]}),t.jsxs("div",{className:"small text-muted",children:["Showing ",M.length," of ",o.length]})]}),t.jsx("div",{className:"col",children:c?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"row g-3",children:[t.jsxs("div",{className:"col-md-8",children:[t.jsx("label",{className:"form-label",children:"Company / Vendor name"}),t.jsx("input",{className:"form-control",value:c.name||"",onChange:n=>j({name:n.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Contact email"}),t.jsx("input",{className:"form-control",value:c.email||"",onChange:n=>j({email:n.target.value.toLowerCase(),contactEmail:n.target.value.toLowerCase()})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Website"}),t.jsx("input",{className:"form-control",value:c.website||"",onChange:n=>j({website:n.target.value})})]}),t.jsxs("div",{className:"col-md-3",children:[t.jsx("label",{className:"form-label",children:"Phone"}),t.jsx("input",{className:"form-control",value:c.phone||"",onChange:n=>j({phone:n.target.value})})]}),t.jsxs("div",{className:"col-md-3",children:[t.jsx("label",{className:"form-label",children:"Founded (year)"}),t.jsx("input",{className:"form-control",value:c.foundedYear||"",onChange:n=>j({foundedYear:n.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Country"}),t.jsx("input",{className:"form-control",value:c.country||"",onChange:n=>j({country:n.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"City"}),t.jsx("input",{className:"form-control",value:c.city||"",onChange:n=>j({city:n.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Team size"}),t.jsx("input",{className:"form-control",value:c.teamSize||"",onChange:n=>j({teamSize:n.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Logo URL"}),t.jsx("input",{className:"form-control",value:c.logoUrl||"",onChange:n=>j({logoUrl:n.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Banner URL"}),t.jsx("input",{className:"form-control",value:c.bannerUrl||"",onChange:n=>j({bannerUrl:n.target.value})})]}),t.jsxs("div",{className:"col-12",children:[t.jsx("label",{className:"form-label",children:"Description"}),t.jsx("textarea",{className:"form-control",rows:4,value:c.description||"",onChange:n=>j({description:n.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Categories (comma-separated)"}),t.jsx("input",{className:"form-control",value:(c.categories||[]).join(", "),onChange:n=>j({categories:n.target.value.split(",").map(E=>E.trim()).filter(Boolean)})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Tags (comma-separated)"}),t.jsx("input",{className:"form-control",value:(c.tags||[]).join(", "),onChange:n=>j({tags:n.target.value.split(",").map(E=>E.trim()).filter(Boolean)})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Status"}),t.jsxs("select",{className:"form-select",value:c.status||"pending",onChange:n=>B(n.target.value),children:[t.jsx("option",{value:"active",children:"active"}),t.jsx("option",{value:"pending",children:"pending"}),t.jsx("option",{value:"suspended",children:"suspended"})]})]}),t.jsxs("div",{className:"col-md-6 d-flex align-items-end gap-2",children:[t.jsx("button",{className:"btn btn-success",type:"button",onClick:()=>B("active"),children:"Approve"}),t.jsx("button",{className:"btn btn-warning",type:"button",onClick:()=>B("pending"),children:"Mark pending"}),t.jsx("button",{className:"btn btn-danger",type:"button",onClick:()=>B("suspended"),children:"Suspend"})]}),t.jsxs("div",{className:"col-12",children:[t.jsxs("div",{className:"border rounded p-2",children:[t.jsx("div",{className:"text-muted small mb-1",children:"Profile preview"}),t.jsxs("div",{className:"d-flex align-items-center gap-3",children:[t.jsx("img",{src:c.logoUrl||"/assets/images/placeholder-1x1.png",alt:"logo",style:{width:64,height:64,objectFit:"cover",borderRadius:8}}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:c.name||"Vendor"}),t.jsx("div",{className:"text-muted small",children:c.email||"email"}),t.jsx("div",{className:"small",children:c.website?t.jsx("a",{href:c.website,target:"_blank",rel:"noreferrer",children:c.website}):"website"})]})]}),t.jsxs("div",{className:"d-flex gap-2 mt-3",children:[t.jsx("a",{className:"btn btn-outline-primary",href:`/profile-vendor?vendorId=${encodeURIComponent(c.vendorId)}`,target:"_blank",rel:"noreferrer",children:"Open profile"}),t.jsx("button",{className:"btn btn-outline-secondary",type:"button",onClick:z,children:"Propagate name to listings"})]})]}),c.lastUpdated&&t.jsxs("div",{className:"form-text mt-1",children:["Last updated: ",de(c.lastUpdated)]})]})]})}):t.jsx("div",{className:"text-muted mt-2",children:"Select a vendor to review."})})]})]})]})}function Re({items:e,onRestore:o}){return t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header fw-semibold d-flex justify-content-between",children:[t.jsx("span",{children:"Version history"}),t.jsx("span",{className:"text-muted small",children:"Latest checkpoints"})]}),t.jsxs("div",{className:"list-group list-group-flush",children:[!(e!=null&&e.length)&&t.jsxs("div",{className:"list-group-item text-muted small",children:["No checkpoints yet.",t.jsx("div",{className:"mt-1",children:"Offline cache keeps the two most recent checkpoints."})]}),e==null?void 0:e.map(d=>{var u,g,w,N,C,$;return t.jsx("div",{className:"list-group-item",children:t.jsxs("div",{className:"d-flex justify-content-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:d.message||"(no message)"}),t.jsx("div",{className:"text-muted small",children:de(d.ts)}),t.jsxs("div",{className:"text-muted small",children:["Δ Cohorts: ",((u=d.delta)==null?void 0:u.cohorts)>=0?"+":"",((g=d.delta)==null?void 0:g.cohorts)??0," · Δ Courses: ",((w=d.delta)==null?void 0:w.courses)>=0?"+":"",((N=d.delta)==null?void 0:N.courses)??0," · Δ Lessons: ",((C=d.delta)==null?void 0:C.lessons)>=0?"+":"",(($=d.delta)==null?void 0:$.lessons)??0]})]}),t.jsxs("div",{className:"d-flex align-items-start gap-2",children:[t.jsx("button",{className:"btn btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 btn-sm",title:"Restore snapshot to LIVE",onClick:()=>o(d.id),children:"Restore"}),t.jsx("a",{className:"btn btn-outline-secondary btn-sm",title:"Download snapshot JSON",href:`${_}/checkpoints/${d.id}`,target:"_blank",rel:"noreferrer",children:"Download"})]})]})},d.id)})]})]})}export{Je as default};
