const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BannerInnerTwo-B1cvCh8v.js","assets/index-Bn5LcKgl.js","assets/vendor-DW3XjTa1.js","assets/firebase-BBiW2ZCr.js","assets/utils-B2rxisVD.js","assets/index-ByjqTe23.css"])))=>i.map(i=>d[i]);
import{l as q,b as v,j as e,M as Se,w as E,a as S,_ as Ce}from"./index-Bn5LcKgl.js";import{r as u,R as Ie}from"./vendor-DW3XjTa1.js";import"./firebase-BBiW2ZCr.js";import"./utils-B2rxisVD.js";const C="/api/lms";Ie.lazy(()=>Ce(()=>import("./BannerInnerTwo-B1cvCh8v.js"),__vite__mapDeps([0,1,2,3,4,5])));const Q="vendors_admin_draft_v1",X="vendors_admin_undo_v1",re="vendors_admin_history_cache_v1";function M(t){try{return typeof t=="string"?JSON.parse(t):t}catch{return null}}function k(t){return JSON.parse(JSON.stringify(t))}function ae(){return Date.now().toString(36)+"-"+Math.random().toString(36).slice(2,8)}function ne(t){return new Date(t).toLocaleString()}function Z(t){const c=(t?.email||t?.contactEmail||"").toLowerCase(),m=t?.socials??{},h=String(t?.vendorId??t?.id??t?.uid??c??ae()),f=Array.isArray(t?.categories)?t.categories:typeof t?.categories=="string"?t.categories.split(",").map(y=>y.trim()).filter(Boolean):[],N=Array.isArray(t?.tags)?t.tags:typeof t?.tags=="string"?t.tags.split(",").map(y=>y.trim()).filter(Boolean):[];return{id:h,vendorId:h,name:t?.name??t?.companyName??t?.vendor??"",companyName:t?.companyName??t?.name??"",contactEmail:c,email:c,ownerUid:t?.ownerUid??t?.uid??"",website:t?.website??"",phone:t?.phone??"",country:t?.country??"",city:t?.city??"",addressLine:t?.addressLine??"",logoUrl:t?.logoUrl??t?.logo??"",bannerUrl:t?.bannerUrl??"",description:t?.description??"",categories:f,tags:N,foundedYear:t?.foundedYear??"",teamSize:t?.teamSize??"",registrationNo:t?.registrationNo??"",status:(t?.status||"pending").toLowerCase(),socials:{twitter:m.twitter??"",linkedin:m.linkedin??"",facebook:m.facebook??"",instagram:m.instagram??"",youtube:m.youtube??"",github:m.github??""},lastUpdated:t?.lastUpdated??"",raw:t}}function Ae(t=[]){const c=t.length,m=t.reduce((f,N)=>{const y=(N.status||"unknown").toLowerCase();return f[y]=(f[y]||0)+1,f},{}),h=new Set(t.flatMap(f=>Array.isArray(f.categories)?f.categories:[]).map(f=>(f||"").trim()).filter(Boolean)).size;return{total:c,categories:h,byStatus:m}}function Ee(t){const c=(t?.contactEmail||t?.email||"").toLowerCase();return{id:String(t?.vendorId||t?.id||""),name:t?.name||t?.companyName||"",contactEmail:c,ownerUid:t?.ownerUid||"",phone:t?.phone||"",website:t?.website||"",description:t?.description||"",logoUrl:t?.logoUrl||t?.logo||"",bannerUrl:t?.bannerUrl||"",country:t?.country||"",city:t?.city||"",addressLine:t?.addressLine||"",socials:{twitter:t?.socials?.twitter||"",linkedin:t?.socials?.linkedin||"",facebook:t?.socials?.facebook||"",instagram:t?.socials?.instagram||"",youtube:t?.socials?.youtube||"",github:t?.socials?.github||""},categories:Array.isArray(t?.categories)?t.categories:[],tags:Array.isArray(t?.tags)?t.tags:[],foundedYear:t?.foundedYear||"",teamSize:t?.teamSize||"",registrationNo:t?.registrationNo||"",status:(t?.status||"pending").toLowerCase(),kycStatus:(t?.status||"pending")==="active"?"approved":t?.kycStatus||"pending"}}function De(){const t=u.useMemo(()=>sessionStorage.getItem("tenantId")||"vendor",[]),[c,m]=u.useState(()=>M(localStorage.getItem(Q))??q),h=u.useMemo(()=>{const s=[Array.isArray(c?.startups)&&c.startups,Array.isArray(c?.vendors)&&c.vendors,Array.isArray(c?.companies)&&c.companies].filter(Boolean),r=new Map;return s.flat().forEach(n=>{const i=Z(n),l=i.email||i.vendorId||i.id;r.has(l)||r.set(l,i)}),Array.from(r.values())},[c]),f=u.useMemo(()=>{const s=new Set;return h.forEach(r=>(r.categories||[]).forEach(n=>n&&s.add(n))),["All",...Array.from(s)]},[h]),N=u.useMemo(()=>Ae(h),[h]),[y,L]=u.useState(()=>JSON.stringify(c,null,2)),[z,$]=u.useState("visual"),[U,B]=u.useState(!0),[o,F]=u.useState(!1),[H,T]=u.useState(""),[g,D]=u.useState(!1),[Y,O]=u.useState(null),[K,a]=u.useState(null),j=u.useRef([]),[I,V]=u.useState(()=>M(localStorage.getItem(re))??[]);async function ee(){a(null),T(""),D(!0);try{const s=await v.post("/api/data/vendors/migrate-startups").then(n=>n.data||{});w(`Migrated startups → vendors (scanned: ${s.scanned??0}, created: ${s.created??0}, updated: ${s.updated??0})`);try{await E({action:"VENDORS_MIGRATE",userEmail:S.currentUser?.email,targetType:"vendors",targetId:"migration",metadata:s})}catch{}let r=q;try{const{data:n}=await v.get(`${C}/live`,{headers:{"x-tenant-id":t,"cache-control":"no-cache"},suppressToast:!0,suppressErrorLog:!0});n&&(r=n)}catch{r=q}try{const n=await v.get("/api/data/vendors",{suppressToast:!0,suppressErrorLog:!0}).then(l=>l.data||[]),i=k(r);i.startups=Array.isArray(i.startups)?i.startups:[],n.forEach(l=>{const d=Z(l),x=i.startups.findIndex(b=>String(b.vendorId||b.id)===d.vendorId||(b.email||b.contactEmail||"").toLowerCase()===(d.email||"").toLowerCase()&&d.email);x>=0?i.startups[x]={...i.startups[x],...d}:i.startups.push(d)}),r=i}catch{}m(r),L(JSON.stringify(r,null,2)),localStorage.setItem(Q,JSON.stringify(r)),await R()}catch(s){a(s?.response?.data?.message||s?.message||"Migration failed")}finally{D(!1)}}const[J,ie]=u.useState("All"),[W,oe]=u.useState("All"),[G,le]=u.useState(""),[te,P]=u.useState(h[0]?.vendorId||""),ce=u.useMemo(()=>h.filter(s=>!(J!=="All"&&(s.status||"").toLowerCase()!==J||W!=="All"&&!s.categories?.includes(W)||G&&!`${s.name} ${s.companyName} ${s.email} ${s.vendorId} ${s.city} ${s.country}`.toLowerCase().includes(G.toLowerCase()))),[h,J,W,G]),p=u.useMemo(()=>h.find(s=>s.vendorId===te),[h,te]);function w(s){O(s),setTimeout(()=>O(null),2500)}function de(s){const r=M(localStorage.getItem(X))??[];r.unshift(s);const n=r.slice(0,10);localStorage.setItem(X,JSON.stringify(n)),j.current=n}function A(s){de(c),m(s),L(JSON.stringify(s,null,2)),localStorage.setItem(Q,JSON.stringify(s))}function me(s){if(!p)return;const r=k(c),n=["startups","vendors","companies"];let i=!1;for(const d of n){if(!Array.isArray(r[d]))continue;const x=r[d].findIndex(b=>String(b.vendorId??b.id??b.uid)===p.vendorId||b.email&&b.email.toLowerCase()===p.email);x>=0&&(r[d][x]={...r[d][x],...s,vendorId:p.vendorId,id:p.vendorId},i=!0)}i||(r.startups=Array.isArray(r.startups)?r.startups:[],r.startups.push({...p.raw,...s,vendorId:p.vendorId,id:p.vendorId})),A(r);try{const d=p.status;typeof s.status<"u"&&s.status!==d?E({action:"VENDOR_STATUS_CHANGE",userEmail:S.currentUser?.email,targetType:"vendor",targetId:p.vendorId,metadata:{from:d,to:s.status,email:p.email}}):E({action:"VENDOR_UPDATE",userEmail:S.currentUser?.email,targetType:"vendor",targetId:p.vendorId,metadata:{patch:s,email:p.email}})}catch{}const l=Ee({...p,...s});if(l.name&&l.contactEmail&&l.id){if(!S.currentUser){a("Please sign in to save vendor changes.");return}(async()=>{try{await v.put(`/api/data/vendors/${encodeURIComponent(l.id)}`,l),w("Saved to API")}catch(d){const x=d?.response?.status,b=d?.response?.data?.message||d?.message||"Failed to save vendor to API";if(x===404||x===400)try{await v.post("/api/data/vendors",l),w("Created vendor in API");return}catch(_){const we=_?.response?.data?.message||_?.message||b;a(we);return}a(b)}})()}}function ue(){const s=prompt("Vendor/company name?");if(!s)return;const r=ae(),n=k(c);n.startups=Array.isArray(n.startups)?n.startups:[],n.startups.push(Z({id:r,vendorId:r,name:s,companyName:s,status:"pending",email:""})),A(n),P(r);try{E({action:"VENDOR_CREATE",userEmail:S.currentUser?.email,targetType:"vendor",targetId:r,metadata:{name:s}})}catch{}}function pe(){if(!p)return;const s=ae(),r=k(p);r.vendorId=s,r.id=s,r.name=`${r.name||r.companyName||"Vendor"} (Copy)`;const n=k(c);n.startups=Array.isArray(n.startups)?n.startups:[],n.startups.push(r),A(n),P(s);try{E({action:"VENDOR_DUPLICATE",userEmail:S.currentUser?.email,targetType:"vendor",targetId:s,metadata:{sourceId:p.vendorId}})}catch{}}function he(){if(!p||!window.confirm(`Delete "${p.name||p.companyName||p.email}"?`))return;const s=k(c);["startups","vendors","companies"].forEach(r=>{Array.isArray(s[r])&&(s[r]=s[r].filter(n=>String(n.vendorId??n.id??n.uid)!==p.vendorId&&(n.email||"").toLowerCase()!==p.email))}),A(s),P(s?.startups?.[0]?.vendorId||"")}function ge(){const s=j.current.length>0?j.current:M(localStorage.getItem(X))??[];if(!s.length)return;const r=s.shift();j.current=s,localStorage.setItem(X,JSON.stringify(s)),m(r),L(JSON.stringify(r,null,2))}const R=u.useCallback(async()=>{try{const{data:s}=await v.get(`${C}/checkpoints`,{headers:{"x-tenant-id":t,"cache-control":"no-cache"},suppressToast:!0,suppressErrorLog:!0}),r=Array.isArray(s?.items)?s.items:[];V(r),localStorage.setItem(re,JSON.stringify(r.slice(0,2)))}catch{}},[t]),se=u.useCallback(async({silent:s}={})=>{s?F(!0):B(!0),T("");try{let r=q;try{const{data:l}=await v.get(`${C}/live`,{headers:{"x-tenant-id":t,"cache-control":"no-cache"},suppressToast:!0,suppressErrorLog:!0});l&&typeof l=="object"&&Object.keys(l).length&&(r=l)}catch(l){const d=l?.response?.data?.message||l?.message||"Failed to fetch live vendor data";T(d)}const n=k(r);n.startups=Array.isArray(n.startups)?n.startups:[];try{(await v.get("/api/data/vendors",{suppressToast:!0,suppressErrorLog:!0}).then(d=>d.data||[])).forEach(d=>{const x=Z(d),b=n.startups.findIndex(_=>String(_.vendorId||_.id)===x.vendorId||(_.email||_.contactEmail||"").toLowerCase()===(x.email||"").toLowerCase()&&x.email);b>=0?n.startups[b]={...n.startups[b],...x}:n.startups.push(x)})}catch(l){const d=l?.response?.data?.message||l?.message||"Failed to fetch vendors from API";T(x=>x||d)}m(n),L(JSON.stringify(n,null,2)),localStorage.setItem(Q,JSON.stringify(n));const i=n?.startups?.[0]||n?.vendors?.[0]||n?.companies?.[0];P(String(i?.vendorId??i?.id??"")||""),await R()}finally{s?F(!1):B(!1)}},[t,R]);u.useEffect(()=>{se({silent:!1}).catch(()=>{})},[se]);async function xe(){a(null),D(!0);try{await v.put(`${C}/publish`,{data:c},{headers:{"Content-Type":"application/json","x-tenant-id":t}}),w("Published vendor directory to live");try{await E({action:"VENDORS_PUBLISH",userEmail:S.currentUser?.email,targetType:"appData",targetId:"vendors",metadata:{count:h.length}})}catch{}await R()}catch(s){a(s.message||"Publish failed")}finally{D(!1)}}async function fe(s){try{await v.post(`${C}/checkpoints`,{message:s||"Vendor admin update",data:c},{headers:{"Content-Type":"application/json","x-tenant-id":t}}),w("Checkpoint saved");try{await E({action:"VENDORS_CHECKPOINT",userEmail:S.currentUser?.email,targetType:"vendors",targetId:"checkpoint",metadata:{message:s||""}})}catch{}await R()}catch(r){a(r.message||"Failed to save checkpoint")}}async function be(s){if(window.confirm("Restore this snapshot to LIVE appData.json?"))try{await v.post(`${C}/restore/${s}`,null,{headers:{"x-tenant-id":t}}),w("Restored snapshot"),await R();try{const{data:r}=await v.get(`${C}/live`,{headers:{"x-tenant-id":t,"cache-control":"no-cache"},suppressToast:!0,suppressErrorLog:!0});r&&A(r)}catch{}}catch(r){a(r.message||"Restore failed")}}async function ye(){if(window.confirm("Delete ALL checkpoints on the server?"))try{await v.delete(`${C}/checkpoints`,{headers:{"x-tenant-id":t}}),w("Cleared history");try{await E({action:"VENDORS_HISTORY_CLEAR",userEmail:S.currentUser?.email,targetType:"vendors",targetId:"history"})}catch{}await R()}catch(s){a(s.message||"Failed to clear")}}function ve(){try{const s=new Blob([JSON.stringify(c,null,2)],{type:"application/json;charset=utf-8"}),r=URL.createObjectURL(s),n=document.createElement("a");n.href=r;const i=new Date().toISOString().replace(/[:.]/g,"-");n.download=`appData-${t}-${i}.json`,document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(r),w("Exported current working copy")}catch(s){a("Export failed: "+(s?.message||"unknown error"))}}function Ne(s){return!s||typeof s!="object"?"File is not valid JSON.":!Array.isArray(s.startups)&&!Array.isArray(s.vendors)&&!Array.isArray(s.companies)?"JSON should include vendors in startups[] or vendors[].":null}async function je(s){a(null);const r=s.target.files?.[0];if(r)try{const n=await r.text(),i=M(n),l=Ne(i);if(l){a(l);return}A(i);const d=i?.startups?.[0]||i?.vendors?.[0]||i?.companies?.[0];P(String(d?.vendorId??d?.id??"")||""),w(`Imported ${r.name}`)}catch(n){a("Import failed: "+(n?.message||"unknown error"))}finally{s.target.value=""}}return e.jsx(Se,{children:e.jsxs("div",{className:"container py-4",children:[e.jsxs("div",{className:"row g-3 mb-3",children:[e.jsx("div",{className:"col-md-3 col-sm-6",children:e.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 bg-gradient-start-5 bg-animated-gradient text-center p-3",children:[e.jsx("i",{className:"bi bi-people text-primary fs-3 mb-2"}),e.jsx("h6",{className:"fw-bold mb-0",children:N.total}),e.jsx("small",{className:"text-muted",children:"Vendors"})]})}),e.jsx("div",{className:"col-md-3 col-sm-6",children:e.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 text-center p-3",children:[e.jsx("i",{className:"bi bi-grid text-success fs-3 mb-2"}),e.jsx("h6",{className:"fw-bold mb-0",children:N.categories}),e.jsx("small",{className:"text-muted",children:"Categories"})]})}),e.jsx("div",{className:"col-md-6 col-sm-12",children:e.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("i",{className:"bi bi-flag text-danger fs-4"}),e.jsx("div",{className:"fw-semibold",children:"Status"})]}),e.jsxs("span",{className:"badge text-bg-light",children:[Object.values(N.byStatus||{}).reduce((s,r)=>s+r,0)," total"]})]}),(()=>{const s=i=>i==="active"?"success":i==="pending"?"warning":i==="suspended"?"danger":"secondary",r=Object.entries(N.byStatus||{}),n=r.reduce((i,[,l])=>i+l,0);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"progress",style:{height:10},"aria-label":"Status proportions",children:r.map(([i,l])=>{const d=n?Math.round(l/n*100):0;return e.jsx("div",{className:`progress-bar bg-${s(i)}`,role:"progressbar",style:{width:`${d}%`},"aria-valuenow":d,"aria-valuemin":0,"aria-valuemax":100,title:`${i}: ${l} (${d}%)`},i)})}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:r.map(([i,l])=>e.jsxs("span",{className:`d-inline-flex align-items-center gap-2 px-2 py-1 rounded-pill border border-${s(i)} text-${s(i)} bg-${s(i)}-subtle small`,children:[e.jsx("i",{className:`bi ${i==="active"?"bi-check-circle":i==="pending"?"bi-hourglass-split":"bi-pause-circle"}`}),e.jsx("span",{className:"text-capitalize",children:i}),e.jsx("span",{className:"badge text-bg-light",children:l})]},i))})]})})()]})})]}),e.jsxs("div",{className:"pt-4 d-flex gap-2 mb-3",children:[e.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>se({silent:!0}),disabled:U||o,children:o?"Refreshing…":U?"Loading…":"Refresh data"}),e.jsxs("label",{className:"btn btn-light mb-0",children:["Import JSON",e.jsx("input",{type:"file",accept:"application/json",hidden:!0,onChange:je})]}),e.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white",onClick:ve,children:"Export Current"}),e.jsx("button",{className:"btn btn-outline-warning",onClick:()=>{if(g)return;window.confirm("This will convert all items under 'startups' into 'vendors' (idempotent) and clear startups. Proceed?")&&ee()},disabled:g||U||o,title:"Convert all startups to vendors and upsert into vendor directory",children:"Migrate startups → vendors"}),e.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:xe,disabled:g||U||o,title:"Write working copy to live appData.json on the server",children:g?"Publishing…":"Publish to live"})]}),H&&e.jsx("div",{className:"alert alert-warning py-2",children:H}),Y&&e.jsx("div",{className:"alert alert-success py-2",children:Y}),K&&e.jsx("div",{className:"alert alert-danger py-2",children:K}),e.jsx(ke,{onSave:fe,onClear:ye,onUndo:ge,disabled:g||U||o}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsxs("ul",{className:"nav nav-tabs mb-3",children:[e.jsx("li",{className:"nav-item",children:e.jsx("button",{className:`nav-link ${z==="visual"?"active":""}`,onClick:()=>$("visual"),children:"Visual editor"})}),e.jsx("li",{className:"nav-item",children:e.jsx("button",{className:`nav-link ${z==="json"?"active":""}`,onClick:()=>$("json"),children:"JSON editor"})})]}),z==="json"?e.jsx(Le,{text:y,setText:L,onApply:()=>{const s=M(y);if(!s){a("Invalid JSON");return}A(s),w("Applied JSON to working copy")}}):e.jsx(Ue,{vendors:h,category:W,setCategory:oe,status:J,setStatus:ie,allCategories:f,search:G,setSearch:le,filtered:ce,selectedId:te,setSelectedId:P,selected:p,addVendor:ue,duplicateVendor:pe,deleteVendor:he,updateVendor:me,doSetData:A,data:c})]}),e.jsx("div",{style:{width:380},children:e.jsx(Oe,{items:I,onRestore:be})})]})]})})}function ke({onSave:t,onClear:c,onUndo:m,disabled:h}){const[f,N]=u.useState("");return e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-3",children:[e.jsx("input",{className:"form-control",placeholder:"Checkpoint message (e.g. 'Approved vendors batch #3')",value:f,onChange:y=>N(y.target.value)}),e.jsx("button",{className:"btn btn-sm rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:()=>t(f),disabled:h,children:"Save checkpoint"}),e.jsx("button",{className:"btn btn-sm rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white",onClick:c,children:"Clear history"}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:m,children:"Undo"})]})}function Le({text:t,setText:c,onApply:m}){return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header fw-semibold",children:"Working copy (JSON)"}),e.jsxs("div",{className:"card-body",children:[e.jsx("textarea",{value:t,onChange:h=>c(h.target.value),rows:22,spellCheck:!1,className:"form-control font-monospace"}),e.jsxs("div",{className:"d-flex justify-content-between mt-2",children:[e.jsxs("small",{className:"text-muted",children:["Tip: Press ",e.jsx("kbd",{children:"⌘/Ctrl"}),"+",e.jsx("kbd",{children:"A"})," then ",e.jsx("kbd",{children:"⌘/Ctrl"}),"+",e.jsx("kbd",{children:"C"})," to copy."]}),e.jsx("button",{className:"btn btn-outline-primary",onClick:m,children:"Apply JSON"})]})]})]})}function Ue(t){const{vendors:c,category:m,setCategory:h,status:f,setStatus:N,allCategories:y,search:L,setSearch:z,filtered:$,selectedId:U,setSelectedId:B,selected:o,addVendor:F,duplicateVendor:H,deleteVendor:T,updateVendor:g,doSetData:D,data:Y}=t;function O(a){o&&g({status:a,lastUpdated:new Date().toISOString()})}function K(){if(!o)return;const a=o.vendorId,j=(o.email||o.contactEmail||"").toLowerCase(),I=k(Y);I.services=Array.isArray(I.services)?I.services:[],I.services=I.services.map(V=>{const ee=String(V.vendorId||"")===String(a),J=(V.contactEmail||"").toLowerCase()===j;return ee||J?{...V,vendor:o.name||o.companyName||""}:V}),D(I)}return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[e.jsx("span",{className:"fw-semibold",children:"Vendor approvals"}),e.jsx("span",{className:"text-muted small",children:"CRUD for vendor directory"})]}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row g-2 align-items-end mb-3",children:[e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsx("select",{className:"form-select",value:f,onChange:a=>N(a.target.value),children:["All","active","pending","suspended"].map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsx("select",{className:"form-select",value:m,onChange:a=>h(a.target.value),children:y.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("div",{className:"col",children:[e.jsx("label",{className:"form-label",children:"Search"}),e.jsx("input",{className:"form-control",placeholder:"Name, email, vendorId, city, country…",value:L,onChange:a=>z(a.target.value)})]}),e.jsx("div",{className:"col-auto",children:e.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 w-100",onClick:F,children:"+ Add vendor"})}),e.jsx("div",{className:"col-auto",children:e.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white w-100",onClick:H,disabled:!o,children:"Duplicate"})}),e.jsx("div",{className:"col-auto",children:e.jsx("button",{className:"btn btn-danger-500 rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white w-100",onClick:T,disabled:!o,children:"Delete"})})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-4",children:[e.jsxs("div",{className:"list-group mb-2",style:{maxHeight:480,overflow:"auto"},children:[$.map(a=>e.jsxs("button",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center "+(U===a.vendorId?"active":""),onClick:()=>B(a.vendorId),title:a.email||"",children:[e.jsxs("span",{className:"text-truncate",children:[a.name||a.companyName||"(unnamed)",e.jsx("span",{className:"text-muted",children:" · "}),e.jsx("span",{className:"text-truncate",children:a.email||"—"})]}),e.jsx("span",{className:"badge text-uppercase "+(a.status==="active"?"text-bg-success":a.status==="pending"?"text-bg-warning":"text-bg-danger"),children:a.status||"—"})]},a.vendorId)),!$.length&&e.jsx("div",{className:"text-muted small p-2",children:"No vendors match your filters."})]}),e.jsxs("div",{className:"small text-muted",children:["Showing ",$.length," of ",c.length]})]}),e.jsx("div",{className:"col",children:o?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-8",children:[e.jsx("label",{className:"form-label",children:"Company / Vendor name"}),e.jsx("input",{className:"form-control",value:o.name||"",onChange:a=>g({name:a.target.value})})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Contact email"}),e.jsx("input",{className:"form-control",value:o.email||"",onChange:a=>g({email:a.target.value.toLowerCase(),contactEmail:a.target.value.toLowerCase()})})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Website"}),e.jsx("input",{className:"form-control",value:o.website||"",onChange:a=>g({website:a.target.value})})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{className:"form-control",value:o.phone||"",onChange:a=>g({phone:a.target.value})})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"Founded (year)"}),e.jsx("input",{className:"form-control",value:o.foundedYear||"",onChange:a=>g({foundedYear:a.target.value})})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{className:"form-control",value:o.country||"",onChange:a=>g({country:a.target.value})})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{className:"form-control",value:o.city||"",onChange:a=>g({city:a.target.value})})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Team size"}),e.jsx("input",{className:"form-control",value:o.teamSize||"",onChange:a=>g({teamSize:a.target.value})})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Logo URL"}),e.jsx("input",{className:"form-control",value:o.logoUrl||"",onChange:a=>g({logoUrl:a.target.value})})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Banner URL"}),e.jsx("input",{className:"form-control",value:o.bannerUrl||"",onChange:a=>g({bannerUrl:a.target.value})})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-control",rows:4,value:o.description||"",onChange:a=>g({description:a.target.value})})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Categories (comma-separated)"}),e.jsx("input",{className:"form-control",value:(o.categories||[]).join(", "),onChange:a=>g({categories:a.target.value.split(",").map(j=>j.trim()).filter(Boolean)})})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Tags (comma-separated)"}),e.jsx("input",{className:"form-control",value:(o.tags||[]).join(", "),onChange:a=>g({tags:a.target.value.split(",").map(j=>j.trim()).filter(Boolean)})})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:o.status||"pending",onChange:a=>O(a.target.value),children:[e.jsx("option",{value:"active",children:"active"}),e.jsx("option",{value:"pending",children:"pending"}),e.jsx("option",{value:"suspended",children:"suspended"})]})]}),e.jsxs("div",{className:"col-md-6 d-flex align-items-end gap-2",children:[e.jsx("button",{className:"btn btn-success",type:"button",onClick:()=>O("active"),children:"Approve"}),e.jsx("button",{className:"btn btn-warning",type:"button",onClick:()=>O("pending"),children:"Mark pending"}),e.jsx("button",{className:"btn btn-danger",type:"button",onClick:()=>O("suspended"),children:"Suspend"})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"border rounded p-2",children:[e.jsx("div",{className:"text-muted small mb-1",children:"Profile preview"}),e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("img",{src:o.logoUrl||"/assets/images/placeholder-1x1.png",alt:"logo",style:{width:64,height:64,objectFit:"cover",borderRadius:8}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:o.name||"Vendor"}),e.jsx("div",{className:"text-muted small",children:o.email||"email"}),e.jsx("div",{className:"small",children:o.website?e.jsx("a",{href:o.website,target:"_blank",rel:"noreferrer",children:o.website}):"website"})]})]}),e.jsxs("div",{className:"d-flex gap-2 mt-3",children:[e.jsx("a",{className:"btn btn-outline-primary",href:`/profile-vendor?vendorId=${encodeURIComponent(o.vendorId)}`,target:"_blank",rel:"noreferrer",children:"Open profile"}),e.jsx("button",{className:"btn btn-outline-secondary",type:"button",onClick:K,children:"Propagate name to listings"})]})]}),o.lastUpdated&&e.jsxs("div",{className:"form-text mt-1",children:["Last updated: ",ne(o.lastUpdated)]})]})]})}):e.jsx("div",{className:"text-muted mt-2",children:"Select a vendor to review."})})]})]})]})}function Oe({items:t,onRestore:c}){return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header fw-semibold d-flex justify-content-between",children:[e.jsx("span",{children:"Version history"}),e.jsx("span",{className:"text-muted small",children:"Latest checkpoints"})]}),e.jsxs("div",{className:"list-group list-group-flush",children:[!t?.length&&e.jsxs("div",{className:"list-group-item text-muted small",children:["No checkpoints yet.",e.jsx("div",{className:"mt-1",children:"Offline cache keeps the two most recent checkpoints."})]}),t?.map(m=>e.jsx("div",{className:"list-group-item",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:m.message||"(no message)"}),e.jsx("div",{className:"text-muted small",children:ne(m.ts)}),e.jsxs("div",{className:"text-muted small",children:["Δ Cohorts: ",m.delta?.cohorts>=0?"+":"",m.delta?.cohorts??0," · Δ Courses: ",m.delta?.courses>=0?"+":"",m.delta?.courses??0," · Δ Lessons: ",m.delta?.lessons>=0?"+":"",m.delta?.lessons??0]})]}),e.jsxs("div",{className:"d-flex align-items-start gap-2",children:[e.jsx("button",{className:"btn btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 btn-sm",title:"Restore snapshot to LIVE",onClick:()=>c(m.id),children:"Restore"}),e.jsx("a",{className:"btn btn-outline-secondary btn-sm",title:"Download snapshot JSON",href:`${C}/checkpoints/${m.id}`,target:"_blank",rel:"noreferrer",children:"Download"})]})]})},m.id))]})]})}export{De as default};
