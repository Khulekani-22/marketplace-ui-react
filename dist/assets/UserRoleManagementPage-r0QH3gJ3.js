import{r as c,a as D,n as v,b as d,C as fe,j as a,h as Qe,w as ye}from"./index-CDEs_jt0.js";import{M as He}from"./MasterLayout-9VLNCxgL.js";import{B as We}from"./Breadcrumb-DA5GMbv3.js";import"./iconify-oJsv78Ep.js";function Ke(){var be;const[j,w]=c.useState([]),[$,q]=c.useState(!1),[G,xe]=c.useState(""),[Q,ve]=c.useState(""),[H,m]=c.useState(""),[W,p]=c.useState(""),[K,J]=c.useState([{id:"vendor",name:"Vendor"}]),P=(((be=D.currentUser)==null?void 0:be.email)||sessionStorage.getItem("userEmail")||"").toLowerCase(),[L,X]=c.useState({}),[je,we]=c.useState({}),[Se,Ie]=c.useState({}),[h,Ne]=c.useState({}),[Y,Z]=c.useState({}),[ee,ae]=c.useState({}),[R,Ce]=c.useState(""),[N,te]=c.useState([]),[f,se]=c.useState(!1),[ne,F]=c.useState(""),[S,re]=c.useState(""),[T,ke]=c.useState(100),[V,Ue]=c.useState({}),[M,ie]=c.useState(!0),[z,le]=c.useState(!1),[O,oe]=c.useState(!1),ce=c.useRef(!1),de=c.useMemo(()=>[...j].sort((e,l)=>(e.email||"").localeCompare(l.email||"")),[j]),[_,Ae]=c.useState(""),[B,Ee]=c.useState("All"),me=c.useMemo(()=>{const e=_.trim().toLowerCase(),l=B==="All"?null:v(B);return de.filter(s=>{const n=v(s.role);return l&&n!==l?!1:e?`${s.email} ${s.tenantId} ${s.role}`.toLowerCase().includes(e):!0})},[de,_,B]);function ue(e){return(Array.isArray(e)?e:[]).map(s=>({email:(s.email||"").toLowerCase(),tenantId:s.tenantId==="vendor"?"public":s.tenantId||"public",role:v(s.role)}))}async function k(){var e,l;q(!0),m("");try{const{data:s}=await d.get("/api/users"),n=Array.isArray(s)?s:[];w(n.map(t=>({email:(t.email||"").toLowerCase(),tenantId:!t.tenantId||t.tenantId==="public"?"vendor":t.tenantId,role:t.role||"member"})));try{const t=await d.get("/api/data/vendors").then(o=>o.data||[]),r={},i={},u={};t.forEach(o=>{const b=(o.contactEmail||o.email||"").toLowerCase(),x=o.ownerUid||"",y=String(o.id||""),g=String(o.vendorId||"");b&&(r[b]=o),x&&(i[x]=o),y&&(u[y]=o),g&&(u[g]=o)}),X(r),we(i),Ie(u)}catch{}}catch(s){m(((l=(e=s==null?void 0:s.response)==null?void 0:e.data)==null?void 0:l.message)||(s==null?void 0:s.message)||"Failed to load users")}finally{q(!1)}}c.useEffect(()=>{k()},[]),c.useEffect(()=>{(async()=>{try{if(!P)return;await d.get("/api/users/lookup",{params:{email:P}}),ie(!0)}catch{ie(!1)}})()},[]),c.useEffect(()=>{(async()=>{try{const{data:e}=await d.get("/api/tenants"),l=Array.isArray(e)?e:[],s=[{id:"vendor",name:"Vendor"},...l.map(t=>typeof t=="string"?{id:t,name:t}:{id:t==null?void 0:t.id,name:(t==null?void 0:t.name)||(t==null?void 0:t.id)}).map(t=>t.id==="public"?{...t,id:"vendor",name:t.name||"Vendor"}:t)].filter(t=>t&&t.id),n=new Map;s.forEach(t=>n.set(t.id,t)),J(Array.from(n.values()))}catch{J([{id:"vendor",name:"Vendor"}])}})()},[]);async function Le(e){var n,t,r;e.preventDefault(),m(""),p("");const l=G.trim(),s=Q.trim();if(!l||!s){m("Email and new tenant id are required");return}try{await d.post("/api/users/upgrade",{email:l,newTenantId:s}),p("Upgraded successfully");const i=(window==null?void 0:window.localStorage)&&window.localStorage.getItem("userEmail")||((n=window==null?void 0:window.sessionStorage)==null?void 0:n.getItem("userEmail"));i&&i.toLowerCase()===l.toLowerCase()&&(sessionStorage.setItem("tenantId",s),sessionStorage.setItem("role","admin")),await k()}catch(i){m(((r=(t=i==null?void 0:i.response)==null?void 0:t.data)==null?void 0:r.message)||(i==null?void 0:i.message)||"Upgrade failed")}}async function U({email:e,tenantId:l,role:s}){const n=l==="vendor"?"public":l,t=v(s);await d.post("/api/users",{email:e,tenantId:n,role:t}),e.toLowerCase()===P&&(sessionStorage.setItem("tenantId",l),sessionStorage.setItem("role",t))}async function Re(e){var n,t;m(""),p("");const s=v(e.role)==="admin"?"member":"admin";try{await U({email:e.email,tenantId:e.tenantId||"vendor",role:s}),w(r=>r.map(i=>i.email===e.email?{...i,role:s}:i)),p(`${e.email} is now ${s}`)}catch(r){m(((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Failed to update role")}}async function Fe(e){var n,t;m(""),p("");const s=v(e.role)==="partner"?"member":"partner";try{await U({email:e.email,tenantId:e.tenantId||"vendor",role:s}),w(r=>r.map(i=>i.email===e.email?{...i,role:s}:i)),p(`${e.email} is now ${s}`)}catch(r){m(((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Failed to update role")}}async function Te(e,l){var s,n;m(""),p("");try{await U({email:e.email,tenantId:l,role:e.role||"member"}),w(t=>t.map(r=>r.email===e.email?{...r,tenantId:l}:r)),p(`${e.email} moved to ${l}`)}catch(t){m(((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.message)||(t==null?void 0:t.message)||"Failed to change tenant")}}async function Be(e){var s,n;m(""),p("");const l=(e.email||"").toLowerCase();if(l&&window.confirm(`Delete user ${l}? This removes their account and role mapping but keeps listings.`))try{await d.delete("/api/users",{data:{email:l}}),w(t=>t.filter(r=>(r.email||"").toLowerCase()!==l)),p(`Deleted ${l}`)}catch(t){m(((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.message)||(t==null?void 0:t.message)||"Failed to delete user")}}async function De(e){var l,s;m(""),p("");try{let n="";try{const{data:i}=await d.get("/api/users/lookup",{params:{email:e.email}});n=(i==null?void 0:i.uid)||""}catch{n=""}const t=(e.email||"").split("@")[0]||"Vendor",r={id:n||void 0,name:t,contactEmail:e.email,ownerUid:n||void 0,status:"pending",kycStatus:"pending",categories:[],tags:[]};await d.post("/api/data/vendors",r),X(i=>({...i,[e.email]:!0})),p(`Created vendor profile for ${e.email}`)}catch(n){m(((s=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:s.message)||(n==null?void 0:n.message)||"Failed to create vendor profile")}}async function $e(e,l={}){var n,t;const s=(e.email||"").toLowerCase();ae(r=>({...r,[s]:!0})),m(""),p("");try{let r="";try{const{data:o}=await d.get("/api/users/lookup",{params:{email:s}});r=(o==null?void 0:o.uid)||""}catch{m("Could not find Firebase UID for this email");return}await d.post("/api/users",{email:s,tenantId:e.tenantId||"vendor",role:e.role||"member",uid:r});let i=!1;const u=L[s];if(u){const o=String(u.id||u.vendorId||"");if(o)try{await d.put(`/api/data/vendors/${encodeURIComponent(o)}`,{ownerUid:r}),i=!0}catch{}}else try{const o=await d.get("/api/tenants"),x=(Array.isArray(o.data)?o.data:[]).map(g=>typeof g=="string"?g:g==null?void 0:g.id).filter(Boolean),y=Array.from(new Set(["vendor",...x]));for(const g of y)try{const{data:A}=await d.get("/api/data/vendors",{headers:{"x-tenant-id":g}}),C=Array.isArray(A)?A.find(E=>(E.contactEmail||E.email||"").toLowerCase()===s):null;if(C){const E=String(C.id||C.vendorId||"");if(E){await d.put(`/api/data/vendors/${encodeURIComponent(E)}`,{ownerUid:r},{headers:{"x-tenant-id":g}}),i=!0;break}}}catch{}}catch{}if(!i){const o=s.split("@")[0]||"Vendor";try{await d.post("/api/data/vendors",{name:o,contactEmail:s,ownerUid:r,status:"pending",kycStatus:"pending",categories:[]})}catch{}}l.doRefresh!==!1&&await k(),p(`Synced Firebase UID for ${s}`)}catch(r){m(((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Failed to sync UID")}finally{ae(r=>({...r,[s]:!1}))}}function Pe(e){const l={},s={},n={};return(e||[]).forEach(t=>{const r=(t.contactEmail||t.email||"").toLowerCase(),i=t.ownerUid||"",u=String(t.id||""),o=String(t.vendorId||"");r&&(l[r]=t),i&&(s[i]=t),u&&(n[u]=t),o&&(n[o]=t)}),{byEmail:l,byOwner:s,byId:n}}async function Ve(e){const l=(e.email||"").toLowerCase();Z(s=>({...s,[l]:!0}));try{let s=L[l]||null,n="",t=null,r=null;try{const{data:i}=await d.get("/api/users/lookup",{params:{email:l}});n=(i==null?void 0:i.uid)||""}catch{}if(n&&(t=je[n]||null,r=Se[n]||null),!s&&!t&&!r)try{const i=await d.get("/api/tenants"),o=(Array.isArray(i.data)?i.data:[]).map(g=>typeof g=="string"?g:g==null?void 0:g.id).filter(Boolean),b=[],x=Array.from(new Set(["vendor",...o]));for(const g of x)try{const{data:A}=await d.get("/api/data/vendors",{headers:{"x-tenant-id":g}});Array.isArray(A)&&b.push(...A.map(C=>({...C,_tenantId:C.tenantId||g})))}catch{}const y=Pe(b);s=y.byEmail[l]||null,n&&(t=y.byOwner[n]||t,r=y.byId[n]||r)}catch{}Ne(i=>({...i,[l]:{uid:n,viaEmail:s,viaUid:t,viaId:r}}))}finally{Z(s=>({...s,[l]:!1}))}}const I=c.useCallback(async(e=!0)=>{var l,s,n,t,r;F(""),se(!0);try{const i={search:R,pageSize:T};!e&&S&&(i.pageToken=S);const{data:u}=await d.get("/api/users/all",{params:i}),o=Array.isArray(u==null?void 0:u.items)?u.items:[];te(b=>e?o:[...b,...o]),re((u==null?void 0:u.nextPageToken)||"")}catch(i){const u=(l=i==null?void 0:i.response)==null?void 0:l.status;if(u===401||u===403)try{await fe();const o={search:R,pageSize:T};!e&&S&&(o.pageToken=S);const{data:b}=await d.get("/api/users/all",{params:o}),x=Array.isArray(b==null?void 0:b.items)?b.items:[];te(y=>e?x:[...y,...x]),re((b==null?void 0:b.nextPageToken)||""),F("");return}catch(o){F(((n=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:n.message)||(o==null?void 0:o.message)||"Failed to search platform users")}else F(((r=(t=i==null?void 0:i.response)==null?void 0:t.data)==null?void 0:r.message)||(i==null?void 0:i.message)||"Failed to search platform users")}finally{se(!1)}},[R,T,S]),he=c.useRef(!1);c.useEffect(()=>{if(he.current)return;he.current=!0;let e=!0;return(async()=>{try{if(await fe(),!e)return;await I(!0)}catch{}})(),()=>{e=!1}},[I]),c.useEffect(()=>{if(!ce.current&&!f&&Array.isArray(N)&&N.length===0){const e=setTimeout(()=>{ce.current=!0,I(!0)},800);return()=>clearTimeout(e)}},[f,N,I]);async function pe(e,l){var t,r;const s=V[e]||"vendor",n=v(l);try{await U({email:e,tenantId:s,role:n}),w(i=>i.find(o=>o.email===e)?i.map(o=>o.email===e?{...o,role:n,tenantId:s}:o):[...i,{email:e,role:n,tenantId:s}]),p(`${e} granted ${n} (${s})`)}catch(i){m(((r=(t=i==null?void 0:i.response)==null?void 0:t.data)==null?void 0:r.message)||(i==null?void 0:i.message)||`Failed to grant ${n}`)}}async function Me(e){await pe(e,"admin")}async function ze(e){await pe(e,"partner")}function Oe(e){const l=(e||"").toLowerCase();return j.some(s=>s.email===l&&Qe(s.role))}function ge(e){const l=(e||"").toLowerCase(),s=j.find(n=>n.email===l);return v(s==null?void 0:s.role)}async function _e(e){var n,t;const l=j.find(r=>r.email===(e||"").toLowerCase()),s=(l==null?void 0:l.tenantId)||V[e]||"vendor";try{await U({email:e,tenantId:s,role:"member"}),w(r=>r.map(i=>i.email===e?{...i,role:"member"}:i)),p(`${e} access revoked`)}catch(r){m(((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Failed to revoke admin")}}async function qe(){var e,l,s;m(""),p(""),le(!0);try{const n=await d.get("/api/lms/live").then(i=>i.data||{}),t=ue(j),r={...n,users:t};await d.put("/api/users/bulk",{users:t}),await d.put("/api/lms/publish",{data:r});try{await ye({action:"USERS_SAVE_ALL",userEmail:(e=D.currentUser)==null?void 0:e.email,targetType:"appData",targetId:"users",metadata:{count:t.length}})}catch{}p("All changes saved to appData.json"),await k()}catch(n){m(((s=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:s.message)||(n==null?void 0:n.message)||"Failed to save changes")}finally{le(!1)}}async function Ge(){var e,l,s;m(""),p(""),oe(!0);try{const n=await d.get("/api/lms/live").then(i=>i.data||{}),t=ue(j),r={...n,users:t};await d.put("/api/users/bulk",{users:t}),await d.post("/api/lms/checkpoints",{message:"User Roles checkpoint",data:r});try{await ye({action:"USERS_CHECKPOINT",userEmail:(e=D.currentUser)==null?void 0:e.email,targetType:"appData",targetId:"users",metadata:{count:t.length}})}catch{}p("Checkpoint saved"),await k()}catch(n){m(((s=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:s.message)||(n==null?void 0:n.message)||"Failed to save checkpoint")}finally{oe(!1)}}return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"card h-100 p-0 radius-12 overflow-hidden",children:[a.jsx("div",{className:"card-header border-bottom bg-base py-16 px-24 d-flex align-items-center justify-content-between gap-3 flex-wrap",children:a.jsx("h6",{className:"mb-0",children:"Upgrade Public Tenant to Private Admin"})}),a.jsxs("div",{className:"card-body p-24",children:[a.jsxs("form",{onSubmit:Le,className:"row g-3 align-items-end mb-24",children:[a.jsxs("div",{className:"col-sm-5",children:[a.jsx("label",{className:"form-label text-sm",children:"User Email"}),a.jsx("input",{type:"email",className:"form-control",value:G,onChange:e=>xe(e.target.value),placeholder:"user@example.com",required:!0})]}),a.jsxs("div",{className:"col-sm-5",children:[a.jsx("label",{className:"form-label text-sm",children:"New Tenant ID (private)"}),a.jsx("input",{type:"text",className:"form-control",value:Q,onChange:e=>ve(e.target.value),placeholder:"acme-inc",required:!0})]}),a.jsx("div",{className:"col-sm-2",children:a.jsx("button",{type:"submit",className:"btn btn-primary w-100",children:"Upgrade"})})]}),H&&a.jsx("div",{className:"alert alert-danger py-8 px-12 mb-16",children:H}),W&&a.jsx("div",{className:"alert alert-success py-8 px-12 mb-16",children:W}),a.jsx("div",{className:"d-flex flex-wrap align-items-end justify-content-between gap-2 mb-3",children:a.jsxs("div",{className:"d-flex align-items-end gap-2 flex-wrap",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label text-sm",children:"Search"}),a.jsx("input",{className:"form-control",placeholder:"Filter by email, tenant, role",value:_,onChange:e=>Ae(e.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label text-sm",children:"Role"}),a.jsxs("select",{className:"form-select",value:B,onChange:e=>Ee(e.target.value),children:[a.jsx("option",{children:"All"}),a.jsx("option",{children:"admin"}),a.jsx("option",{children:"partner"}),a.jsx("option",{children:"member"})]})]}),a.jsxs("div",{className:"align-self-end mb-1 d-flex gap-2",children:[a.jsx("button",{className:"btn btn-outline-secondary",onClick:Ge,disabled:O||z,title:"Create a checkpoint containing the current user role assignments",children:O?"Saving…":"Save Checkpoint"}),a.jsx("button",{className:"btn btn-primary",onClick:qe,disabled:z||O,title:"Publish all user role/tenant mappings to live appData.json",children:z?"Saving…":"Save All Changes"})]})]})}),a.jsx("div",{className:"table-responsive scroll-sm",children:a.jsxs("table",{className:"table bordered-table sm-table mb-0 align-middle",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Email"}),a.jsx("th",{style:{minWidth:160},children:"Tenant"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Vendor"}),a.jsx("th",{style:{minWidth:320},children:"Actions / Trace"})]})}),a.jsxs("tbody",{children:[$&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:"Loading…"})}),!$&&me.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:"No users match your filters."})}),!$&&me.map(e=>{var r;const l=v(e.role),s=l==="admin",n=l==="partner",t=s?"badge bg-success-focus text-success-700":n?"badge bg-primary-subtle text-primary-700":"badge bg-neutral-200 text-neutral-900";return a.jsxs("tr",{children:[a.jsx("td",{children:e.email}),a.jsx("td",{children:a.jsx("select",{className:"form-select form-select-sm w-auto bg-base border text-secondary-light rounded-pill",value:e.tenantId||"vendor",onChange:i=>Te(e,i.target.value),title:"Switch tenant",children:K.map(i=>a.jsx("option",{value:i.id,children:i.name||i.id},i.id))})}),a.jsx("td",{children:a.jsx("span",{className:t,children:l})}),a.jsxs("td",{children:[L[e.email]?a.jsx("span",{className:"badge bg-primary-subtle text-primary-700",children:"Has vendor"}):a.jsx("span",{className:"badge bg-neutral-200 text-neutral-900",children:"No vendor"}),h[e.email]&&a.jsx("div",{className:"small text-secondary mt-1",children:h[e.email].uid?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:["uid: ",a.jsx("code",{children:h[e.email].uid})]}),a.jsxs("div",{children:["by email: ",h[e.email].viaEmail?a.jsxs(a.Fragment,{children:[a.jsx("code",{children:String(h[e.email].viaEmail.contactEmail||h[e.email].viaEmail.email||"")})," ","(vendorId: ",a.jsx("code",{children:String(h[e.email].viaEmail.id||h[e.email].viaEmail.vendorId)}),", tenant: ",a.jsx("code",{children:String(h[e.email].viaEmail.tenantId||h[e.email].viaEmail._tenantId||"vendor")}),")"]}):"—"]}),a.jsxs("div",{children:["by ownerUid: ",h[e.email].viaUid?a.jsxs(a.Fragment,{children:[a.jsx("code",{children:String(h[e.email].viaUid.ownerUid||"")})," ","(vendorId: ",a.jsx("code",{children:String(h[e.email].viaUid.id||h[e.email].viaUid.vendorId)}),", tenant: ",a.jsx("code",{children:String(h[e.email].viaUid.tenantId||h[e.email].viaUid._tenantId||"vendor")}),")"]}):"—"]}),a.jsxs("div",{children:["by id==uid: ",h[e.email].viaId?a.jsxs(a.Fragment,{children:[a.jsx("code",{children:String(h[e.email].viaId.id||h[e.email].viaId.vendorId)})," ","(tenant: ",a.jsx("code",{children:String(h[e.email].viaId.tenantId||h[e.email].viaId._tenantId||"vendor")}),")"]}):"—"]})]}):a.jsxs("div",{children:[a.jsx("span",{className:"me-1",children:"uid:"}),a.jsx("span",{className:"text-secondary",children:"—"}),a.jsx("div",{className:"text-secondary small mt-1",children:M?a.jsx(a.Fragment,{children:"UID not linked. Use “Sync UID” to fetch from Firebase."}):a.jsx(a.Fragment,{children:"UID lookup not available on this server."})})]})})]}),a.jsx("td",{children:a.jsxs("div",{className:"d-flex gap-2",children:[a.jsx("button",{type:"button",className:s?"btn btn-outline-danger btn-sm":"btn btn-outline-success btn-sm",onClick:()=>Re(e),title:s?"Revoke admin":"Grant admin",children:s?"Revoke Admin":"Make Admin"}),a.jsx("button",{type:"button",className:n?"btn btn-outline-danger btn-sm":"btn btn-outline-primary btn-sm",onClick:()=>Fe(e),title:n?"Revoke partner":"Grant partner",children:n?"Revoke Partner":"Make Partner"}),!L[e.email]&&a.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>De(e),title:"Create vendor profile for this user",children:"Create Vendor"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>Ve(e),disabled:!!Y[e.email],title:"Trace vendor status via email, UID, or vendor id",children:Y[e.email]?"Tracing…":"Trace"}),a.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>$e(e),disabled:!!ee[e.email]||!M,title:M?"Lookup Firebase UID and link it to this user's vendor":"UID lookup is not available on this server",children:ee[e.email]?"Syncing…":"Sync UID"}),a.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>Be(e),title:"Delete user from Firebase and remove role mapping (keeps listings)",disabled:(((r=D.currentUser)==null?void 0:r.email)||"").toLowerCase()===(e.email||"").toLowerCase(),children:"Delete User"})]})})]},e.email)})]})]})}),a.jsxs("div",{className:"mt-24",children:[a.jsx("h6",{className:"mb-2",children:"Onboard Admins"}),a.jsxs("div",{className:"d-flex flex-wrap align-items-end gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"form-label text-sm",children:"Search users"}),a.jsx("input",{className:"form-control",placeholder:"Search by email or name",value:R,onChange:e=>Ce(e.target.value)})]}),a.jsx("button",{className:"btn btn-outline-secondary",onClick:I,disabled:f,children:f?"Searching…":"Search"}),ne&&a.jsx("div",{className:"text-danger small",children:ne})]}),a.jsxs("div",{className:"table-responsive scroll-sm",children:[a.jsxs("table",{className:"table bordered-table sm-table mb-0 align-middle",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"UID"}),a.jsx("th",{children:"Tenant"}),a.jsx("th",{children:"Action"})]})}),a.jsxs("tbody",{children:[f&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,children:"Loading…"})}),!f&&N.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,children:"No results"})}),!f&&N.map(e=>a.jsxs("tr",{children:[a.jsx("td",{children:e.email}),a.jsx("td",{children:e.displayName||"—"}),a.jsx("td",{children:a.jsx("code",{children:e.uid})}),a.jsx("td",{children:(()=>{const l=(e.email||"").toLowerCase(),s=V[l]||"vendor";return a.jsx("select",{className:"form-select form-select-sm w-auto bg-base border text-secondary-light rounded-pill",value:s,onChange:n=>Ue(t=>({...t,[l]:n.target.value})),children:K.map(n=>a.jsx("option",{value:n.id,children:n.name||n.id},n.id))})})()}),a.jsx("td",{children:a.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-outline-success",onClick:()=>Me((e.email||"").toLowerCase()),disabled:ge(e.email)==="admin",children:"Grant Admin"}),a.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>ze((e.email||"").toLowerCase()),disabled:ge(e.email)==="partner",children:"Grant Partner"}),Oe(e.email)&&a.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>_e((e.email||"").toLowerCase()),children:"Revoke Access"})]})})]},e.uid))]})]}),a.jsxs("div",{className:"d-flex align-items-center justify-content-between mt-2",children:[a.jsxs("div",{className:"text-secondary small",children:["Showing ",N.length," user(s)"]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[a.jsx("label",{className:"text-sm",children:"Page size"}),a.jsx("select",{className:"form-select form-select-sm w-auto",value:T,onChange:e=>ke(Number(e.target.value)||100),children:[50,100,200,500,1e3].map(e=>a.jsx("option",{value:e,children:e},e))}),a.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>I(!0),disabled:f,children:"Refresh"}),a.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>I(!1),disabled:f||!S,children:f?"Loading…":S?"Load more":"End"})]})]})]})]})]})]})})}function ea(){return a.jsxs(He,{children:[a.jsx(We,{title:"User Role Management"}),a.jsx(Ke,{})]})}export{ea as default};
