import{r as m,a as ze,u as Fe,b as C,j as t,c as Ue}from"./index-CA0CEW2v.js";import{u as Pe}from"./useAppSync-C6gKe1DY.js";import{f as We,u as qe,s as be}from"./subscriptions-BpzQLJOa.js";const I=d=>({...d,vendor:d.vendor??d.vendorName??"",imageUrl:d.imageUrl??d.thumbnail??"",category:d.category??d.categoryId??"",rating:typeof d.rating=="number"?d.rating:Number(d.rating||0),reviews:Array.isArray(d.reviews)?d.reviews:[],status:(d.status??"approved").toString().toLowerCase()}),V=d=>d.status==="approved",He=8,Ye=17;function ge(d){const x=(d+11)%12+1,w=d>=12?"PM":"AM";return`${x}:00 ${w}`}function _e(d=He,x=Ye){const w=[];for(let y=d;y<x;y+=1){const T=y+1,B=`${String(y).padStart(2,"0")}:00`;w.push({value:B,label:`${ge(y)} – ${ge(T)}`})}return w}function Oe(d={}){const x=(d.listingType||d.type||"").toString().toLowerCase();return x==="service"||x==="services"}function xe(d){if(!d)return"";try{const x=new Date(`${d}T00:00:00`);return Number.isNaN(x.getTime())?d:x.toLocaleDateString()}catch{return d}}const Je=({query:d,onQueryChange:x,category:w,onCategoryChange:y,onCategoriesChange:T})=>{const B=m.useMemo(()=>sessionStorage.getItem("tenantId")||"vendor",[]),M=m.useMemo(()=>(ze.services||[]).map(I).filter(V),[]),[g,z]=m.useState(M),F=m.useRef(M),pe=m.useRef(0),[U,fe]=m.useState(!0),[ve,ye]=m.useState("All"),R=w??ve,Ne=y??ye,[je,we]=m.useState(""),$=d??je,Q=x??we,[S,G]=m.useState({}),[f,k]=m.useState({open:!1,id:null,showAll:!1,page:0}),[P,J]=m.useState({open:!1,id:null}),[K,h]=m.useState(""),[Se,N]=m.useState("success"),[X,Z]=m.useState(!1),[ee,E]=m.useState(()=>new Set),[te,W]=m.useState({}),[v,A]=m.useState({open:!1,id:null,date:"",slot:"",error:""}),[q,se]=m.useState(!1),ne=Fe(),{appData:j}=Pe(),H=m.useMemo(()=>_e(),[]),ae=m.useMemo(()=>{const e={};return H.forEach(s=>{e[s.value]=s.label}),e},[H]);function ke(e={},s={}){const n=Number(e.reviewCount||(Array.isArray(e.reviews)?e.reviews.length:0)||0),a=Number(s.reviewCount||(Array.isArray(s.reviews)?s.reviews.length:0)||0),l=Date.parse(e.lastReviewedAt||"")||0,i=Date.parse(s.lastReviewedAt||"")||0;return a>n?s:a<n?e:i>l?s:e}function re(e,s,n){const a=new Map;return s.forEach(l=>a.set(String(l.id),l)),n.forEach(l=>a.set(String(l.id),l)),e.forEach(l=>{const i=String(l.id),r=a.get(i)||{},u=ke(r,l);a.set(i,{...r,reviews:Array.isArray(u.reviews)?u.reviews:r.reviews,reviewCount:Number(u.reviewCount||(Array.isArray(u.reviews)?u.reviews.length:r.reviewCount||0)||0),rating:typeof u.rating=="number"?u.rating:Number(u.rating||r.rating||0),lastReviewedAt:u.lastReviewedAt||r.lastReviewedAt})}),Array.from(a.values())}async function Ae(){const e=((j==null?void 0:j.services)||[]).map(I).filter(V),s=re(F.current??g,M,e);z(s)}m.useEffect(()=>{const e=((j==null?void 0:j.services)||[]).map(I).filter(V),s=re(F.current??g,M,e);z(s),fe(!1)},[B,j]),m.useEffect(()=>{let e=!1;return(async()=>{try{if(!C.currentUser)return;const s=await We();if(e)return;const n={},a=new Set(s.filter(l=>(l.type||"service")==="service").map(l=>{const i=String(l.serviceId);return(l.scheduledDate||l.scheduledSlot)&&(n[i]={date:l.scheduledDate||"",slot:l.scheduledSlot||""}),i}));E(a),W(n)}catch{}})(),()=>{e=!0}},[]);async function ie(e,s={}){var a,l,i;const{bookable:n=!1}=s;try{if(!C.currentUser){ne("/login",{replace:!0,state:{from:((a=window.location)==null?void 0:a.pathname)||"/"}});return}const r=String(e);ee.has(r)?(await qe(r),E(b=>{const c=new Set(Array.from(b));return c.delete(r),c}),W(b=>{const c={...b};return delete c[r],c}),N("success"),h(n?"Booking cancelled":"Unsubscribed"),setTimeout(()=>h(""),2e3)):(await be(r),E(b=>new Set([...Array.from(b),r])),N("success"),h("Subscribed"),setTimeout(()=>h(""),2e3))}catch(r){const u=((i=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:i.message)||(r==null?void 0:r.message)||"Failed to update subscription";N("danger"),h(u),setTimeout(()=>h(""),2500)}}const Y=m.useMemo(()=>["All",...Array.from(new Set(g.map(s=>(s.category||"").trim()).filter(Boolean)))],[g]);m.useEffect(()=>{try{typeof T=="function"&&T(Y)}catch{}},[Y,T]);const le=m.useMemo(()=>{const e=R.toLowerCase(),s=($||"").trim().toLowerCase();let n=R==="All"?g:g.filter(a=>(a.category||"").trim().toLowerCase()===e);return s?n.filter(a=>[a.title||"",a.vendor||"",a.category||"",a.description||a.summary||"",Array.isArray(a.tags)?a.tags.join(" "):""].join(` 
 `).toLowerCase().includes(s)):n},[g,R,$]);m.useEffect(()=>{F.current=g},[g]);function oe(e,s,n){G(a=>({...a,[e]:{...a[e]||{},[s]:n}}))}function Ce(e){k({open:!0,id:e,showAll:!1,page:0}),S[e]||G(s=>({...s,[e]:{rating:0,comment:""}}))}function _(){k({open:!1,id:null,showAll:!1,page:0})}function ce(e){J({open:!0,id:e})}function de(){J({open:!1,id:null})}function Te(e){var a;if(!C.currentUser){ne("/login",{replace:!0,state:{from:((a=window.location)==null?void 0:a.pathname)||"/"}});return}const s=e==null?void 0:e.id,n=te[String(s)]||{};A({open:!0,id:s,date:n.date||"",slot:n.slot||"",error:""})}function L(){A({open:!1,id:null,date:"",slot:"",error:""})}function me(e,s){A(n=>({...n,[e]:s,error:e==="date"||e==="slot"?"":n.error}))}async function Me(){var a,l;const{id:e,date:s,slot:n}=v;if(e){if(!s){A(i=>({...i,error:"Please choose a date."}));return}if(!n){A(i=>({...i,error:"Please choose a time slot."}));return}se(!0);try{const i={scheduledDate:s,scheduledSlot:n};await be(String(e),i),E(r=>new Set([...Array.from(r),String(e)])),W(r=>({...r,[String(e)]:{date:s,slot:n}})),N("success"),h(`Session booked for ${xe(s)} at ${ae[n]||n}.`),setTimeout(()=>h(""),2500),L()}catch(i){const r=((l=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:l.message)||(i==null?void 0:i.message)||"Failed to book session";A(u=>({...u,error:r}))}finally{se(!1)}}}function Re(e,s){oe(e,"rating",s)}function ue(e){const s=Number(e||0);return t.jsx("span",{children:[1,2,3,4,5].map(n=>t.jsx("span",{style:{color:s>=n?"#f5a623":"#ccc",fontSize:16},children:"★"},n))})}function $e(e){const s=Array.isArray(e)?e.slice():[];return s.sort((n,a)=>(Date.parse((a==null?void 0:a.createdAt)||"")||0)-(Date.parse((n==null?void 0:n.createdAt)||"")||0)),s}const D=5;function Ee(e){const s=Math.max(0,Math.ceil(e/D)-1);k(n=>({...n,page:Math.min(s,(n.page||0)+1)}))}function Le(){k(e=>({...e,page:Math.max(0,(e.page||0)-1)}))}async function De(e){var a,l,i,r,u,b;const s=Number(((a=S[e])==null?void 0:a.rating)||0),n=(((l=S[e])==null?void 0:l.comment)||"").trim();if(Number.isNaN(s)||s<1||s>5){N("danger"),h("Please select a star rating (1–5)."),setTimeout(()=>h(""),2500);return}Z(!0);try{const c=((i=C.currentUser)==null?void 0:i.email)||"",o=((r=C.currentUser)==null?void 0:r.displayName)||(c?c.split("@")[0]:"Guest"),p=g.find(O=>O.id===e)||{},{data:Ie}=await Ue.post(`/api/data/services/${encodeURIComponent(e)}/reviews`,{rating:s,comment:n,author:o,authorEmail:c,title:p.title||"",vendor:p.vendor||"",contactEmail:p.contactEmail||p.email||""}),Be=I(Ie);pe.current+=1,z(O=>O.map(he=>he.id===e?Be:he)),N("success"),h("Review submitted. Thank you!"),setTimeout(()=>h(""),2500),_(),setTimeout(()=>{Ae().catch(()=>{})},800)}catch(c){const o=((b=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:b.message)||(c==null?void 0:c.message)||"Failed to submit review";N("danger"),h(o),setTimeout(()=>h(""),2500)}finally{Z(!1)}}return t.jsxs("div",{className:"col-12",children:[t.jsxs("div",{className:"mb-16 mt-8 d-flex flex-wrap justify-content-between align-items-center gap-12",children:[t.jsx("h6",{className:"mb-0",children:"All Listings"}),t.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-12",children:[t.jsxs("div",{className:"position-relative",children:[t.jsx("input",{type:"text",className:"form-control form-control-sm rounded-3 border-1 border-neutral-300 bg-neutral-100 text-sm ps-12 pe-32 py-8",placeholder:"Search listings by name, vendor, category…",value:$,onChange:e=>Q(e.target.value),style:{minWidth:260},"aria-label":"Search listings"}),$&&t.jsx("button",{type:"button",className:"btn btn-sm btn-link position-absolute end-0 top-50 translate-middle-y me-2",onClick:()=>Q(""),"aria-label":"Clear search",children:"✕"})]}),t.jsx("ul",{className:"nav button-tab nav-pills mb-0 gap-12",role:"tablist",children:Y.map(e=>t.jsx("li",{className:"nav-item",role:"presentation",children:t.jsx("button",{className:`nav-link btn btn-sm rounded-pill text-neutral-500 hover-text-white bg-neutral-300 bg-hover-primary-800 rounded-pill px-20 py-6 border border-neutral-300 ${R===e?"active":""}`,onClick:()=>Ne(e),children:e})},e))})]})]}),t.jsx("div",{className:"tab-content",children:t.jsx("div",{className:"tab-pane fade show active",children:t.jsxs("div",{className:"row g-3",children:[U&&t.jsx("div",{className:"col-12 text-center text-secondary-light",children:"Loading listings…"}),!U&&le.map(e=>{const s=Number(e.rating||0),n=Number(e.reviewCount||(Array.isArray(e.reviews)?e.reviews.length:0)||0),a=String(e.id),l=ee.has(a),i=Oe(e),r=te[a];return t.jsx("div",{className:"col-12 col-md-6 col-lg-4",children:t.jsx("article",{className:"card p-1 h-100",tabIndex:0,"aria-label":`${e.title||"Listing"} card`,style:{fontSize:"0.8rem"},children:t.jsxs("div",{className:"row g-1 align-items-start",children:[t.jsx("div",{className:"col-4 d-flex align-items-center justify-content-center",children:t.jsx("button",{type:"button",className:"btn p-0 border-0 bg-transparent",onClick:()=>ce(e.id),"aria-label":`View details for ${e.title||"listing"}`,children:t.jsx("img",{src:e.imageUrl,alt:e.title||"Listing image",className:"img-fluid rounded",style:{maxHeight:"6.8rem",objectFit:"contain"}})})}),t.jsxs("div",{className:"col-8 d-flex flex-column",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[t.jsxs("div",{children:[t.jsx("button",{type:"button",className:"btn btn-link p-0 fw-medium text-start",style:{fontSize:"1.1rem",lineHeight:1.2,textDecoration:"none"},onClick:()=>ce(e.id),"aria-label":`Open details for ${e.title||"listing"}`,children:e.title}),t.jsxs("div",{className:"text-muted small",style:{fontSize:"0.74rem"},children:[e.vendor||"Unknown",e.category?t.jsxs("span",{children:[t.jsx("span",{className:"mx-1",children:"|"}),e.category]}):null]}),i&&r&&t.jsxs("div",{className:"text-success small mt-1",style:{fontSize:"0.7rem"},children:["Next session: ",xe(r.date),r.slot?t.jsxs("span",{className:"ms-1",children:["· ",ae[r.slot]||r.slot]}):null]})]}),t.jsxs("div",{className:"d-flex flex-column gap-1 pt-1",children:[t.jsx("button",{type:"button",className:l?"btn btn-sm rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6":"btn btn-sm  rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",style:{fontSize:"0.74rem",padding:"0.2rem 0.45rem"},onClick:()=>{i?Te(e):ie(e.id)},children:i?l?"Reschedule":"Book session":l?"Subscribed":"Subscribe"}),i&&l&&t.jsx("button",{type:"button",className:"btn btn-sm rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white",style:{fontSize:"0.74rem",padding:"0.2rem 0.45rem"},onClick:()=>ie(e.id,{bookable:!0}),children:"Cancel booking"}),t.jsx("button",{type:"button",className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white",style:{fontSize:"0.74rem",padding:"0.2rem 0.45rem"},onClick:()=>Ce(e.id),children:n>0?"Review":"Write review"})]})]}),t.jsxs("div",{className:"d-flex align-items-center small",style:{fontSize:"0.74rem"},children:[t.jsx("svg",{className:"me-1",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",role:"img","aria-label":"rating star",children:t.jsx("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),t.jsx("span",{className:"me-1",children:s.toFixed(1)}),t.jsxs("span",{className:"text-muted",children:["(",n," ",n===1?"rating":"ratings",")"]})]})]})]})})},e.id)}),!U&&le.length===0&&t.jsx("div",{className:"col-12 text-center text-secondary-light",children:"No services found in this category."})]})})}),K&&t.jsx("div",{className:"position-fixed top-0 end-0 p-3",style:{zIndex:1080},children:t.jsx("div",{className:`toast show align-items-center ${Se==="danger"?"text-bg-danger":"text-bg-success"} border-0`,children:t.jsxs("div",{className:"d-flex",children:[t.jsx("div",{className:"toast-body",children:K}),t.jsx("button",{type:"button",className:"btn-close btn-close-white me-2 m-auto",onClick:()=>h("")})]})})}),v.open&&(()=>{const e=g.find(c=>c.id===v.id);if(!e)return null;const s=new Date,n=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),l=String(s.getDate()).padStart(2,"0"),i=`${n}-${a}-${l}`,r=String(v.id??""),u=`booking-date-${r}`,b=`booking-slot-${r}`;return t.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100",style:{background:"rgba(0,0,0,0.5)",zIndex:1076},onClick:c=>{c.target===c.currentTarget&&L()},children:t.jsxs("div",{className:"card shadow-lg",style:{maxWidth:560,margin:"10vh auto",maxHeight:"80vh",overflowY:"auto"},children:[t.jsxs("div",{className:"card-header d-flex align-items-center justify-content-between",children:[t.jsxs("h6",{className:"mb-0",children:["Book session: ",e.title]}),t.jsx("button",{type:"button",className:"btn btn-sm btn-outline-secondary",onClick:L,children:"Close"})]}),t.jsxs("div",{className:"card-body",children:[t.jsx("div",{className:"text-secondary small mb-3",children:"One-hour slots available between 8:00 AM and 5:00 PM."}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label small fw-semibold",htmlFor:u,children:"Choose a date"}),t.jsx("input",{id:u,type:"date",className:"form-control",value:v.date,min:i,onChange:c=>me("date",c.target.value)})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label small fw-semibold",htmlFor:b,children:"Choose a time slot"}),t.jsxs("select",{id:b,className:"form-select",value:v.slot,onChange:c=>me("slot",c.target.value),children:[t.jsx("option",{value:"",children:"Select a slot"}),H.map(c=>t.jsx("option",{value:c.value,children:c.label},c.value))]})]}),v.error&&t.jsx("div",{className:"alert alert-danger py-2",role:"alert",children:v.error}),t.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[t.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:L,disabled:q,children:"Close"}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:Me,disabled:q,children:q?"Booking…":"Confirm booking"})]})]})]})})})(),P.open&&(()=>{const e=g.find(i=>i.id===P.id);if(!e)return null;const s=Array.isArray(e.tags)?e.tags.filter(Boolean):[],n=e.description||e.summary||"",a=typeof e.price=="number"&&!Number.isNaN(Number(e.price)),l=a?Intl.NumberFormat(void 0,{style:"currency",currency:e.currency||"USD",maximumFractionDigits:0}).format(Number(e.price)):"";return t.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100",style:{background:"rgba(0,0,0,0.5)",zIndex:1075},onClick:i=>{i.target===i.currentTarget&&de()},children:t.jsxs("div",{className:"card shadow-lg",style:{maxWidth:640,margin:"10vh auto",maxHeight:"80vh",overflowY:"auto"},children:[t.jsxs("div",{className:"card-header d-flex align-items-center justify-content-between",children:[t.jsx("h6",{className:"mb-0",children:"Listing details"}),t.jsx("button",{type:"button",className:"btn btn-sm btn-outline-secondary",onClick:de,children:"Close"})]}),t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"d-flex flex-column flex-md-row gap-3 mb-3",children:[e.imageUrl?t.jsx("div",{className:"flex-shrink-0 text-center",children:t.jsx("img",{src:e.imageUrl,alt:e.title||"Listing image",className:"img-fluid rounded",style:{maxWidth:"12rem",objectFit:"cover"}})}):null,t.jsxs("div",{className:"flex-grow-1",children:[t.jsx("h5",{className:"mb-1",children:e.title||"Untitled listing"}),t.jsxs("div",{className:"text-muted small mb-2",children:[e.vendor||"Unknown vendor",e.category?t.jsxs("span",{children:[t.jsx("span",{className:"mx-1",children:"|"}),e.category]}):null]}),t.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2 small",children:[t.jsxs("span",{className:"badge bg-primary-600 text-white",children:["Rating ",Number(e.rating||0).toFixed(1)]}),t.jsxs("span",{className:"text-secondary",children:[Number(e.reviewCount||(Array.isArray(e.reviews)?e.reviews.length:0))," review(s)"]}),a&&t.jsx("span",{className:"badge bg-neutral-200 text-dark",children:l})]})]})]}),n&&t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"fw-semibold",children:"Overview"}),t.jsx("p",{className:"mb-0 text-break",style:{whiteSpace:"pre-wrap"},children:n})]}),s.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsx("h6",{className:"fw-semibold",children:"Tags"}),t.jsx("div",{className:"d-flex flex-wrap gap-2",children:s.map((i,r)=>t.jsx("span",{className:"badge bg-neutral-200 text-dark",children:i},`${P.id}-${r}`))})]}),(e.contactEmail||e.website||e.contactPhone)&&t.jsxs("div",{className:"mb-2",children:[t.jsx("h6",{className:"fw-semibold",children:"Contact"}),t.jsxs("ul",{className:"mb-0 ps-3 small",children:[e.contactEmail&&t.jsxs("li",{children:["Email: ",t.jsx("a",{href:`mailto:${e.contactEmail}`,children:e.contactEmail})]}),e.contactPhone&&t.jsxs("li",{children:["Phone: ",e.contactPhone]}),e.website&&t.jsxs("li",{children:["Website: ",t.jsx("a",{href:e.website,target:"_blank",rel:"noreferrer",children:e.website})]})]})]})]})]})})})(),f.open&&(()=>{var u,b,c;const e=g.find(o=>o.id===f.id);if(!e)return null;const s=Array.isArray(e.reviews)?e.reviews.length:0,n=$e(e.reviews),a=n.slice(0,3),l=(f.page||0)*D,i=n.slice(l,l+D),r=Math.max(0,Math.ceil(s/D)-1);return t.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100",style:{background:"rgba(0,0,0,0.5)",zIndex:1070},onClick:o=>o.target===o.currentTarget&&_(),children:t.jsxs("div",{className:"card",style:{maxWidth:520,margin:"10vh auto"},children:[t.jsxs("div",{className:"card-header d-flex align-items-center justify-content-between",children:[t.jsxs("h6",{className:"mb-0",children:["Review: ",e.title]}),t.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:_,children:"Close"})]}),t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[t.jsxs("div",{className:"text-secondary small",children:["You are reviewing as: ",t.jsx("strong",{children:((u=C.currentUser)==null?void 0:u.email)||"Guest"})]}),t.jsxs("div",{className:"text-secondary small",children:["Vendor: ",t.jsx("strong",{children:e.vendor||"Unknown"})]})]}),(!e.reviews||e.reviews.length===0)&&t.jsx("div",{className:"alert alert-info py-2",children:Number(e.reviewCount||0)>0?`We have ${Number(e.reviewCount)} review(s) in aggregate, but no individual reviews to display yet.`:"No reviews yet. Be the first to write one!"}),!f.showAll&&a.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsx("div",{className:"fw-semibold mb-2",children:"Recent reviews"}),t.jsx("div",{className:"list-group list-group-flush",children:a.map((o,p)=>t.jsxs("div",{className:"list-group-item px-0",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[ue(o.rating),t.jsx("span",{className:"text-secondary small",children:o.author||o.authorEmail||"Anonymous"})]}),t.jsx("span",{className:"text-secondary small",children:o.createdAt?new Date(o.createdAt).toLocaleDateString():""})]}),o.comment&&t.jsx("div",{className:"small mt-1",children:o.comment})]},o.id||p))}),s>3&&t.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-secondary mt-2",onClick:()=>k(o=>({...o,showAll:!0,page:0})),children:["See all reviews (",s,")"]})]}),f.showAll&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[t.jsxs("div",{className:"fw-semibold",children:["All reviews (",s,")"]}),t.jsx("button",{type:"button",className:"btn btn-sm btn-outline-secondary",onClick:()=>k(o=>({...o,showAll:!1,page:0})),children:"Back"})]}),t.jsx("div",{className:"list-group list-group-flush",children:i.map((o,p)=>t.jsxs("div",{className:"list-group-item px-0",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[ue(o.rating),t.jsx("span",{className:"text-secondary small",children:o.author||o.authorEmail||"Anonymous"})]}),t.jsx("span",{className:"text-secondary small",children:o.createdAt?new Date(o.createdAt).toLocaleDateString():""})]}),o.comment&&t.jsx("div",{className:"small mt-1",children:o.comment})]},o.id||`${p}-${l}`))}),t.jsxs("div",{className:"d-flex align-items-center justify-content-between mt-2",children:[t.jsxs("span",{className:"text-secondary small",children:["Page ",(f.page||0)+1," of ",r+1]}),t.jsxs("div",{className:"d-flex gap-2",children:[t.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:Le,disabled:(f.page||0)<=0,children:"Prev"}),t.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>Ee(s),disabled:(f.page||0)>=r,children:"Next"})]})]})]}),t.jsx("div",{className:"mb-3",children:[1,2,3,4,5].map(o=>{var p;return t.jsx("button",{type:"button",onClick:()=>Re(e.id,o),className:"btn btn-link p-0 me-1","aria-label":`Rate ${o} stars`,children:t.jsx("span",{style:{fontSize:24,color:(((p=S[e.id])==null?void 0:p.rating)||0)>=o?"#f5a623":"#ccc"},children:"★"})},o)})}),t.jsx("div",{className:"mb-3",children:t.jsx("textarea",{className:"form-control",rows:3,placeholder:"Write a quick comment (optional)",value:((b=S[e.id])==null?void 0:b.comment)||"",onChange:o=>oe(e.id,"comment",o.target.value)})}),t.jsx("button",{className:"btn btn-primary",disabled:X||Number(((c=S[e.id])==null?void 0:c.rating)||0)<1,onClick:()=>De(e.id),children:X?"Submitting…":"Submit review"})]})]})})})()]})};export{Je as T};
