import{j as e,M as $,I as y}from"./index-DgAHpWmH.js";import{b as A,u as E,r as a}from"./vendor-DW3XjTa1.js";import{a as D}from"./appData-DuHX4t6e.js";import"./firebase-ARhtPVQA.js";import"./utils-B2rxisVD.js";const v="lms_completed_v1",F=()=>{try{const o=localStorage.getItem(v),h=o?JSON.parse(o):[];return new Set(Array.isArray(h)?h:[])}catch{return new Set}},P=o=>{try{localStorage.setItem(v,JSON.stringify(Array.from(o)))}catch{}};function _(){const o=A(),h=E(),d=a.useMemo(()=>D?.cohorts??[],[]),p=d.length>0,N=new URLSearchParams(h.search),w=N.get("cohort")||(p?d[0].id:""),S=N.get("course")||"",[x,C]=a.useState(w),[r,j]=a.useState(S),[m,k]=a.useState(F);a.useEffect(()=>{const s=new URLSearchParams(h.search);x?s.set("cohort",x):s.delete("cohort"),r?s.set("course",r):s.delete("course"),o({search:s.toString()},{replace:!0})},[x,r]),a.useEffect(()=>P(m),[m]);const u=a.useMemo(()=>d.find(s=>s.id===x)||d[0]||null,[d,x]),l=a.useMemo(()=>Array.isArray(u?.courses)?u.courses:[],[u]);a.useEffect(()=>{if(!l?.length){j("");return}l.some(t=>t.id===r)||j(l[0].id)},[l,r]);const c=a.useMemo(()=>l.find(s=>s.id===r)||null,[l,r]),g=c?.lessons??[],f=g.length,L=g.filter(s=>m.has(s.id)).length,M=f?Math.round(L/f*100):0;function I(s){k(t=>{const n=new Set(t);return n.has(s)?n.delete(s):n.add(s),n})}return e.jsx($,{children:e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"row align-items-center mb-24",children:[e.jsxs("div",{className:"col",children:[e.jsx("h2",{className:"mb-4",children:"LMS Â· Cohorts & Courses"}),e.jsxs("p",{className:"text-secondary-light mb-0 d-none",children:["Data loaded at build-time from ",e.jsx("code",{children:"backend/appData.json"})," (no network)."]})]}),e.jsx("div",{className:"col-auto",children:p&&e.jsx("select",{className:"form-select btn btn-outline-primary-600 border rounded-pill px-16",value:u?.id??"",onChange:s=>C(s.target.value),"aria-label":"Select cohort",children:d.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})})]}),p?e.jsxs("div",{className:"row g-24",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card radius-12 p-16 mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-12",children:[e.jsx("h5",{className:"mb-0",children:u?.name||"Cohort"}),e.jsxs("span",{className:"badge bg-primary-600",children:[l.length," modules"]})]}),l.length?e.jsx("div",{className:"row g-16 mb-3 py-3",children:l.map(s=>{const t=s.lessons??[],n=t.filter(b=>m.has(b.id)).length,i=t.length?Math.round(n/t.length*100):0;return e.jsx("div",{className:"col-12 py-2",children:e.jsxs("button",{type:"button",onClick:()=>j(s.id),className:`w-100 d-flex align-items-stretch gap-12 p-12 radius-12 border ${r===s.id?"border-primary":"border-neutral-200"} bg-base text-start`,children:[e.jsx("img",{src:s.videoThumbnail,alt:s.title,className:"rounded",style:{width:96,height:64,objectFit:"cover"},onError:b=>b.currentTarget.style.visibility="hidden"}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("h6",{className:"mb-4",children:s.title}),e.jsxs("span",{className:"text-sm text-secondary-light",children:[t.length," lessons"]})]}),e.jsx("p",{className:"mb-8 text-secondary-light",children:s.description}),e.jsx("div",{className:"progress",style:{height:8},children:e.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${i}%`},"aria-valuenow":i,"aria-valuemin":"0","aria-valuemax":"100"})}),e.jsxs("small",{className:"text-secondary-light",children:[i,"% complete"]})]})]})},s.id)})}):e.jsx("div",{className:"text-secondary-light",children:"No courses in this cohort."})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsx("div",{className:"card radius-12 p-16",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-12",children:[e.jsx("h5",{className:"mb-0",children:c.title}),e.jsxs("span",{className:"badge bg-success-subtle text-success-main",children:[M,"% complete"]})]}),e.jsx("img",{src:c.videoThumbnail,alt:c.title,className:"rounded mb-16 w-100",style:{maxHeight:260,objectFit:"cover"},onError:s=>s.currentTarget.style.display="none"}),e.jsx("p",{className:"text-secondary-light",children:c.description}),e.jsx("hr",{className:"my-16"}),e.jsxs("h6",{className:"mb-12 d-flex align-items-center gap-2",children:[e.jsx(y,{icon:"solar:play-circle-linear"}),"Lessons"]}),g.length?e.jsx("ul",{className:"list-group mb-16",children:g.map(s=>e.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between",children:[e.jsxs("div",{className:"d-flex align-items-center gap-10",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:m.has(s.id),onChange:()=>I(s.id),"aria-label":`Mark ${s.title} complete`}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:s.title}),e.jsx("small",{className:"text-secondary-light",children:s.duration})]})]}),m.has(s.id)&&e.jsx("span",{className:"badge bg-success-subtle text-success-main",children:"Done"})]},s.id))}):e.jsx("div",{className:"text-secondary-light",children:"No lessons listed."}),c.assessment&&e.jsxs(e.Fragment,{children:[e.jsxs("h6",{className:"mb-12 d-flex align-items-center gap-2",children:[e.jsx(y,{icon:"solar:checklist-minimalistic-linear"}),"Assessment: ",c.assessment.title]}),(c.assessment.questions||[]).map((s,t)=>e.jsxs("div",{className:"mb-12",children:[e.jsx("div",{className:"fw-semibold mb-8",children:s.text}),(s.options||[]).map((n,i)=>e.jsxs("div",{className:"form-check mb-6",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:`q-${t}`,id:`q-${t}-${i}`}),e.jsx("label",{className:"form-check-label",htmlFor:`q-${t}-${i}`,children:n.text})]},i))]},t)),e.jsx("button",{type:"button",className:"btn btn-primary",children:"Submit Answers"})]})]}):e.jsx("div",{className:"text-secondary-light",children:"Select a module to view details."})})})]}):e.jsx("div",{className:"alert alert-warning",children:"No cohorts found in appData.json."})]})})}export{_ as default};
