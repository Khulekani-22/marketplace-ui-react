const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BannerInnerTwo-BgBNTASR.js","assets/index-CA0CEW2v.js","assets/index-BXSesTeZ.css"])))=>i.map(i=>d[i]);
import{r as h,a as ae,c as E,j as t,R as pe,w as V,b as R,_ as Te}from"./index-CA0CEW2v.js";import{M as _e}from"./MasterLayout-DmY1NVaa.js";import"./iconify-DgbGXnnR.js";const T="/api/lms",$e=pe.lazy(()=>Te(()=>import("./BannerInnerTwo-BgBNTASR.js"),__vite__mapDeps([0,1,2]))),re="vendors_admin_draft_v1",ne="vendors_admin_undo_v1",ue="vendors_admin_history_cache_v1";function q(e){try{return typeof e=="string"?JSON.parse(e):e}catch{return null}}function J(e){return JSON.parse(JSON.stringify(e))}function de(){return Date.now().toString(36)+"-"+Math.random().toString(36).slice(2,8)}function he(e){return new Date(e).toLocaleString()}function oe(e){const i=((e==null?void 0:e.email)||(e==null?void 0:e.contactEmail)||"").toLowerCase(),m=(e==null?void 0:e.socials)??{},p=String((e==null?void 0:e.vendorId)??(e==null?void 0:e.id)??(e==null?void 0:e.uid)??i??de()),x=Array.isArray(e==null?void 0:e.categories)?e.categories:typeof(e==null?void 0:e.categories)=="string"?e.categories.split(",").map(N=>N.trim()).filter(Boolean):[],w=Array.isArray(e==null?void 0:e.tags)?e.tags:typeof(e==null?void 0:e.tags)=="string"?e.tags.split(",").map(N=>N.trim()).filter(Boolean):[];return{id:p,vendorId:p,name:(e==null?void 0:e.name)??(e==null?void 0:e.companyName)??(e==null?void 0:e.vendor)??"",companyName:(e==null?void 0:e.companyName)??(e==null?void 0:e.name)??"",contactEmail:i,email:i,ownerUid:(e==null?void 0:e.ownerUid)??(e==null?void 0:e.uid)??"",website:(e==null?void 0:e.website)??"",phone:(e==null?void 0:e.phone)??"",country:(e==null?void 0:e.country)??"",city:(e==null?void 0:e.city)??"",addressLine:(e==null?void 0:e.addressLine)??"",logoUrl:(e==null?void 0:e.logoUrl)??(e==null?void 0:e.logo)??"",bannerUrl:(e==null?void 0:e.bannerUrl)??"",description:(e==null?void 0:e.description)??"",categories:x,tags:w,foundedYear:(e==null?void 0:e.foundedYear)??"",teamSize:(e==null?void 0:e.teamSize)??"",registrationNo:(e==null?void 0:e.registrationNo)??"",status:((e==null?void 0:e.status)||"pending").toLowerCase(),socials:{twitter:m.twitter??"",linkedin:m.linkedin??"",facebook:m.facebook??"",instagram:m.instagram??"",youtube:m.youtube??"",github:m.github??""},lastUpdated:(e==null?void 0:e.lastUpdated)??"",raw:e}}function De(e=[]){const i=e.length,m=e.reduce((x,w)=>{const N=(w.status||"unknown").toLowerCase();return x[N]=(x[N]||0)+1,x},{}),p=new Set(e.flatMap(x=>Array.isArray(x.categories)?x.categories:[]).map(x=>(x||"").trim()).filter(Boolean)).size;return{total:i,categories:p,byStatus:m}}function Ve(e){var m,p,x,w,N,A;const i=((e==null?void 0:e.contactEmail)||(e==null?void 0:e.email)||"").toLowerCase();return{id:String((e==null?void 0:e.vendorId)||(e==null?void 0:e.id)||""),name:(e==null?void 0:e.name)||(e==null?void 0:e.companyName)||"",contactEmail:i,ownerUid:(e==null?void 0:e.ownerUid)||"",phone:(e==null?void 0:e.phone)||"",website:(e==null?void 0:e.website)||"",description:(e==null?void 0:e.description)||"",logoUrl:(e==null?void 0:e.logoUrl)||(e==null?void 0:e.logo)||"",bannerUrl:(e==null?void 0:e.bannerUrl)||"",country:(e==null?void 0:e.country)||"",city:(e==null?void 0:e.city)||"",addressLine:(e==null?void 0:e.addressLine)||"",socials:{twitter:((m=e==null?void 0:e.socials)==null?void 0:m.twitter)||"",linkedin:((p=e==null?void 0:e.socials)==null?void 0:p.linkedin)||"",facebook:((x=e==null?void 0:e.socials)==null?void 0:x.facebook)||"",instagram:((w=e==null?void 0:e.socials)==null?void 0:w.instagram)||"",youtube:((N=e==null?void 0:e.socials)==null?void 0:N.youtube)||"",github:((A=e==null?void 0:e.socials)==null?void 0:A.github)||""},categories:Array.isArray(e==null?void 0:e.categories)?e.categories:[],tags:Array.isArray(e==null?void 0:e.tags)?e.tags:[],foundedYear:(e==null?void 0:e.foundedYear)||"",teamSize:(e==null?void 0:e.teamSize)||"",registrationNo:(e==null?void 0:e.registrationNo)||"",status:((e==null?void 0:e.status)||"pending").toLowerCase(),kycStatus:((e==null?void 0:e.status)||"pending")==="active"?"approved":(e==null?void 0:e.kycStatus)||"pending"}}function Ye(){var me;const e=h.useMemo(()=>sessionStorage.getItem("tenantId")||"vendor",[]),[i,m]=h.useState(()=>q(localStorage.getItem(re))??ae),p=h.useMemo(()=>{const s=[Array.isArray(i==null?void 0:i.startups)&&i.startups,Array.isArray(i==null?void 0:i.vendors)&&i.vendors,Array.isArray(i==null?void 0:i.companies)&&i.companies].filter(Boolean),r=new Map;return s.flat().forEach(o=>{const n=oe(o),d=n.email||n.vendorId||n.id;r.has(d)||r.set(d,n)}),Array.from(r.values())},[i]),x=h.useMemo(()=>{const s=new Set;return p.forEach(r=>(r.categories||[]).forEach(o=>o&&s.add(o))),["All",...Array.from(s)]},[p]),w=h.useMemo(()=>De(p),[p]),[N,A]=h.useState(()=>JSON.stringify(i,null,2)),[_,z]=h.useState("visual"),[P,Q]=h.useState(!0),[l,X]=h.useState(!1),[Z,F]=h.useState(""),[b,H]=h.useState(!1),[v,M]=h.useState(null),[ee,a]=h.useState(null),L=h.useRef([]),[$,Y]=h.useState(()=>q(localStorage.getItem(ue))??[]);async function ie(){var s,r,o;a(null),F(""),H(!0);try{const n=await E.post("/api/data/vendors/migrate-startups").then(j=>j.data||{});U(`Migrated startups â†’ vendors (scanned: ${n.scanned??0}, created: ${n.created??0}, updated: ${n.updated??0})`);try{await V({action:"VENDORS_MIGRATE",userEmail:(s=R.currentUser)==null?void 0:s.email,targetType:"vendors",targetId:"migration",metadata:n})}catch{}let d=ae;try{const{data:j}=await E.get(`${T}/live`,{headers:{"x-tenant-id":e,"cache-control":"no-cache"},suppressToast:!0,suppressErrorLog:!0});j&&(d=j)}catch{d=ae}try{const j=await E.get("/api/data/vendors",{suppressToast:!0,suppressErrorLog:!0}).then(u=>u.data||[]),y=J(d);y.startups=Array.isArray(y.startups)?y.startups:[],j.forEach(u=>{const S=oe(u),c=y.startups.findIndex(I=>String(I.vendorId||I.id)===S.vendorId||(I.email||I.contactEmail||"").toLowerCase()===(S.email||"").toLowerCase()&&S.email);c>=0?y.startups[c]={...y.startups[c],...S}:y.startups.push(S)}),d=y}catch{}m(d),A(JSON.stringify(d,null,2)),localStorage.setItem(re,JSON.stringify(d)),await B()}catch(n){a(((o=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:o.message)||(n==null?void 0:n.message)||"Migration failed")}finally{H(!1)}}const[K,ge]=h.useState("All"),[te,xe]=h.useState("All"),[se,fe]=h.useState(""),[le,W]=h.useState(((me=p[0])==null?void 0:me.vendorId)||""),be=h.useMemo(()=>p.filter(s=>{var r;return!(K!=="All"&&(s.status||"").toLowerCase()!==K||te!=="All"&&!((r=s.categories)!=null&&r.includes(te))||se&&!`${s.name} ${s.companyName} ${s.email} ${s.vendorId} ${s.city} ${s.country}`.toLowerCase().includes(se.toLowerCase()))}),[p,K,te,se]),g=h.useMemo(()=>p.find(s=>s.vendorId===le),[p,le]);function U(s){M(s),setTimeout(()=>M(null),2500)}function ye(s){const r=q(localStorage.getItem(ne))??[];r.unshift(s);const o=r.slice(0,10);localStorage.setItem(ne,JSON.stringify(o)),L.current=o}function D(s){ye(i),m(s),A(JSON.stringify(s,null,2)),localStorage.setItem(re,JSON.stringify(s))}function Ne(s){var j,y;if(!g)return;const r=J(i),o=["startups","vendors","companies"];let n=!1;for(const u of o){if(!Array.isArray(r[u]))continue;const S=r[u].findIndex(c=>String(c.vendorId??c.id??c.uid)===g.vendorId||c.email&&c.email.toLowerCase()===g.email);S>=0&&(r[u][S]={...r[u][S],...s,vendorId:g.vendorId,id:g.vendorId},n=!0)}n||(r.startups=Array.isArray(r.startups)?r.startups:[],r.startups.push({...g.raw,...s,vendorId:g.vendorId,id:g.vendorId})),D(r);try{const u=g.status;typeof s.status<"u"&&s.status!==u?V({action:"VENDOR_STATUS_CHANGE",userEmail:(j=R.currentUser)==null?void 0:j.email,targetType:"vendor",targetId:g.vendorId,metadata:{from:u,to:s.status,email:g.email}}):V({action:"VENDOR_UPDATE",userEmail:(y=R.currentUser)==null?void 0:y.email,targetType:"vendor",targetId:g.vendorId,metadata:{patch:s,email:g.email}})}catch{}const d=Ve({...g,...s});if(d.name&&d.contactEmail&&d.id){if(!R.currentUser){a("Please sign in to save vendor changes.");return}(async()=>{var u,S,c,I,f;try{await E.put(`/api/data/vendors/${encodeURIComponent(d.id)}`,d),U("Saved to API")}catch(C){const O=(u=C==null?void 0:C.response)==null?void 0:u.status,G=((c=(S=C==null?void 0:C.response)==null?void 0:S.data)==null?void 0:c.message)||(C==null?void 0:C.message)||"Failed to save vendor to API";if(O===404||O===400)try{await E.post("/api/data/vendors",d),U("Created vendor in API");return}catch(k){const Re=((f=(I=k==null?void 0:k.response)==null?void 0:I.data)==null?void 0:f.message)||(k==null?void 0:k.message)||G;a(Re);return}a(G)}})()}}function je(){var n;const s=prompt("Vendor/company name?");if(!s)return;const r=de(),o=J(i);o.startups=Array.isArray(o.startups)?o.startups:[],o.startups.push(oe({id:r,vendorId:r,name:s,companyName:s,status:"pending",email:""})),D(o),W(r);try{V({action:"VENDOR_CREATE",userEmail:(n=R.currentUser)==null?void 0:n.email,targetType:"vendor",targetId:r,metadata:{name:s}})}catch{}}function we(){var n;if(!g)return;const s=de(),r=J(g);r.vendorId=s,r.id=s,r.name=`${r.name||r.companyName||"Vendor"} (Copy)`;const o=J(i);o.startups=Array.isArray(o.startups)?o.startups:[],o.startups.push(r),D(o),W(s);try{V({action:"VENDOR_DUPLICATE",userEmail:(n=R.currentUser)==null?void 0:n.email,targetType:"vendor",targetId:s,metadata:{sourceId:g.vendorId}})}catch{}}function Se(){var r,o;if(!g||!window.confirm(`Delete "${g.name||g.companyName||g.email}"?`))return;const s=J(i);["startups","vendors","companies"].forEach(n=>{Array.isArray(s[n])&&(s[n]=s[n].filter(d=>String(d.vendorId??d.id??d.uid)!==g.vendorId&&(d.email||"").toLowerCase()!==g.email))}),D(s),W(((o=(r=s==null?void 0:s.startups)==null?void 0:r[0])==null?void 0:o.vendorId)||"")}function Ce(){const s=L.current.length>0?L.current:q(localStorage.getItem(ne))??[];if(!s.length)return;const r=s.shift();L.current=s,localStorage.setItem(ne,JSON.stringify(s)),m(r),A(JSON.stringify(r,null,2))}const B=h.useCallback(async()=>{try{const{data:s}=await E.get(`${T}/checkpoints`,{headers:{"x-tenant-id":e,"cache-control":"no-cache"},suppressToast:!0,suppressErrorLog:!0}),r=Array.isArray(s==null?void 0:s.items)?s.items:[];Y(r),localStorage.setItem(ue,JSON.stringify(r.slice(0,2)))}catch{}},[e]),ce=h.useCallback(async({silent:s}={})=>{var r,o,n,d,j,y,u;s?X(!0):Q(!0),F("");try{let S=ae;try{const{data:f}=await E.get(`${T}/live`,{headers:{"x-tenant-id":e,"cache-control":"no-cache"},suppressToast:!0,suppressErrorLog:!0});f&&typeof f=="object"&&Object.keys(f).length&&(S=f)}catch(f){const C=((o=(r=f==null?void 0:f.response)==null?void 0:r.data)==null?void 0:o.message)||(f==null?void 0:f.message)||"Failed to fetch live vendor data";F(C)}const c=J(S);c.startups=Array.isArray(c.startups)?c.startups:[];try{(await E.get("/api/data/vendors",{suppressToast:!0,suppressErrorLog:!0}).then(C=>C.data||[])).forEach(C=>{const O=oe(C),G=c.startups.findIndex(k=>String(k.vendorId||k.id)===O.vendorId||(k.email||k.contactEmail||"").toLowerCase()===(O.email||"").toLowerCase()&&O.email);G>=0?c.startups[G]={...c.startups[G],...O}:c.startups.push(O)})}catch(f){const C=((d=(n=f==null?void 0:f.response)==null?void 0:n.data)==null?void 0:d.message)||(f==null?void 0:f.message)||"Failed to fetch vendors from API";F(O=>O||C)}m(c),A(JSON.stringify(c,null,2)),localStorage.setItem(re,JSON.stringify(c));const I=((j=c==null?void 0:c.startups)==null?void 0:j[0])||((y=c==null?void 0:c.vendors)==null?void 0:y[0])||((u=c==null?void 0:c.companies)==null?void 0:u[0]);W(String((I==null?void 0:I.vendorId)??(I==null?void 0:I.id)??"")||""),await B()}finally{s?X(!1):Q(!1)}},[e,B]);h.useEffect(()=>{ce({silent:!1}).catch(()=>{})},[ce]);async function Ie(){var s;a(null),H(!0);try{await E.put(`${T}/publish`,{data:i},{headers:{"Content-Type":"application/json","x-tenant-id":e}}),U("Published vendor directory to live");try{await V({action:"VENDORS_PUBLISH",userEmail:(s=R.currentUser)==null?void 0:s.email,targetType:"appData",targetId:"vendors",metadata:{count:p.length}})}catch{}await B()}catch(r){a(r.message||"Publish failed")}finally{H(!1)}}async function Ae(s){var r;try{await E.post(`${T}/checkpoints`,{message:s||"Vendor admin update",data:i},{headers:{"Content-Type":"application/json","x-tenant-id":e}}),U("Checkpoint saved");try{await V({action:"VENDORS_CHECKPOINT",userEmail:(r=R.currentUser)==null?void 0:r.email,targetType:"vendors",targetId:"checkpoint",metadata:{message:s||""}})}catch{}await B()}catch(o){a(o.message||"Failed to save checkpoint")}}async function Ee(s){if(window.confirm("Restore this snapshot to LIVE appData.json?"))try{await E.post(`${T}/restore/${s}`,null,{headers:{"x-tenant-id":e}}),U("Restored snapshot"),await B();try{const{data:r}=await E.get(`${T}/live`,{headers:{"x-tenant-id":e,"cache-control":"no-cache"},suppressToast:!0,suppressErrorLog:!0});r&&D(r)}catch{}}catch(r){a(r.message||"Restore failed")}}async function ke(){var s;if(window.confirm("Delete ALL checkpoints on the server?"))try{await E.delete(`${T}/checkpoints`,{headers:{"x-tenant-id":e}}),U("Cleared history");try{await V({action:"VENDORS_HISTORY_CLEAR",userEmail:(s=R.currentUser)==null?void 0:s.email,targetType:"vendors",targetId:"history"})}catch{}await B()}catch(r){a(r.message||"Failed to clear")}}function Le(){try{const s=new Blob([JSON.stringify(i,null,2)],{type:"application/json;charset=utf-8"}),r=URL.createObjectURL(s),o=document.createElement("a");o.href=r;const n=new Date().toISOString().replace(/[:.]/g,"-");o.download=`appData-${e}-${n}.json`,document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(r),U("Exported current working copy")}catch(s){a("Export failed: "+((s==null?void 0:s.message)||"unknown error"))}}function Ue(s){return!s||typeof s!="object"?"File is not valid JSON.":!Array.isArray(s.startups)&&!Array.isArray(s.vendors)&&!Array.isArray(s.companies)?"JSON should include vendors in startups[] or vendors[].":null}async function Oe(s){var o,n,d,j;a(null);const r=(o=s.target.files)==null?void 0:o[0];if(r)try{const y=await r.text(),u=q(y),S=Ue(u);if(S){a(S);return}D(u);const c=((n=u==null?void 0:u.startups)==null?void 0:n[0])||((d=u==null?void 0:u.vendors)==null?void 0:d[0])||((j=u==null?void 0:u.companies)==null?void 0:j[0]);W(String((c==null?void 0:c.vendorId)??(c==null?void 0:c.id)??"")||""),U(`Imported ${r.name}`)}catch(y){a("Import failed: "+((y==null?void 0:y.message)||"unknown error"))}finally{s.target.value=""}}return t.jsx(_e,{children:t.jsxs("div",{className:"container py-4",children:[t.jsx(pe.Suspense,{fallback:null,children:t.jsx("div",{className:"row mb-3",children:t.jsx($e,{})})}),t.jsxs("div",{className:"row g-3 mb-3",children:[t.jsx("div",{className:"col-md-3 col-sm-6",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 bg-gradient-start-5 bg-animated-gradient text-center p-3",children:[t.jsx("i",{className:"bi bi-people text-primary fs-3 mb-2"}),t.jsx("h6",{className:"fw-bold mb-0",children:w.total}),t.jsx("small",{className:"text-muted",children:"Vendors"})]})}),t.jsx("div",{className:"col-md-3 col-sm-6",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 text-center p-3",children:[t.jsx("i",{className:"bi bi-grid text-success fs-3 mb-2"}),t.jsx("h6",{className:"fw-bold mb-0",children:w.categories}),t.jsx("small",{className:"text-muted",children:"Categories"})]})}),t.jsx("div",{className:"col-md-6 col-sm-12",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 p-3",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsx("i",{className:"bi bi-flag text-danger fs-4"}),t.jsx("div",{className:"fw-semibold",children:"Status"})]}),t.jsxs("span",{className:"badge text-bg-light",children:[Object.values(w.byStatus||{}).reduce((s,r)=>s+r,0)," total"]})]}),(()=>{const s=n=>n==="active"?"success":n==="pending"?"warning":n==="suspended"?"danger":"secondary",r=Object.entries(w.byStatus||{}),o=r.reduce((n,[,d])=>n+d,0);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"progress",style:{height:10},"aria-label":"Status proportions",children:r.map(([n,d])=>{const j=o?Math.round(d/o*100):0;return t.jsx("div",{className:`progress-bar bg-${s(n)}`,role:"progressbar",style:{width:`${j}%`},"aria-valuenow":j,"aria-valuemin":0,"aria-valuemax":100,title:`${n}: ${d} (${j}%)`},n)})}),t.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:r.map(([n,d])=>t.jsxs("span",{className:`d-inline-flex align-items-center gap-2 px-2 py-1 rounded-pill border border-${s(n)} text-${s(n)} bg-${s(n)}-subtle small`,children:[t.jsx("i",{className:`bi ${n==="active"?"bi-check-circle":n==="pending"?"bi-hourglass-split":"bi-pause-circle"}`}),t.jsx("span",{className:"text-capitalize",children:n}),t.jsx("span",{className:"badge text-bg-light",children:d})]},n))})]})})()]})})]}),t.jsxs("div",{className:"pt-4 d-flex gap-2 mb-3",children:[t.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>ce({silent:!0}),disabled:P||l,children:l?"Refreshingâ€¦":P?"Loadingâ€¦":"Refresh data"}),t.jsxs("label",{className:"btn btn-light mb-0",children:["Import JSON",t.jsx("input",{type:"file",accept:"application/json",hidden:!0,onChange:Oe})]}),t.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white",onClick:Le,children:"Export Current"}),t.jsx("button",{className:"btn btn-outline-warning",onClick:()=>{if(b)return;window.confirm("This will convert all items under 'startups' into 'vendors' (idempotent) and clear startups. Proceed?")&&ie()},disabled:b||P||l,title:"Convert all startups to vendors and upsert into vendor directory",children:"Migrate startups â†’ vendors"}),t.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:Ie,disabled:b||P||l,title:"Write working copy to live appData.json on the server",children:b?"Publishingâ€¦":"Publish to live"})]}),Z&&t.jsx("div",{className:"alert alert-warning py-2",children:Z}),v&&t.jsx("div",{className:"alert alert-success py-2",children:v}),ee&&t.jsx("div",{className:"alert alert-danger py-2",children:ee}),t.jsx(Je,{onSave:Ae,onClear:ke,onUndo:Ce,disabled:b||P||l}),t.jsxs("div",{className:"d-flex gap-3",children:[t.jsxs("div",{className:"flex-grow-1",children:[t.jsxs("ul",{className:"nav nav-tabs mb-3",children:[t.jsx("li",{className:"nav-item",children:t.jsx("button",{className:`nav-link ${_==="visual"?"active":""}`,onClick:()=>z("visual"),children:"Visual editor"})}),t.jsx("li",{className:"nav-item",children:t.jsx("button",{className:`nav-link ${_==="json"?"active":""}`,onClick:()=>z("json"),children:"JSON editor"})})]}),_==="json"?t.jsx(Pe,{text:N,setText:A,onApply:()=>{const s=q(N);if(!s){a("Invalid JSON");return}D(s),U("Applied JSON to working copy")}}):t.jsx(Me,{vendors:p,category:te,setCategory:xe,status:K,setStatus:ge,allCategories:x,search:se,setSearch:fe,filtered:be,selectedId:le,setSelectedId:W,selected:g,addVendor:je,duplicateVendor:we,deleteVendor:Se,updateVendor:Ne,doSetData:D,data:i})]}),t.jsx("div",{style:{width:380},children:t.jsx(Be,{items:$,onRestore:Ee})})]})]})})}function Je({onSave:e,onClear:i,onUndo:m,disabled:p}){const[x,w]=h.useState("");return t.jsxs("div",{className:"d-flex align-items-center gap-2 mb-3",children:[t.jsx("input",{className:"form-control",placeholder:"Checkpoint message (e.g. 'Approved vendors batch #3')",value:x,onChange:N=>w(N.target.value)}),t.jsx("button",{className:"btn btn-sm rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:()=>e(x),disabled:p,children:"Save checkpoint"}),t.jsx("button",{className:"btn btn-sm rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white",onClick:i,children:"Clear history"}),t.jsx("button",{className:"btn btn-outline-secondary",onClick:m,children:"Undo"})]})}function Pe({text:e,setText:i,onApply:m}){return t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header fw-semibold",children:"Working copy (JSON)"}),t.jsxs("div",{className:"card-body",children:[t.jsx("textarea",{value:e,onChange:p=>i(p.target.value),rows:22,spellCheck:!1,className:"form-control font-monospace"}),t.jsxs("div",{className:"d-flex justify-content-between mt-2",children:[t.jsxs("small",{className:"text-muted",children:["Tip: Press ",t.jsx("kbd",{children:"âŒ˜/Ctrl"}),"+",t.jsx("kbd",{children:"A"})," then ",t.jsx("kbd",{children:"âŒ˜/Ctrl"}),"+",t.jsx("kbd",{children:"C"})," to copy."]}),t.jsx("button",{className:"btn btn-outline-primary",onClick:m,children:"Apply JSON"})]})]})]})}function Me(e){const{vendors:i,category:m,setCategory:p,status:x,setStatus:w,allCategories:N,search:A,setSearch:_,filtered:z,selectedId:P,setSelectedId:Q,selected:l,addVendor:X,duplicateVendor:Z,deleteVendor:F,updateVendor:b,doSetData:H,data:v}=e;function M(a){l&&b({status:a,lastUpdated:new Date().toISOString()})}function ee(){if(!l)return;const a=l.vendorId,L=(l.email||l.contactEmail||"").toLowerCase(),$=J(v);$.services=Array.isArray($.services)?$.services:[],$.services=$.services.map(Y=>{const ie=String(Y.vendorId||"")===String(a),K=(Y.contactEmail||"").toLowerCase()===L;return ie||K?{...Y,vendor:l.name||l.companyName||""}:Y}),H($)}return t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[t.jsx("span",{className:"fw-semibold",children:"Vendor approvals"}),t.jsx("span",{className:"text-muted small",children:"CRUD for vendor directory"})]}),t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"row g-2 align-items-end mb-3",children:[t.jsxs("div",{className:"col-12 col-md-3",children:[t.jsx("label",{className:"form-label",children:"Status"}),t.jsx("select",{className:"form-select",value:x,onChange:a=>w(a.target.value),children:["All","active","pending","suspended"].map(a=>t.jsx("option",{value:a,children:a},a))})]}),t.jsxs("div",{className:"col-12 col-md-3",children:[t.jsx("label",{className:"form-label",children:"Category"}),t.jsx("select",{className:"form-select",value:m,onChange:a=>p(a.target.value),children:N.map(a=>t.jsx("option",{value:a,children:a},a))})]}),t.jsxs("div",{className:"col",children:[t.jsx("label",{className:"form-label",children:"Search"}),t.jsx("input",{className:"form-control",placeholder:"Name, email, vendorId, city, countryâ€¦",value:A,onChange:a=>_(a.target.value)})]}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 w-100",onClick:X,children:"+ Add vendor"})}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white w-100",onClick:Z,disabled:!l,children:"Duplicate"})}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn btn-danger-500 rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white w-100",onClick:F,disabled:!l,children:"Delete"})})]}),t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-4",children:[t.jsxs("div",{className:"list-group mb-2",style:{maxHeight:480,overflow:"auto"},children:[z.map(a=>t.jsxs("button",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center "+(P===a.vendorId?"active":""),onClick:()=>Q(a.vendorId),title:a.email||"",children:[t.jsxs("span",{className:"text-truncate",children:[a.name||a.companyName||"(unnamed)",t.jsx("span",{className:"text-muted",children:" Â· "}),t.jsx("span",{className:"text-truncate",children:a.email||"â€”"})]}),t.jsx("span",{className:"badge text-uppercase "+(a.status==="active"?"text-bg-success":a.status==="pending"?"text-bg-warning":"text-bg-danger"),children:a.status||"â€”"})]},a.vendorId)),!z.length&&t.jsx("div",{className:"text-muted small p-2",children:"No vendors match your filters."})]}),t.jsxs("div",{className:"small text-muted",children:["Showing ",z.length," of ",i.length]})]}),t.jsx("div",{className:"col",children:l?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"row g-3",children:[t.jsxs("div",{className:"col-md-8",children:[t.jsx("label",{className:"form-label",children:"Company / Vendor name"}),t.jsx("input",{className:"form-control",value:l.name||"",onChange:a=>b({name:a.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Contact email"}),t.jsx("input",{className:"form-control",value:l.email||"",onChange:a=>b({email:a.target.value.toLowerCase(),contactEmail:a.target.value.toLowerCase()})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Website"}),t.jsx("input",{className:"form-control",value:l.website||"",onChange:a=>b({website:a.target.value})})]}),t.jsxs("div",{className:"col-md-3",children:[t.jsx("label",{className:"form-label",children:"Phone"}),t.jsx("input",{className:"form-control",value:l.phone||"",onChange:a=>b({phone:a.target.value})})]}),t.jsxs("div",{className:"col-md-3",children:[t.jsx("label",{className:"form-label",children:"Founded (year)"}),t.jsx("input",{className:"form-control",value:l.foundedYear||"",onChange:a=>b({foundedYear:a.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Country"}),t.jsx("input",{className:"form-control",value:l.country||"",onChange:a=>b({country:a.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"City"}),t.jsx("input",{className:"form-control",value:l.city||"",onChange:a=>b({city:a.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Team size"}),t.jsx("input",{className:"form-control",value:l.teamSize||"",onChange:a=>b({teamSize:a.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Logo URL"}),t.jsx("input",{className:"form-control",value:l.logoUrl||"",onChange:a=>b({logoUrl:a.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Banner URL"}),t.jsx("input",{className:"form-control",value:l.bannerUrl||"",onChange:a=>b({bannerUrl:a.target.value})})]}),t.jsxs("div",{className:"col-12",children:[t.jsx("label",{className:"form-label",children:"Description"}),t.jsx("textarea",{className:"form-control",rows:4,value:l.description||"",onChange:a=>b({description:a.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Categories (comma-separated)"}),t.jsx("input",{className:"form-control",value:(l.categories||[]).join(", "),onChange:a=>b({categories:a.target.value.split(",").map(L=>L.trim()).filter(Boolean)})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Tags (comma-separated)"}),t.jsx("input",{className:"form-control",value:(l.tags||[]).join(", "),onChange:a=>b({tags:a.target.value.split(",").map(L=>L.trim()).filter(Boolean)})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Status"}),t.jsxs("select",{className:"form-select",value:l.status||"pending",onChange:a=>M(a.target.value),children:[t.jsx("option",{value:"active",children:"active"}),t.jsx("option",{value:"pending",children:"pending"}),t.jsx("option",{value:"suspended",children:"suspended"})]})]}),t.jsxs("div",{className:"col-md-6 d-flex align-items-end gap-2",children:[t.jsx("button",{className:"btn btn-success",type:"button",onClick:()=>M("active"),children:"Approve"}),t.jsx("button",{className:"btn btn-warning",type:"button",onClick:()=>M("pending"),children:"Mark pending"}),t.jsx("button",{className:"btn btn-danger",type:"button",onClick:()=>M("suspended"),children:"Suspend"})]}),t.jsxs("div",{className:"col-12",children:[t.jsxs("div",{className:"border rounded p-2",children:[t.jsx("div",{className:"text-muted small mb-1",children:"Profile preview"}),t.jsxs("div",{className:"d-flex align-items-center gap-3",children:[t.jsx("img",{src:l.logoUrl||"/assets/images/placeholder-1x1.png",alt:"logo",style:{width:64,height:64,objectFit:"cover",borderRadius:8}}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:l.name||"Vendor"}),t.jsx("div",{className:"text-muted small",children:l.email||"email"}),t.jsx("div",{className:"small",children:l.website?t.jsx("a",{href:l.website,target:"_blank",rel:"noreferrer",children:l.website}):"website"})]})]}),t.jsxs("div",{className:"d-flex gap-2 mt-3",children:[t.jsx("a",{className:"btn btn-outline-primary",href:`/profile-vendor?vendorId=${encodeURIComponent(l.vendorId)}`,target:"_blank",rel:"noreferrer",children:"Open profile"}),t.jsx("button",{className:"btn btn-outline-secondary",type:"button",onClick:ee,children:"Propagate name to listings"})]})]}),l.lastUpdated&&t.jsxs("div",{className:"form-text mt-1",children:["Last updated: ",he(l.lastUpdated)]})]})]})}):t.jsx("div",{className:"text-muted mt-2",children:"Select a vendor to review."})})]})]})]})}function Be({items:e,onRestore:i}){return t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header fw-semibold d-flex justify-content-between",children:[t.jsx("span",{children:"Version history"}),t.jsx("span",{className:"text-muted small",children:"Latest checkpoints"})]}),t.jsxs("div",{className:"list-group list-group-flush",children:[!(e!=null&&e.length)&&t.jsxs("div",{className:"list-group-item text-muted small",children:["No checkpoints yet.",t.jsx("div",{className:"mt-1",children:"Offline cache keeps the two most recent checkpoints."})]}),e==null?void 0:e.map(m=>{var p,x,w,N,A,_;return t.jsx("div",{className:"list-group-item",children:t.jsxs("div",{className:"d-flex justify-content-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:m.message||"(no message)"}),t.jsx("div",{className:"text-muted small",children:he(m.ts)}),t.jsxs("div",{className:"text-muted small",children:["Î” Cohorts: ",((p=m.delta)==null?void 0:p.cohorts)>=0?"+":"",((x=m.delta)==null?void 0:x.cohorts)??0," Â· Î” Courses: ",((w=m.delta)==null?void 0:w.courses)>=0?"+":"",((N=m.delta)==null?void 0:N.courses)??0," Â· Î” Lessons: ",((A=m.delta)==null?void 0:A.lessons)>=0?"+":"",((_=m.delta)==null?void 0:_.lessons)??0]})]}),t.jsxs("div",{className:"d-flex align-items-start gap-2",children:[t.jsx("button",{className:"btn btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 btn-sm",title:"Restore snapshot to LIVE",onClick:()=>i(m.id),children:"Restore"}),t.jsx("a",{className:"btn btn-outline-secondary btn-sm",title:"Download snapshot JSON",href:`${T}/checkpoints/${m.id}`,target:"_blank",rel:"noreferrer",children:"Download"})]})]})},m.id)})]})]})}export{Ye as default};
