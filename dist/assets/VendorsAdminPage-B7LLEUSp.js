const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BannerInnerTwo-UYtTfLzx.js","assets/index-DEYsEGWU.js","assets/index-CUHJT0fJ.css"])))=>i.map(i=>d[i]);
import{r as f,n as J,l as W,j as t,R as oe,_ as Se}from"./index-DEYsEGWU.js";import{a as se}from"./appData-DzAG2zN5.js";import{S as Ce}from"./SideNavAdmin-CApNU8hE.js";import"./iconify-Cs0vGdB3.js";import"./ThemeToggleButton-BrtGvMq8.js";const E="/api/lms",Ie=oe.lazy(()=>Se(()=>import("./BannerInnerTwo-UYtTfLzx.js"),__vite__mapDeps([0,1,2]))),G="vendors_admin_draft_v1",X="vendors_admin_undo_v1",re="vendors_admin_history_cache_v1";function Y(e){try{return typeof e=="string"?JSON.parse(e):e}catch{return null}}function V(e){return JSON.parse(JSON.stringify(e))}function ae(){return Date.now().toString(36)+"-"+Math.random().toString(36).slice(2,8)}function ie(e){return new Date(e).toLocaleString()}function Z(e){const c=((e==null?void 0:e.email)||(e==null?void 0:e.contactEmail)||"").toLowerCase(),u=(e==null?void 0:e.socials)??{},p=String((e==null?void 0:e.vendorId)??(e==null?void 0:e.id)??(e==null?void 0:e.uid)??c??ae()),g=Array.isArray(e==null?void 0:e.categories)?e.categories:typeof(e==null?void 0:e.categories)=="string"?e.categories.split(",").map(b=>b.trim()).filter(Boolean):[],j=Array.isArray(e==null?void 0:e.tags)?e.tags:typeof(e==null?void 0:e.tags)=="string"?e.tags.split(",").map(b=>b.trim()).filter(Boolean):[];return{id:p,vendorId:p,name:(e==null?void 0:e.name)??(e==null?void 0:e.companyName)??(e==null?void 0:e.vendor)??"",companyName:(e==null?void 0:e.companyName)??(e==null?void 0:e.name)??"",contactEmail:c,email:c,ownerUid:(e==null?void 0:e.ownerUid)??(e==null?void 0:e.uid)??"",website:(e==null?void 0:e.website)??"",phone:(e==null?void 0:e.phone)??"",country:(e==null?void 0:e.country)??"",city:(e==null?void 0:e.city)??"",addressLine:(e==null?void 0:e.addressLine)??"",logoUrl:(e==null?void 0:e.logoUrl)??(e==null?void 0:e.logo)??"",bannerUrl:(e==null?void 0:e.bannerUrl)??"",description:(e==null?void 0:e.description)??"",categories:g,tags:j,foundedYear:(e==null?void 0:e.foundedYear)??"",teamSize:(e==null?void 0:e.teamSize)??"",registrationNo:(e==null?void 0:e.registrationNo)??"",status:((e==null?void 0:e.status)||"pending").toLowerCase(),socials:{twitter:u.twitter??"",linkedin:u.linkedin??"",facebook:u.facebook??"",instagram:u.instagram??"",youtube:u.youtube??"",github:u.github??""},lastUpdated:(e==null?void 0:e.lastUpdated)??"",raw:e}}function ke(e=[]){const c=e.length,u=e.reduce((g,j)=>{const b=(j.status||"unknown").toLowerCase();return g[b]=(g[b]||0)+1,g},{}),p=new Set(e.flatMap(g=>Array.isArray(g.categories)?g.categories:[]).map(g=>(g||"").trim()).filter(Boolean)).size;return{total:c,categories:p,byStatus:u}}function Ae(e){var u,p,g,j,b,C;const c=((e==null?void 0:e.contactEmail)||(e==null?void 0:e.email)||"").toLowerCase();return{id:String((e==null?void 0:e.vendorId)||(e==null?void 0:e.id)||""),name:(e==null?void 0:e.name)||(e==null?void 0:e.companyName)||"",contactEmail:c,ownerUid:(e==null?void 0:e.ownerUid)||"",phone:(e==null?void 0:e.phone)||"",website:(e==null?void 0:e.website)||"",description:(e==null?void 0:e.description)||"",logoUrl:(e==null?void 0:e.logoUrl)||(e==null?void 0:e.logo)||"",bannerUrl:(e==null?void 0:e.bannerUrl)||"",country:(e==null?void 0:e.country)||"",city:(e==null?void 0:e.city)||"",addressLine:(e==null?void 0:e.addressLine)||"",socials:{twitter:((u=e==null?void 0:e.socials)==null?void 0:u.twitter)||"",linkedin:((p=e==null?void 0:e.socials)==null?void 0:p.linkedin)||"",facebook:((g=e==null?void 0:e.socials)==null?void 0:g.facebook)||"",instagram:((j=e==null?void 0:e.socials)==null?void 0:j.instagram)||"",youtube:((b=e==null?void 0:e.socials)==null?void 0:b.youtube)||"",github:((C=e==null?void 0:e.socials)==null?void 0:C.github)||""},categories:Array.isArray(e==null?void 0:e.categories)?e.categories:[],tags:Array.isArray(e==null?void 0:e.tags)?e.tags:[],foundedYear:(e==null?void 0:e.foundedYear)||"",teamSize:(e==null?void 0:e.teamSize)||"",registrationNo:(e==null?void 0:e.registrationNo)||"",status:((e==null?void 0:e.status)||"pending").toLowerCase(),kycStatus:((e==null?void 0:e.status)||"pending")==="active"?"approved":(e==null?void 0:e.kycStatus)||"pending"}}function Re(){var ne;const e=f.useMemo(()=>sessionStorage.getItem("tenantId")||"public",[]),[c,u]=f.useState(()=>Y(localStorage.getItem(G))??se),p=f.useMemo(()=>{const s=[Array.isArray(c==null?void 0:c.startups)&&c.startups,Array.isArray(c==null?void 0:c.vendors)&&c.vendors,Array.isArray(c==null?void 0:c.companies)&&c.companies].filter(Boolean),a=new Map;return s.flat().forEach(n=>{const o=Z(n),l=o.vendorId||o.email||o.id;a.has(l)||a.set(l,o)}),Array.from(a.values())},[c]),g=f.useMemo(()=>{const s=new Set;return p.forEach(a=>(a.categories||[]).forEach(n=>n&&s.add(n))),["All",...Array.from(s)]},[p]),j=f.useMemo(()=>ke(p),[p]),[b,C]=f.useState(()=>JSON.stringify(c,null,2)),[L,D]=f.useState("visual"),[R,O]=f.useState(!1),[m,q]=f.useState(null),[Q,w]=f.useState(null),y=f.useRef([]),[v,ee]=f.useState(()=>Y(localStorage.getItem(re))??[]);async function P(){var s,a,n,o;w(null),O(!0);try{const l=await W.post("/api/data/vendors/migrate-startups").then(h=>h.data||{});k(`Migrated startups â†’ vendors (scanned: ${l.scanned??0}, created: ${l.created??0}, updated: ${l.updated??0})`);let i=se;try{const h=await((a=(s=J.currentUser)==null?void 0:s.getIdToken)==null?void 0:a.call(s)),d=await fetch(`${E}/live`,{headers:{"x-tenant-id":e,...h?{Authorization:`Bearer ${h}`}:{}}});d.ok&&(i=await d.json())}catch{}try{const h=await W.get("/api/data/vendors").then(x=>x.data||[]),d=V(i);d.startups=Array.isArray(d.startups)?d.startups:[],h.forEach(x=>{const S=Z(x),A=d.startups.findIndex(U=>String(U.vendorId||U.id)===S.vendorId);A>=0?d.startups[A]={...d.startups[A],...S}:d.startups.push(S)}),i=d}catch{}u(i),C(JSON.stringify(i,null,2)),localStorage.setItem(G,JSON.stringify(i)),await M()}catch(l){w(((o=(n=l==null?void 0:l.response)==null?void 0:n.data)==null?void 0:o.message)||(l==null?void 0:l.message)||"Migration failed")}finally{O(!1)}}const[z,r]=f.useState("All"),[I,T]=f.useState("All"),[$,te]=f.useState(""),[H,B]=f.useState(((ne=p[0])==null?void 0:ne.vendorId)||""),le=f.useMemo(()=>p.filter(s=>{var a;return!(z!=="All"&&(s.status||"").toLowerCase()!==z||I!=="All"&&!((a=s.categories)!=null&&a.includes(I))||$&&!`${s.name} ${s.companyName} ${s.email} ${s.vendorId} ${s.city} ${s.country}`.toLowerCase().includes($.toLowerCase()))}),[p,z,I,$]),N=f.useMemo(()=>p.find(s=>s.vendorId===H),[p,H]);function k(s){q(s),setTimeout(()=>q(null),2500)}function ce(s){const a=Y(localStorage.getItem(X))??[];a.unshift(s);const n=a.slice(0,10);localStorage.setItem(X,JSON.stringify(n)),y.current=n}function _(s){ce(c),u(s),C(JSON.stringify(s,null,2)),localStorage.setItem(G,JSON.stringify(s))}function de(s){if(!N)return;const a=V(c),n=["startups","vendors","companies"];let o=!1;for(const i of n){if(!Array.isArray(a[i]))continue;const h=a[i].findIndex(d=>String(d.vendorId??d.id??d.uid)===N.vendorId||d.email&&d.email.toLowerCase()===N.email);h>=0&&(a[i][h]={...a[i][h],...s,vendorId:N.vendorId,id:N.vendorId},o=!0)}o||(a.startups=Array.isArray(a.startups)?a.startups:[],a.startups.push({...N.raw,...s,vendorId:N.vendorId,id:N.vendorId})),_(a);const l=Ae({...N,...s});if(l.name&&l.contactEmail&&l.id){if(!J.currentUser){w("Please sign in to save vendor changes.");return}W.put(`/api/data/vendors/${encodeURIComponent(l.id)}`,l).then(()=>k("Saved to API")).catch(async i=>{var x,S,A,U,K;const h=(x=i==null?void 0:i.response)==null?void 0:x.status,d=((A=(S=i==null?void 0:i.response)==null?void 0:S.data)==null?void 0:A.message)||(i==null?void 0:i.message)||"Failed to save vendor to API";if(h===404)try{await W.post("/api/data/vendors",l),k("Created vendor in API");return}catch(F){const we=((K=(U=F==null?void 0:F.response)==null?void 0:U.data)==null?void 0:K.message)||(F==null?void 0:F.message)||d;w(we);return}w(d)})}}function me(){const s=prompt("Vendor/company name?");if(!s)return;const a=ae(),n=V(c);n.startups=Array.isArray(n.startups)?n.startups:[],n.startups.push(Z({id:a,vendorId:a,name:s,companyName:s,status:"pending",email:""})),_(n),B(a)}function ue(){if(!N)return;const s=ae(),a=V(N);a.vendorId=s,a.id=s,a.name=`${a.name||a.companyName||"Vendor"} (Copy)`;const n=V(c);n.startups=Array.isArray(n.startups)?n.startups:[],n.startups.push(a),_(n),B(s)}function pe(){var a,n;if(!N||!window.confirm(`Delete "${N.name||N.companyName||N.email}"?`))return;const s=V(c);["startups","vendors","companies"].forEach(o=>{Array.isArray(s[o])&&(s[o]=s[o].filter(l=>String(l.vendorId??l.id??l.uid)!==N.vendorId&&(l.email||"").toLowerCase()!==N.email))}),_(s),B(((n=(a=s==null?void 0:s.startups)==null?void 0:a[0])==null?void 0:n.vendorId)||"")}function he(){const s=y.current.length>0?y.current:Y(localStorage.getItem(X))??[];if(!s.length)return;const a=s.shift();y.current=s,localStorage.setItem(X,JSON.stringify(s)),u(a),C(JSON.stringify(a,null,2))}f.useEffect(()=>{(async()=>{var s,a,n,o,l;O(!0);try{let i=se;try{const d=await((a=(s=J.currentUser)==null?void 0:s.getIdToken)==null?void 0:a.call(s)),x=await fetch(`${E}/live`,{headers:{"x-tenant-id":e,...d?{Authorization:`Bearer ${d}`}:{}}});x.ok&&(i=await x.json())}catch{}try{const d=await W.get("/api/data/vendors").then(S=>S.data||[]),x=V(i);x.startups=Array.isArray(x.startups)?x.startups:[],d.forEach(S=>{const A=Z(S),U=x.startups.findIndex(K=>String(K.vendorId||K.id)===A.vendorId);U>=0?x.startups[U]={...x.startups[U],...A}:x.startups.push(A)}),i=x}catch{}u(i),C(JSON.stringify(i,null,2)),localStorage.setItem(G,JSON.stringify(i));const h=((n=i==null?void 0:i.startups)==null?void 0:n[0])||((o=i==null?void 0:i.vendors)==null?void 0:o[0])||((l=i==null?void 0:i.companies)==null?void 0:l[0]);B(String((h==null?void 0:h.vendorId)??(h==null?void 0:h.id)??"")||""),await M()}catch{}finally{O(!1)}})()},[]);async function M(){var s,a;try{const n=await((a=(s=J.currentUser)==null?void 0:s.getIdToken)==null?void 0:a.call(s)),l=(await fetch(`${E}/checkpoints`,{headers:{"x-tenant-id":e,...n?{Authorization:`Bearer ${n}`}:{}}}).then(i=>i.ok?i.json():{items:[]})).items??[];ee(l),localStorage.setItem(re,JSON.stringify(l.slice(0,2)))}catch{}}async function ge(){var s,a;w(null),O(!0);try{const n=await((a=(s=J.currentUser)==null?void 0:s.getIdToken)==null?void 0:a.call(s)),o=await fetch(`${E}/publish`,{method:"PUT",headers:{"Content-Type":"application/json","x-tenant-id":e,...n?{Authorization:`Bearer ${n}`}:{}},body:JSON.stringify({data:c})});if(!o.ok)throw new Error(await o.text());k("Published vendor directory to live"),await M()}catch(n){w(n.message||"Publish failed")}finally{O(!1)}}async function xe(s){var a,n;try{const o=await((n=(a=J.currentUser)==null?void 0:a.getIdToken)==null?void 0:n.call(a)),l=await fetch(`${E}/checkpoints`,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":e,...o?{Authorization:`Bearer ${o}`}:{}},body:JSON.stringify({message:s||"Vendor admin update",data:c})});if(!l.ok)throw new Error(await l.text());k("Checkpoint saved"),await M()}catch(o){w(o.message||"Failed to save checkpoint")}}async function fe(s){var a,n;if(window.confirm("Restore this snapshot to LIVE appData.json?"))try{const o=await((n=(a=J.currentUser)==null?void 0:a.getIdToken)==null?void 0:n.call(a)),l=await fetch(`${E}/restore/${s}`,{method:"POST",headers:{"x-tenant-id":e,...o?{Authorization:`Bearer ${o}`}:{}}});if(!l.ok)throw new Error(await l.text());k("Restored snapshot"),await M();const i=await fetch(`${E}/live`).then(h=>h.json());_(i)}catch(o){w(o.message||"Restore failed")}}async function be(){var s,a;if(window.confirm("Delete ALL checkpoints on the server?"))try{const n=await((a=(s=J.currentUser)==null?void 0:s.getIdToken)==null?void 0:a.call(s)),o=await fetch(`${E}/checkpoints`,{method:"DELETE",headers:{"x-tenant-id":e,...n?{Authorization:`Bearer ${n}`}:{}}});if(!o.ok)throw new Error(await o.text());k("Cleared history"),await M()}catch(n){w(n.message||"Failed to clear")}}function ye(){try{const s=new Blob([JSON.stringify(c,null,2)],{type:"application/json;charset=utf-8"}),a=URL.createObjectURL(s),n=document.createElement("a");n.href=a;const o=new Date().toISOString().replace(/[:.]/g,"-");n.download=`appData-${e}-${o}.json`,document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(a),k("Exported current working copy")}catch(s){w("Export failed: "+((s==null?void 0:s.message)||"unknown error"))}}function je(s){return!s||typeof s!="object"?"File is not valid JSON.":!Array.isArray(s.startups)&&!Array.isArray(s.vendors)&&!Array.isArray(s.companies)?"JSON should include vendors in startups[] or vendors[].":null}async function Ne(s){var n,o,l,i;w(null);const a=(n=s.target.files)==null?void 0:n[0];if(a)try{const h=await a.text(),d=Y(h),x=je(d);if(x){w(x);return}_(d);const S=((o=d==null?void 0:d.startups)==null?void 0:o[0])||((l=d==null?void 0:d.vendors)==null?void 0:l[0])||((i=d==null?void 0:d.companies)==null?void 0:i[0]);B(String((S==null?void 0:S.vendorId)??(S==null?void 0:S.id)??"")||""),k(`Imported ${a.name}`)}catch(h){w("Import failed: "+((h==null?void 0:h.message)||"unknown error"))}finally{s.target.value=""}}return t.jsx(Ce,{children:t.jsxs("div",{className:"container py-4",children:[t.jsx(oe.Suspense,{fallback:null,children:t.jsx("div",{className:"row mb-3",children:t.jsx(Ie,{})})}),t.jsxs("div",{className:"row g-3 mb-3",children:[t.jsx("div",{className:"col-md-3 col-sm-6",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 bg-gradient-start-5 bg-animated-gradient text-center p-3",children:[t.jsx("i",{className:"bi bi-people text-primary fs-3 mb-2"}),t.jsx("h6",{className:"fw-bold mb-0",children:j.total}),t.jsx("small",{className:"text-muted",children:"Vendors"})]})}),t.jsx("div",{className:"col-md-3 col-sm-6",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 text-center p-3",children:[t.jsx("i",{className:"bi bi-grid text-success fs-3 mb-2"}),t.jsx("h6",{className:"fw-bold mb-0",children:j.categories}),t.jsx("small",{className:"text-muted",children:"Categories"})]})}),t.jsx("div",{className:"col-md-6 col-sm-12",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 p-3",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsx("i",{className:"bi bi-flag text-danger fs-4"}),t.jsx("div",{className:"fw-semibold",children:"Status"})]}),t.jsxs("span",{className:"badge text-bg-light",children:[Object.values(j.byStatus||{}).reduce((s,a)=>s+a,0)," total"]})]}),(()=>{const s=o=>o==="active"?"success":o==="pending"?"warning":o==="suspended"?"danger":"secondary",a=Object.entries(j.byStatus||{}),n=a.reduce((o,[,l])=>o+l,0);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"progress",style:{height:10},"aria-label":"Status proportions",children:a.map(([o,l])=>{const i=n?Math.round(l/n*100):0;return t.jsx("div",{className:`progress-bar bg-${s(o)}`,role:"progressbar",style:{width:`${i}%`},"aria-valuenow":i,"aria-valuemin":0,"aria-valuemax":100,title:`${o}: ${l} (${i}%)`},o)})}),t.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:a.map(([o,l])=>t.jsxs("span",{className:`d-inline-flex align-items-center gap-2 px-2 py-1 rounded-pill border border-${s(o)} text-${s(o)} bg-${s(o)}-subtle small`,children:[t.jsx("i",{className:`bi ${o==="active"?"bi-check-circle":o==="pending"?"bi-hourglass-split":"bi-pause-circle"}`}),t.jsx("span",{className:"text-capitalize",children:o}),t.jsx("span",{className:"badge text-bg-light",children:l})]},o))})]})})()]})})]}),t.jsxs("div",{className:"pt-4 d-flex gap-2 mb-3",children:[t.jsxs("label",{className:"btn btn-light mb-0",children:["Import JSON",t.jsx("input",{type:"file",accept:"application/json",hidden:!0,onChange:Ne})]}),t.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white",onClick:ye,children:"Export Current"}),t.jsx("button",{className:"btn btn-outline-warning",onClick:()=>{if(R)return;window.confirm("This will convert all items under 'startups' into 'vendors' (idempotent) and clear startups. Proceed?")&&P()},disabled:R,title:"Convert all startups to vendors and upsert into vendor directory",children:"Migrate startups â†’ vendors"}),t.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:ge,disabled:R,title:"Write working copy to live appData.json on the server",children:R?"Publishingâ€¦":"Publish to live"})]}),m&&t.jsx("div",{className:"alert alert-success py-2",children:m}),Q&&t.jsx("div",{className:"alert alert-danger py-2",children:Q}),t.jsx($e,{onSave:xe,onClear:be,onUndo:he,disabled:R}),t.jsxs("div",{className:"d-flex gap-3",children:[t.jsxs("div",{className:"flex-grow-1",children:[t.jsxs("ul",{className:"nav nav-tabs mb-3",children:[t.jsx("li",{className:"nav-item",children:t.jsx("button",{className:`nav-link ${L==="visual"?"active":""}`,onClick:()=>D("visual"),children:"Visual editor"})}),t.jsx("li",{className:"nav-item",children:t.jsx("button",{className:`nav-link ${L==="json"?"active":""}`,onClick:()=>D("json"),children:"JSON editor"})})]}),L==="json"?t.jsx(Ue,{text:b,setText:C,onApply:()=>{const s=Y(b);if(!s){w("Invalid JSON");return}_(s),k("Applied JSON to working copy")}}):t.jsx(Ee,{vendors:p,category:I,setCategory:T,status:z,setStatus:r,allCategories:g,search:$,setSearch:te,filtered:le,selectedId:H,setSelectedId:B,selected:N,addVendor:me,duplicateVendor:ue,deleteVendor:pe,updateVendor:de,doSetData:_,data:c})]}),t.jsx("div",{style:{width:380},children:t.jsx(Le,{items:v,onRestore:fe})})]})]})})}function $e({onSave:e,onClear:c,onUndo:u,disabled:p}){const[g,j]=f.useState("");return t.jsxs("div",{className:"d-flex align-items-center gap-2 mb-3",children:[t.jsx("input",{className:"form-control",placeholder:"Checkpoint message (e.g. 'Approved vendors batch #3')",value:g,onChange:b=>j(b.target.value)}),t.jsx("button",{className:"btn btn-sm rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:()=>e(g),disabled:p,children:"Save checkpoint"}),t.jsx("button",{className:"btn btn-sm rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white",onClick:c,children:"Clear history"}),t.jsx("button",{className:"btn btn-outline-secondary",onClick:u,children:"Undo"})]})}function Ue({text:e,setText:c,onApply:u}){return t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header fw-semibold",children:"Working copy (JSON)"}),t.jsxs("div",{className:"card-body",children:[t.jsx("textarea",{value:e,onChange:p=>c(p.target.value),rows:22,spellCheck:!1,className:"form-control font-monospace"}),t.jsxs("div",{className:"d-flex justify-content-between mt-2",children:[t.jsxs("small",{className:"text-muted",children:["Tip: Press ",t.jsx("kbd",{children:"âŒ˜/Ctrl"}),"+",t.jsx("kbd",{children:"A"})," then ",t.jsx("kbd",{children:"âŒ˜/Ctrl"}),"+",t.jsx("kbd",{children:"C"})," to copy."]}),t.jsx("button",{className:"btn btn-outline-primary",onClick:u,children:"Apply JSON"})]})]})]})}function Ee(e){const{vendors:c,category:u,setCategory:p,status:g,setStatus:j,allCategories:b,search:C,setSearch:L,filtered:D,selectedId:R,setSelectedId:O,selected:m,addVendor:q,duplicateVendor:Q,deleteVendor:w,updateVendor:y,doSetData:v,data:ee}=e;function P(r){m&&y({status:r,lastUpdated:new Date().toISOString()})}function z(){if(!m)return;const r=m.vendorId,I=(m.email||m.contactEmail||"").toLowerCase(),T=V(ee);T.services=Array.isArray(T.services)?T.services:[],T.services=T.services.map($=>{const te=String($.vendorId||"")===String(r),H=($.contactEmail||"").toLowerCase()===I;return te||H?{...$,vendor:m.name||m.companyName||""}:$}),v(T)}return t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[t.jsx("span",{className:"fw-semibold",children:"Vendor approvals"}),t.jsx("span",{className:"text-muted small",children:"CRUD for vendor directory"})]}),t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"row g-2 align-items-end mb-3",children:[t.jsxs("div",{className:"col-12 col-md-3",children:[t.jsx("label",{className:"form-label",children:"Status"}),t.jsx("select",{className:"form-select",value:g,onChange:r=>j(r.target.value),children:["All","active","pending","suspended"].map(r=>t.jsx("option",{value:r,children:r},r))})]}),t.jsxs("div",{className:"col-12 col-md-3",children:[t.jsx("label",{className:"form-label",children:"Category"}),t.jsx("select",{className:"form-select",value:u,onChange:r=>p(r.target.value),children:b.map(r=>t.jsx("option",{value:r,children:r},r))})]}),t.jsxs("div",{className:"col",children:[t.jsx("label",{className:"form-label",children:"Search"}),t.jsx("input",{className:"form-control",placeholder:"Name, email, vendorId, city, countryâ€¦",value:C,onChange:r=>L(r.target.value)})]}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 w-100",onClick:q,children:"+ Add vendor"})}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white w-100",onClick:Q,disabled:!m,children:"Duplicate"})}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn btn-danger-500 rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white w-100",onClick:w,disabled:!m,children:"Delete"})})]}),t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-4",children:[t.jsxs("div",{className:"list-group mb-2",style:{maxHeight:480,overflow:"auto"},children:[D.map(r=>t.jsxs("button",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center "+(R===r.vendorId?"active":""),onClick:()=>O(r.vendorId),title:r.email||"",children:[t.jsxs("span",{className:"text-truncate",children:[r.name||r.companyName||"(unnamed)",t.jsx("span",{className:"text-muted",children:" Â· "}),t.jsx("span",{className:"text-truncate",children:r.email||"â€”"})]}),t.jsx("span",{className:"badge text-uppercase "+(r.status==="active"?"text-bg-success":r.status==="pending"?"text-bg-warning":"text-bg-danger"),children:r.status||"â€”"})]},r.vendorId)),!D.length&&t.jsx("div",{className:"text-muted small p-2",children:"No vendors match your filters."})]}),t.jsxs("div",{className:"small text-muted",children:["Showing ",D.length," of ",c.length]})]}),t.jsx("div",{className:"col",children:m?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"row g-3",children:[t.jsxs("div",{className:"col-md-8",children:[t.jsx("label",{className:"form-label",children:"Company / Vendor name"}),t.jsx("input",{className:"form-control",value:m.name||"",onChange:r=>y({name:r.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Contact email"}),t.jsx("input",{className:"form-control",value:m.email||"",onChange:r=>y({email:r.target.value.toLowerCase(),contactEmail:r.target.value.toLowerCase()})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Website"}),t.jsx("input",{className:"form-control",value:m.website||"",onChange:r=>y({website:r.target.value})})]}),t.jsxs("div",{className:"col-md-3",children:[t.jsx("label",{className:"form-label",children:"Phone"}),t.jsx("input",{className:"form-control",value:m.phone||"",onChange:r=>y({phone:r.target.value})})]}),t.jsxs("div",{className:"col-md-3",children:[t.jsx("label",{className:"form-label",children:"Founded (year)"}),t.jsx("input",{className:"form-control",value:m.foundedYear||"",onChange:r=>y({foundedYear:r.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Country"}),t.jsx("input",{className:"form-control",value:m.country||"",onChange:r=>y({country:r.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"City"}),t.jsx("input",{className:"form-control",value:m.city||"",onChange:r=>y({city:r.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Team size"}),t.jsx("input",{className:"form-control",value:m.teamSize||"",onChange:r=>y({teamSize:r.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Logo URL"}),t.jsx("input",{className:"form-control",value:m.logoUrl||"",onChange:r=>y({logoUrl:r.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Banner URL"}),t.jsx("input",{className:"form-control",value:m.bannerUrl||"",onChange:r=>y({bannerUrl:r.target.value})})]}),t.jsxs("div",{className:"col-12",children:[t.jsx("label",{className:"form-label",children:"Description"}),t.jsx("textarea",{className:"form-control",rows:4,value:m.description||"",onChange:r=>y({description:r.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Categories (comma-separated)"}),t.jsx("input",{className:"form-control",value:(m.categories||[]).join(", "),onChange:r=>y({categories:r.target.value.split(",").map(I=>I.trim()).filter(Boolean)})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Tags (comma-separated)"}),t.jsx("input",{className:"form-control",value:(m.tags||[]).join(", "),onChange:r=>y({tags:r.target.value.split(",").map(I=>I.trim()).filter(Boolean)})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Status"}),t.jsxs("select",{className:"form-select",value:m.status||"pending",onChange:r=>P(r.target.value),children:[t.jsx("option",{value:"active",children:"active"}),t.jsx("option",{value:"pending",children:"pending"}),t.jsx("option",{value:"suspended",children:"suspended"})]})]}),t.jsxs("div",{className:"col-md-6 d-flex align-items-end gap-2",children:[t.jsx("button",{className:"btn btn-success",type:"button",onClick:()=>P("active"),children:"Approve"}),t.jsx("button",{className:"btn btn-warning",type:"button",onClick:()=>P("pending"),children:"Mark pending"}),t.jsx("button",{className:"btn btn-danger",type:"button",onClick:()=>P("suspended"),children:"Suspend"})]}),t.jsxs("div",{className:"col-12",children:[t.jsxs("div",{className:"border rounded p-2",children:[t.jsx("div",{className:"text-muted small mb-1",children:"Profile preview"}),t.jsxs("div",{className:"d-flex align-items-center gap-3",children:[t.jsx("img",{src:m.logoUrl||"/assets/images/placeholder-1x1.png",alt:"logo",style:{width:64,height:64,objectFit:"cover",borderRadius:8}}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:m.name||"Vendor"}),t.jsx("div",{className:"text-muted small",children:m.email||"email"}),t.jsx("div",{className:"small",children:m.website?t.jsx("a",{href:m.website,target:"_blank",rel:"noreferrer",children:m.website}):"website"})]})]}),t.jsxs("div",{className:"d-flex gap-2 mt-3",children:[t.jsx("a",{className:"btn btn-outline-primary",href:`/profile-vendor?vendorId=${encodeURIComponent(m.vendorId)}`,target:"_blank",rel:"noreferrer",children:"Open profile"}),t.jsx("button",{className:"btn btn-outline-secondary",type:"button",onClick:z,children:"Propagate name to listings"})]})]}),m.lastUpdated&&t.jsxs("div",{className:"form-text mt-1",children:["Last updated: ",ie(m.lastUpdated)]})]})]})}):t.jsx("div",{className:"text-muted mt-2",children:"Select a vendor to review."})})]})]})]})}function Le({items:e,onRestore:c}){return t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header fw-semibold d-flex justify-content-between",children:[t.jsx("span",{children:"Version history"}),t.jsx("span",{className:"text-muted small",children:"Latest checkpoints"})]}),t.jsxs("div",{className:"list-group list-group-flush",children:[!(e!=null&&e.length)&&t.jsxs("div",{className:"list-group-item text-muted small",children:["No checkpoints yet.",t.jsx("div",{className:"mt-1",children:"Offline cache keeps the two most recent checkpoints."})]}),e==null?void 0:e.map(u=>{var p,g,j,b,C,L;return t.jsx("div",{className:"list-group-item",children:t.jsxs("div",{className:"d-flex justify-content-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:u.message||"(no message)"}),t.jsx("div",{className:"text-muted small",children:ie(u.ts)}),t.jsxs("div",{className:"text-muted small",children:["Î” Cohorts: ",((p=u.delta)==null?void 0:p.cohorts)>=0?"+":"",((g=u.delta)==null?void 0:g.cohorts)??0," Â· Î” Courses: ",((j=u.delta)==null?void 0:j.courses)>=0?"+":"",((b=u.delta)==null?void 0:b.courses)??0," Â· Î” Lessons: ",((C=u.delta)==null?void 0:C.lessons)>=0?"+":"",((L=u.delta)==null?void 0:L.lessons)??0]})]}),t.jsxs("div",{className:"d-flex align-items-start gap-2",children:[t.jsx("button",{className:"btn btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 btn-sm",title:"Restore snapshot to LIVE",onClick:()=>c(u.id),children:"Restore"}),t.jsx("a",{className:"btn btn-outline-secondary btn-sm",title:"Download snapshot JSON",href:`${E}/checkpoints/${u.id}`,target:"_blank",rel:"noreferrer",children:"Download"})]})]})},u.id)})]})]})}export{Re as default};
