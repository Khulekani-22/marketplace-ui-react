import{u as $,p as A,r as c,j as e}from"./index-HPcd39yI.js";import{I as y}from"./iconify-D0q36GhI.js";import{M as E}from"./MasterLayout-Ucxt6LSp.js";import{a as D}from"./appData-7vHZWftc.js";const v="lms_completed_v1",F=()=>{try{const d=localStorage.getItem(v),x=d?JSON.parse(d):[];return new Set(Array.isArray(x)?x:[])}catch{return new Set}},P=d=>{try{localStorage.setItem(v,JSON.stringify(Array.from(d)))}catch{}};function U(){const d=$(),x=A(),m=c.useMemo(()=>{var s;return((s=D)==null?void 0:s.cohorts)??[]},[]),p=m.length>0,N=new URLSearchParams(x.search),w=N.get("cohort")||(p?m[0].id:""),S=N.get("course")||"",[u,C]=c.useState(w),[r,j]=c.useState(S),[h,k]=c.useState(F);c.useEffect(()=>{const s=new URLSearchParams(x.search);u?s.set("cohort",u):s.delete("cohort"),r?s.set("course",r):s.delete("course"),d({search:s.toString()},{replace:!0})},[u,r]),c.useEffect(()=>P(h),[h]);const a=c.useMemo(()=>m.find(s=>s.id===u)||m[0]||null,[m,u]),l=c.useMemo(()=>Array.isArray(a==null?void 0:a.courses)?a.courses:[],[a]);c.useEffect(()=>{if(!(l!=null&&l.length)){j("");return}l.some(t=>t.id===r)||j(l[0].id)},[l,r]);const n=c.useMemo(()=>l.find(s=>s.id===r)||null,[l,r]),g=(n==null?void 0:n.lessons)??[],f=g.length,L=g.filter(s=>h.has(s.id)).length,M=f?Math.round(L/f*100):0;function I(s){k(t=>{const i=new Set(t);return i.has(s)?i.delete(s):i.add(s),i})}return e.jsx(E,{children:e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"row align-items-center mb-24",children:[e.jsxs("div",{className:"col",children:[e.jsx("h2",{className:"mb-4",children:"LMS Â· Cohorts & Courses"}),e.jsxs("p",{className:"text-secondary-light mb-0 d-none",children:["Data loaded at build-time from ",e.jsx("code",{children:"backend/appData.json"})," (no network)."]})]}),e.jsx("div",{className:"col-auto",children:p&&e.jsx("select",{className:"form-select btn btn-outline-primary-600 border rounded-pill px-16",value:(a==null?void 0:a.id)??"",onChange:s=>C(s.target.value),"aria-label":"Select cohort",children:m.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})})]}),p?e.jsxs("div",{className:"row g-24",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card radius-12 p-16 mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-12",children:[e.jsx("h5",{className:"mb-0",children:(a==null?void 0:a.name)||"Cohort"}),e.jsxs("span",{className:"badge bg-primary-600",children:[l.length," modules"]})]}),l.length?e.jsx("div",{className:"row g-16 mb-3 py-3",children:l.map(s=>{const t=s.lessons??[],i=t.filter(b=>h.has(b.id)).length,o=t.length?Math.round(i/t.length*100):0;return e.jsx("div",{className:"col-12 py-2",children:e.jsxs("button",{type:"button",onClick:()=>j(s.id),className:`w-100 d-flex align-items-stretch gap-12 p-12 radius-12 border ${r===s.id?"border-primary":"border-neutral-200"} bg-base text-start`,children:[e.jsx("img",{src:s.videoThumbnail,alt:s.title,className:"rounded",style:{width:96,height:64,objectFit:"cover"},onError:b=>b.currentTarget.style.visibility="hidden"}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("h6",{className:"mb-4",children:s.title}),e.jsxs("span",{className:"text-sm text-secondary-light",children:[t.length," lessons"]})]}),e.jsx("p",{className:"mb-8 text-secondary-light",children:s.description}),e.jsx("div",{className:"progress",style:{height:8},children:e.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${o}%`},"aria-valuenow":o,"aria-valuemin":"0","aria-valuemax":"100"})}),e.jsxs("small",{className:"text-secondary-light",children:[o,"% complete"]})]})]})},s.id)})}):e.jsx("div",{className:"text-secondary-light",children:"No courses in this cohort."})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsx("div",{className:"card radius-12 p-16",children:n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-12",children:[e.jsx("h5",{className:"mb-0",children:n.title}),e.jsxs("span",{className:"badge bg-success-subtle text-success-main",children:[M,"% complete"]})]}),e.jsx("img",{src:n.videoThumbnail,alt:n.title,className:"rounded mb-16 w-100",style:{maxHeight:260,objectFit:"cover"},onError:s=>s.currentTarget.style.display="none"}),e.jsx("p",{className:"text-secondary-light",children:n.description}),e.jsx("hr",{className:"my-16"}),e.jsxs("h6",{className:"mb-12 d-flex align-items-center gap-2",children:[e.jsx(y,{icon:"solar:play-circle-linear"}),"Lessons"]}),g.length?e.jsx("ul",{className:"list-group mb-16",children:g.map(s=>e.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between",children:[e.jsxs("div",{className:"d-flex align-items-center gap-10",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:h.has(s.id),onChange:()=>I(s.id),"aria-label":`Mark ${s.title} complete`}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:s.title}),e.jsx("small",{className:"text-secondary-light",children:s.duration})]})]}),h.has(s.id)&&e.jsx("span",{className:"badge bg-success-subtle text-success-main",children:"Done"})]},s.id))}):e.jsx("div",{className:"text-secondary-light",children:"No lessons listed."}),n.assessment&&e.jsxs(e.Fragment,{children:[e.jsxs("h6",{className:"mb-12 d-flex align-items-center gap-2",children:[e.jsx(y,{icon:"solar:checklist-minimalistic-linear"}),"Assessment: ",n.assessment.title]}),(n.assessment.questions||[]).map((s,t)=>e.jsxs("div",{className:"mb-12",children:[e.jsx("div",{className:"fw-semibold mb-8",children:s.text}),(s.options||[]).map((i,o)=>e.jsxs("div",{className:"form-check mb-6",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:`q-${t}`,id:`q-${t}-${o}`}),e.jsx("label",{className:"form-check-label",htmlFor:`q-${t}-${o}`,children:i.text})]},o))]},t)),e.jsx("button",{type:"button",className:"btn btn-primary",children:"Submit Answers"})]})]}):e.jsx("div",{className:"text-secondary-light",children:"Select a module to view details."})})})]}):e.jsx("div",{className:"alert alert-warning",children:"No cohorts found in appData.json."})]})})}export{U as default};
