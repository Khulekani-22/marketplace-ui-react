const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BannerInnerTwo-Ll2Xc1x-.js","assets/index-DaarVqB8.js","assets/index-BXSesTeZ.css"])))=>i.map(i=>d[i]);
import{r as y,b as C,a as G,j as t,R as ce,w as V,_ as Ae}from"./index-DaarVqB8.js";import{a as se}from"./appData-vWFasogN.js";import{M as ke}from"./MasterLayout-2uOgNMve.js";import"./iconify-CVdOCQR-.js";const L="/api/lms",Ee=ce.lazy(()=>Ae(()=>import("./BannerInnerTwo-Ll2Xc1x-.js"),__vite__mapDeps([0,1,2]))),X="vendors_admin_draft_v1",Z="vendors_admin_undo_v1",le="vendors_admin_history_cache_v1";function K(e){try{return typeof e=="string"?JSON.parse(e):e}catch{return null}}function J(e){return JSON.parse(JSON.stringify(e))}function re(){return Date.now().toString(36)+"-"+Math.random().toString(36).slice(2,8)}function de(e){return new Date(e).toLocaleString()}function v(e){const c=((e==null?void 0:e.email)||(e==null?void 0:e.contactEmail)||"").toLowerCase(),m=(e==null?void 0:e.socials)??{},h=String((e==null?void 0:e.vendorId)??(e==null?void 0:e.id)??(e==null?void 0:e.uid)??c??re()),f=Array.isArray(e==null?void 0:e.categories)?e.categories:typeof(e==null?void 0:e.categories)=="string"?e.categories.split(",").map(N=>N.trim()).filter(Boolean):[],w=Array.isArray(e==null?void 0:e.tags)?e.tags:typeof(e==null?void 0:e.tags)=="string"?e.tags.split(",").map(N=>N.trim()).filter(Boolean):[];return{id:h,vendorId:h,name:(e==null?void 0:e.name)??(e==null?void 0:e.companyName)??(e==null?void 0:e.vendor)??"",companyName:(e==null?void 0:e.companyName)??(e==null?void 0:e.name)??"",contactEmail:c,email:c,ownerUid:(e==null?void 0:e.ownerUid)??(e==null?void 0:e.uid)??"",website:(e==null?void 0:e.website)??"",phone:(e==null?void 0:e.phone)??"",country:(e==null?void 0:e.country)??"",city:(e==null?void 0:e.city)??"",addressLine:(e==null?void 0:e.addressLine)??"",logoUrl:(e==null?void 0:e.logoUrl)??(e==null?void 0:e.logo)??"",bannerUrl:(e==null?void 0:e.bannerUrl)??"",description:(e==null?void 0:e.description)??"",categories:f,tags:w,foundedYear:(e==null?void 0:e.foundedYear)??"",teamSize:(e==null?void 0:e.teamSize)??"",registrationNo:(e==null?void 0:e.registrationNo)??"",status:((e==null?void 0:e.status)||"pending").toLowerCase(),socials:{twitter:m.twitter??"",linkedin:m.linkedin??"",facebook:m.facebook??"",instagram:m.instagram??"",youtube:m.youtube??"",github:m.github??""},lastUpdated:(e==null?void 0:e.lastUpdated)??"",raw:e}}function Ue(e=[]){const c=e.length,m=e.reduce((f,w)=>{const N=(w.status||"unknown").toLowerCase();return f[N]=(f[N]||0)+1,f},{}),h=new Set(e.flatMap(f=>Array.isArray(f.categories)?f.categories:[]).map(f=>(f||"").trim()).filter(Boolean)).size;return{total:c,categories:h,byStatus:m}}function Oe(e){var m,h,f,w,N,A;const c=((e==null?void 0:e.contactEmail)||(e==null?void 0:e.email)||"").toLowerCase();return{id:String((e==null?void 0:e.vendorId)||(e==null?void 0:e.id)||""),name:(e==null?void 0:e.name)||(e==null?void 0:e.companyName)||"",contactEmail:c,ownerUid:(e==null?void 0:e.ownerUid)||"",phone:(e==null?void 0:e.phone)||"",website:(e==null?void 0:e.website)||"",description:(e==null?void 0:e.description)||"",logoUrl:(e==null?void 0:e.logoUrl)||(e==null?void 0:e.logo)||"",bannerUrl:(e==null?void 0:e.bannerUrl)||"",country:(e==null?void 0:e.country)||"",city:(e==null?void 0:e.city)||"",addressLine:(e==null?void 0:e.addressLine)||"",socials:{twitter:((m=e==null?void 0:e.socials)==null?void 0:m.twitter)||"",linkedin:((h=e==null?void 0:e.socials)==null?void 0:h.linkedin)||"",facebook:((f=e==null?void 0:e.socials)==null?void 0:f.facebook)||"",instagram:((w=e==null?void 0:e.socials)==null?void 0:w.instagram)||"",youtube:((N=e==null?void 0:e.socials)==null?void 0:N.youtube)||"",github:((A=e==null?void 0:e.socials)==null?void 0:A.github)||""},categories:Array.isArray(e==null?void 0:e.categories)?e.categories:[],tags:Array.isArray(e==null?void 0:e.tags)?e.tags:[],foundedYear:(e==null?void 0:e.foundedYear)||"",teamSize:(e==null?void 0:e.teamSize)||"",registrationNo:(e==null?void 0:e.registrationNo)||"",status:((e==null?void 0:e.status)||"pending").toLowerCase(),kycStatus:((e==null?void 0:e.status)||"pending")==="active"?"approved":(e==null?void 0:e.kycStatus)||"pending"}}function Pe(){var ne;const e=y.useMemo(()=>sessionStorage.getItem("tenantId")||"vendor",[]),[c,m]=y.useState(()=>K(localStorage.getItem(X))??se),h=y.useMemo(()=>{const a=[Array.isArray(c==null?void 0:c.startups)&&c.startups,Array.isArray(c==null?void 0:c.vendors)&&c.vendors,Array.isArray(c==null?void 0:c.companies)&&c.companies].filter(Boolean),s=new Map;return a.flat().forEach(o=>{const r=v(o),i=r.vendorId||r.email||r.id;s.has(i)||s.set(i,r)}),Array.from(s.values())},[c]),f=y.useMemo(()=>{const a=new Set;return h.forEach(s=>(s.categories||[]).forEach(o=>o&&a.add(o))),["All",...Array.from(a)]},[h]),w=y.useMemo(()=>Ue(h),[h]),[N,A]=y.useState(()=>JSON.stringify(c,null,2)),[$,B]=y.useState("visual"),[P,_]=y.useState(!1),[d,q]=y.useState(null),[Q,S]=y.useState(null),j=y.useRef([]),[ee,te]=y.useState(()=>K(localStorage.getItem(le))??[]);async function z(){var a,s,o,r,i;S(null),_(!0);try{const l=await G.post("/api/data/vendors/migrate-startups").then(u=>u.data||{});E(`Migrated startups → vendors (scanned: ${l.scanned??0}, created: ${l.created??0}, updated: ${l.updated??0})`);try{await V({action:"VENDORS_MIGRATE",userEmail:(a=C.currentUser)==null?void 0:a.email,targetType:"vendors",targetId:"migration",metadata:l})}catch{}let x=se;try{const u=await((o=(s=C.currentUser)==null?void 0:s.getIdToken)==null?void 0:o.call(s)),p=await fetch(`${L}/live`,{headers:{"x-tenant-id":e,...u?{Authorization:`Bearer ${u}`}:{}}});p.ok&&(x=await p.json())}catch{}try{const u=await G.get("/api/data/vendors").then(b=>b.data||[]),p=J(x);p.startups=Array.isArray(p.startups)?p.startups:[],u.forEach(b=>{const U=v(b),O=p.startups.findIndex(I=>String(I.vendorId||I.id)===U.vendorId);O>=0?p.startups[O]={...p.startups[O],...U}:p.startups.push(U)}),x=p}catch{}m(x),A(JSON.stringify(x,null,2)),localStorage.setItem(X,JSON.stringify(x)),await F()}catch(l){S(((i=(r=l==null?void 0:l.response)==null?void 0:r.data)==null?void 0:i.message)||(l==null?void 0:l.message)||"Migration failed")}finally{_(!1)}}const[M,n]=y.useState("All"),[k,R]=y.useState("All"),[T,ae]=y.useState(""),[W,H]=y.useState(((ne=h[0])==null?void 0:ne.vendorId)||""),me=y.useMemo(()=>h.filter(a=>{var s;return!(M!=="All"&&(a.status||"").toLowerCase()!==M||k!=="All"&&!((s=a.categories)!=null&&s.includes(k))||T&&!`${a.name} ${a.companyName} ${a.email} ${a.vendorId} ${a.city} ${a.country}`.toLowerCase().includes(T.toLowerCase()))}),[h,M,k,T]),g=y.useMemo(()=>h.find(a=>a.vendorId===W),[h,W]);function E(a){q(a),setTimeout(()=>q(null),2500)}function ue(a){const s=K(localStorage.getItem(Z))??[];s.unshift(a);const o=s.slice(0,10);localStorage.setItem(Z,JSON.stringify(o)),j.current=o}function D(a){ue(c),m(a),A(JSON.stringify(a,null,2)),localStorage.setItem(X,JSON.stringify(a))}function pe(a){var l,x;if(!g)return;const s=J(c),o=["startups","vendors","companies"];let r=!1;for(const u of o){if(!Array.isArray(s[u]))continue;const p=s[u].findIndex(b=>String(b.vendorId??b.id??b.uid)===g.vendorId||b.email&&b.email.toLowerCase()===g.email);p>=0&&(s[u][p]={...s[u][p],...a,vendorId:g.vendorId,id:g.vendorId},r=!0)}r||(s.startups=Array.isArray(s.startups)?s.startups:[],s.startups.push({...g.raw,...a,vendorId:g.vendorId,id:g.vendorId})),D(s);try{const u=g.status;typeof a.status<"u"&&a.status!==u?V({action:"VENDOR_STATUS_CHANGE",userEmail:(l=C.currentUser)==null?void 0:l.email,targetType:"vendor",targetId:g.vendorId,metadata:{from:u,to:a.status,email:g.email}}):V({action:"VENDOR_UPDATE",userEmail:(x=C.currentUser)==null?void 0:x.email,targetType:"vendor",targetId:g.vendorId,metadata:{patch:a,email:g.email}})}catch{}const i=Oe({...g,...a});if(i.name&&i.contactEmail&&i.id){if(!C.currentUser){S("Please sign in to save vendor changes.");return}(async()=>{var u,p,b,U,O;try{await G.put(`/api/data/vendors/${encodeURIComponent(i.id)}`,i),E("Saved to API")}catch(I){const oe=(u=I==null?void 0:I.response)==null?void 0:u.status,ie=((b=(p=I==null?void 0:I.response)==null?void 0:p.data)==null?void 0:b.message)||(I==null?void 0:I.message)||"Failed to save vendor to API";if(oe===404||oe===400)try{await G.post("/api/data/vendors",i),E("Created vendor in API");return}catch(Y){const Ie=((O=(U=Y==null?void 0:Y.response)==null?void 0:U.data)==null?void 0:O.message)||(Y==null?void 0:Y.message)||ie;S(Ie);return}S(ie)}})()}}function he(){var r;const a=prompt("Vendor/company name?");if(!a)return;const s=re(),o=J(c);o.startups=Array.isArray(o.startups)?o.startups:[],o.startups.push(v({id:s,vendorId:s,name:a,companyName:a,status:"pending",email:""})),D(o),H(s);try{V({action:"VENDOR_CREATE",userEmail:(r=C.currentUser)==null?void 0:r.email,targetType:"vendor",targetId:s,metadata:{name:a}})}catch{}}function ge(){var r;if(!g)return;const a=re(),s=J(g);s.vendorId=a,s.id=a,s.name=`${s.name||s.companyName||"Vendor"} (Copy)`;const o=J(c);o.startups=Array.isArray(o.startups)?o.startups:[],o.startups.push(s),D(o),H(a);try{V({action:"VENDOR_DUPLICATE",userEmail:(r=C.currentUser)==null?void 0:r.email,targetType:"vendor",targetId:a,metadata:{sourceId:g.vendorId}})}catch{}}function xe(){var s,o;if(!g||!window.confirm(`Delete "${g.name||g.companyName||g.email}"?`))return;const a=J(c);["startups","vendors","companies"].forEach(r=>{Array.isArray(a[r])&&(a[r]=a[r].filter(i=>String(i.vendorId??i.id??i.uid)!==g.vendorId&&(i.email||"").toLowerCase()!==g.email))}),D(a),H(((o=(s=a==null?void 0:a.startups)==null?void 0:s[0])==null?void 0:o.vendorId)||"")}function fe(){const a=j.current.length>0?j.current:K(localStorage.getItem(Z))??[];if(!a.length)return;const s=a.shift();j.current=a,localStorage.setItem(Z,JSON.stringify(a)),m(s),A(JSON.stringify(s,null,2))}y.useEffect(()=>{(async()=>{var a,s,o,r,i;_(!0);try{let l=se;try{const u=await((s=(a=C.currentUser)==null?void 0:a.getIdToken)==null?void 0:s.call(a)),p=await fetch(`${L}/live`,{headers:{"x-tenant-id":e,...u?{Authorization:`Bearer ${u}`}:{}}});p.ok&&(l=await p.json())}catch{}try{const u=await G.get("/api/data/vendors").then(b=>b.data||[]),p=J(l);p.startups=Array.isArray(p.startups)?p.startups:[],u.forEach(b=>{const U=v(b),O=p.startups.findIndex(I=>String(I.vendorId||I.id)===U.vendorId);O>=0?p.startups[O]={...p.startups[O],...U}:p.startups.push(U)}),l=p}catch{}m(l),A(JSON.stringify(l,null,2)),localStorage.setItem(X,JSON.stringify(l));const x=((o=l==null?void 0:l.startups)==null?void 0:o[0])||((r=l==null?void 0:l.vendors)==null?void 0:r[0])||((i=l==null?void 0:l.companies)==null?void 0:i[0]);H(String((x==null?void 0:x.vendorId)??(x==null?void 0:x.id)??"")||""),await F()}catch{}finally{_(!1)}})()},[]);async function F(){var a,s;try{const o=await((s=(a=C.currentUser)==null?void 0:a.getIdToken)==null?void 0:s.call(a)),i=(await fetch(`${L}/checkpoints`,{headers:{"x-tenant-id":e,...o?{Authorization:`Bearer ${o}`}:{}}}).then(l=>l.ok?l.json():{items:[]})).items??[];te(i),localStorage.setItem(le,JSON.stringify(i.slice(0,2)))}catch{}}async function be(){var a,s,o;S(null),_(!0);try{const r=await((s=(a=C.currentUser)==null?void 0:a.getIdToken)==null?void 0:s.call(a)),i=await fetch(`${L}/publish`,{method:"PUT",headers:{"Content-Type":"application/json","x-tenant-id":e,...r?{Authorization:`Bearer ${r}`}:{}},body:JSON.stringify({data:c})});if(!i.ok)throw new Error(await i.text());E("Published vendor directory to live");try{await V({action:"VENDORS_PUBLISH",userEmail:(o=C.currentUser)==null?void 0:o.email,targetType:"appData",targetId:"vendors",metadata:{count:h.length}})}catch{}await F()}catch(r){S(r.message||"Publish failed")}finally{_(!1)}}async function ye(a){var s,o,r;try{const i=await((o=(s=C.currentUser)==null?void 0:s.getIdToken)==null?void 0:o.call(s)),l=await fetch(`${L}/checkpoints`,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":e,...i?{Authorization:`Bearer ${i}`}:{}},body:JSON.stringify({message:a||"Vendor admin update",data:c})});if(!l.ok)throw new Error(await l.text());E("Checkpoint saved");try{await V({action:"VENDORS_CHECKPOINT",userEmail:(r=C.currentUser)==null?void 0:r.email,targetType:"vendors",targetId:"checkpoint",metadata:{message:a||""}})}catch{}await F()}catch(i){S(i.message||"Failed to save checkpoint")}}async function Ne(a){var s,o;if(window.confirm("Restore this snapshot to LIVE appData.json?"))try{const r=await((o=(s=C.currentUser)==null?void 0:s.getIdToken)==null?void 0:o.call(s)),i=await fetch(`${L}/restore/${a}`,{method:"POST",headers:{"x-tenant-id":e,...r?{Authorization:`Bearer ${r}`}:{}}});if(!i.ok)throw new Error(await i.text());E("Restored snapshot"),await F();const l=await fetch(`${L}/live`).then(x=>x.json());D(l)}catch(r){S(r.message||"Restore failed")}}async function je(){var a,s,o;if(window.confirm("Delete ALL checkpoints on the server?"))try{const r=await((s=(a=C.currentUser)==null?void 0:a.getIdToken)==null?void 0:s.call(a)),i=await fetch(`${L}/checkpoints`,{method:"DELETE",headers:{"x-tenant-id":e,...r?{Authorization:`Bearer ${r}`}:{}}});if(!i.ok)throw new Error(await i.text());E("Cleared history");try{await V({action:"VENDORS_HISTORY_CLEAR",userEmail:(o=C.currentUser)==null?void 0:o.email,targetType:"vendors",targetId:"history"})}catch{}await F()}catch(r){S(r.message||"Failed to clear")}}function we(){try{const a=new Blob([JSON.stringify(c,null,2)],{type:"application/json;charset=utf-8"}),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s;const r=new Date().toISOString().replace(/[:.]/g,"-");o.download=`appData-${e}-${r}.json`,document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(s),E("Exported current working copy")}catch(a){S("Export failed: "+((a==null?void 0:a.message)||"unknown error"))}}function Se(a){return!a||typeof a!="object"?"File is not valid JSON.":!Array.isArray(a.startups)&&!Array.isArray(a.vendors)&&!Array.isArray(a.companies)?"JSON should include vendors in startups[] or vendors[].":null}async function Ce(a){var o,r,i,l;S(null);const s=(o=a.target.files)==null?void 0:o[0];if(s)try{const x=await s.text(),u=K(x),p=Se(u);if(p){S(p);return}D(u);const b=((r=u==null?void 0:u.startups)==null?void 0:r[0])||((i=u==null?void 0:u.vendors)==null?void 0:i[0])||((l=u==null?void 0:u.companies)==null?void 0:l[0]);H(String((b==null?void 0:b.vendorId)??(b==null?void 0:b.id)??"")||""),E(`Imported ${s.name}`)}catch(x){S("Import failed: "+((x==null?void 0:x.message)||"unknown error"))}finally{a.target.value=""}}return t.jsx(ke,{children:t.jsxs("div",{className:"container py-4",children:[t.jsx(ce.Suspense,{fallback:null,children:t.jsx("div",{className:"row mb-3",children:t.jsx(Ee,{})})}),t.jsxs("div",{className:"row g-3 mb-3",children:[t.jsx("div",{className:"col-md-3 col-sm-6",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 bg-gradient-start-5 bg-animated-gradient text-center p-3",children:[t.jsx("i",{className:"bi bi-people text-primary fs-3 mb-2"}),t.jsx("h6",{className:"fw-bold mb-0",children:w.total}),t.jsx("small",{className:"text-muted",children:"Vendors"})]})}),t.jsx("div",{className:"col-md-3 col-sm-6",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 text-center p-3",children:[t.jsx("i",{className:"bi bi-grid text-success fs-3 mb-2"}),t.jsx("h6",{className:"fw-bold mb-0",children:w.categories}),t.jsx("small",{className:"text-muted",children:"Categories"})]})}),t.jsx("div",{className:"col-md-6 col-sm-12",children:t.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 p-3",children:[t.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[t.jsxs("div",{className:"d-flex align-items-center gap-2",children:[t.jsx("i",{className:"bi bi-flag text-danger fs-4"}),t.jsx("div",{className:"fw-semibold",children:"Status"})]}),t.jsxs("span",{className:"badge text-bg-light",children:[Object.values(w.byStatus||{}).reduce((a,s)=>a+s,0)," total"]})]}),(()=>{const a=r=>r==="active"?"success":r==="pending"?"warning":r==="suspended"?"danger":"secondary",s=Object.entries(w.byStatus||{}),o=s.reduce((r,[,i])=>r+i,0);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"progress",style:{height:10},"aria-label":"Status proportions",children:s.map(([r,i])=>{const l=o?Math.round(i/o*100):0;return t.jsx("div",{className:`progress-bar bg-${a(r)}`,role:"progressbar",style:{width:`${l}%`},"aria-valuenow":l,"aria-valuemin":0,"aria-valuemax":100,title:`${r}: ${i} (${l}%)`},r)})}),t.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:s.map(([r,i])=>t.jsxs("span",{className:`d-inline-flex align-items-center gap-2 px-2 py-1 rounded-pill border border-${a(r)} text-${a(r)} bg-${a(r)}-subtle small`,children:[t.jsx("i",{className:`bi ${r==="active"?"bi-check-circle":r==="pending"?"bi-hourglass-split":"bi-pause-circle"}`}),t.jsx("span",{className:"text-capitalize",children:r}),t.jsx("span",{className:"badge text-bg-light",children:i})]},r))})]})})()]})})]}),t.jsxs("div",{className:"pt-4 d-flex gap-2 mb-3",children:[t.jsxs("label",{className:"btn btn-light mb-0",children:["Import JSON",t.jsx("input",{type:"file",accept:"application/json",hidden:!0,onChange:Ce})]}),t.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white",onClick:we,children:"Export Current"}),t.jsx("button",{className:"btn btn-outline-warning",onClick:()=>{if(P)return;window.confirm("This will convert all items under 'startups' into 'vendors' (idempotent) and clear startups. Proceed?")&&z()},disabled:P,title:"Convert all startups to vendors and upsert into vendor directory",children:"Migrate startups → vendors"}),t.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:be,disabled:P,title:"Write working copy to live appData.json on the server",children:P?"Publishing…":"Publish to live"})]}),d&&t.jsx("div",{className:"alert alert-success py-2",children:d}),Q&&t.jsx("div",{className:"alert alert-danger py-2",children:Q}),t.jsx(Te,{onSave:ye,onClear:je,onUndo:fe,disabled:P}),t.jsxs("div",{className:"d-flex gap-3",children:[t.jsxs("div",{className:"flex-grow-1",children:[t.jsxs("ul",{className:"nav nav-tabs mb-3",children:[t.jsx("li",{className:"nav-item",children:t.jsx("button",{className:`nav-link ${$==="visual"?"active":""}`,onClick:()=>B("visual"),children:"Visual editor"})}),t.jsx("li",{className:"nav-item",children:t.jsx("button",{className:`nav-link ${$==="json"?"active":""}`,onClick:()=>B("json"),children:"JSON editor"})})]}),$==="json"?t.jsx(Le,{text:N,setText:A,onApply:()=>{const a=K(N);if(!a){S("Invalid JSON");return}D(a),E("Applied JSON to working copy")}}):t.jsx($e,{vendors:h,category:k,setCategory:R,status:M,setStatus:n,allCategories:f,search:T,setSearch:ae,filtered:me,selectedId:W,setSelectedId:H,selected:g,addVendor:he,duplicateVendor:ge,deleteVendor:xe,updateVendor:pe,doSetData:D,data:c})]}),t.jsx("div",{style:{width:380},children:t.jsx(_e,{items:ee,onRestore:Ne})})]})]})})}function Te({onSave:e,onClear:c,onUndo:m,disabled:h}){const[f,w]=y.useState("");return t.jsxs("div",{className:"d-flex align-items-center gap-2 mb-3",children:[t.jsx("input",{className:"form-control",placeholder:"Checkpoint message (e.g. 'Approved vendors batch #3')",value:f,onChange:N=>w(N.target.value)}),t.jsx("button",{className:"btn btn-sm rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:()=>e(f),disabled:h,children:"Save checkpoint"}),t.jsx("button",{className:"btn btn-sm rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white",onClick:c,children:"Clear history"}),t.jsx("button",{className:"btn btn-outline-secondary",onClick:m,children:"Undo"})]})}function Le({text:e,setText:c,onApply:m}){return t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header fw-semibold",children:"Working copy (JSON)"}),t.jsxs("div",{className:"card-body",children:[t.jsx("textarea",{value:e,onChange:h=>c(h.target.value),rows:22,spellCheck:!1,className:"form-control font-monospace"}),t.jsxs("div",{className:"d-flex justify-content-between mt-2",children:[t.jsxs("small",{className:"text-muted",children:["Tip: Press ",t.jsx("kbd",{children:"⌘/Ctrl"}),"+",t.jsx("kbd",{children:"A"})," then ",t.jsx("kbd",{children:"⌘/Ctrl"}),"+",t.jsx("kbd",{children:"C"})," to copy."]}),t.jsx("button",{className:"btn btn-outline-primary",onClick:m,children:"Apply JSON"})]})]})]})}function $e(e){const{vendors:c,category:m,setCategory:h,status:f,setStatus:w,allCategories:N,search:A,setSearch:$,filtered:B,selectedId:P,setSelectedId:_,selected:d,addVendor:q,duplicateVendor:Q,deleteVendor:S,updateVendor:j,doSetData:ee,data:te}=e;function z(n){d&&j({status:n,lastUpdated:new Date().toISOString()})}function M(){if(!d)return;const n=d.vendorId,k=(d.email||d.contactEmail||"").toLowerCase(),R=J(te);R.services=Array.isArray(R.services)?R.services:[],R.services=R.services.map(T=>{const ae=String(T.vendorId||"")===String(n),W=(T.contactEmail||"").toLowerCase()===k;return ae||W?{...T,vendor:d.name||d.companyName||""}:T}),ee(R)}return t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[t.jsx("span",{className:"fw-semibold",children:"Vendor approvals"}),t.jsx("span",{className:"text-muted small",children:"CRUD for vendor directory"})]}),t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"row g-2 align-items-end mb-3",children:[t.jsxs("div",{className:"col-12 col-md-3",children:[t.jsx("label",{className:"form-label",children:"Status"}),t.jsx("select",{className:"form-select",value:f,onChange:n=>w(n.target.value),children:["All","active","pending","suspended"].map(n=>t.jsx("option",{value:n,children:n},n))})]}),t.jsxs("div",{className:"col-12 col-md-3",children:[t.jsx("label",{className:"form-label",children:"Category"}),t.jsx("select",{className:"form-select",value:m,onChange:n=>h(n.target.value),children:N.map(n=>t.jsx("option",{value:n,children:n},n))})]}),t.jsxs("div",{className:"col",children:[t.jsx("label",{className:"form-label",children:"Search"}),t.jsx("input",{className:"form-control",placeholder:"Name, email, vendorId, city, country…",value:A,onChange:n=>$(n.target.value)})]}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 w-100",onClick:q,children:"+ Add vendor"})}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white w-100",onClick:Q,disabled:!d,children:"Duplicate"})}),t.jsx("div",{className:"col-auto",children:t.jsx("button",{className:"btn btn-danger-500 rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white w-100",onClick:S,disabled:!d,children:"Delete"})})]}),t.jsxs("div",{className:"row",children:[t.jsxs("div",{className:"col-4",children:[t.jsxs("div",{className:"list-group mb-2",style:{maxHeight:480,overflow:"auto"},children:[B.map(n=>t.jsxs("button",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center "+(P===n.vendorId?"active":""),onClick:()=>_(n.vendorId),title:n.email||"",children:[t.jsxs("span",{className:"text-truncate",children:[n.name||n.companyName||"(unnamed)",t.jsx("span",{className:"text-muted",children:" · "}),t.jsx("span",{className:"text-truncate",children:n.email||"—"})]}),t.jsx("span",{className:"badge text-uppercase "+(n.status==="active"?"text-bg-success":n.status==="pending"?"text-bg-warning":"text-bg-danger"),children:n.status||"—"})]},n.vendorId)),!B.length&&t.jsx("div",{className:"text-muted small p-2",children:"No vendors match your filters."})]}),t.jsxs("div",{className:"small text-muted",children:["Showing ",B.length," of ",c.length]})]}),t.jsx("div",{className:"col",children:d?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"row g-3",children:[t.jsxs("div",{className:"col-md-8",children:[t.jsx("label",{className:"form-label",children:"Company / Vendor name"}),t.jsx("input",{className:"form-control",value:d.name||"",onChange:n=>j({name:n.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Contact email"}),t.jsx("input",{className:"form-control",value:d.email||"",onChange:n=>j({email:n.target.value.toLowerCase(),contactEmail:n.target.value.toLowerCase()})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Website"}),t.jsx("input",{className:"form-control",value:d.website||"",onChange:n=>j({website:n.target.value})})]}),t.jsxs("div",{className:"col-md-3",children:[t.jsx("label",{className:"form-label",children:"Phone"}),t.jsx("input",{className:"form-control",value:d.phone||"",onChange:n=>j({phone:n.target.value})})]}),t.jsxs("div",{className:"col-md-3",children:[t.jsx("label",{className:"form-label",children:"Founded (year)"}),t.jsx("input",{className:"form-control",value:d.foundedYear||"",onChange:n=>j({foundedYear:n.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Country"}),t.jsx("input",{className:"form-control",value:d.country||"",onChange:n=>j({country:n.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"City"}),t.jsx("input",{className:"form-control",value:d.city||"",onChange:n=>j({city:n.target.value})})]}),t.jsxs("div",{className:"col-md-4",children:[t.jsx("label",{className:"form-label",children:"Team size"}),t.jsx("input",{className:"form-control",value:d.teamSize||"",onChange:n=>j({teamSize:n.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Logo URL"}),t.jsx("input",{className:"form-control",value:d.logoUrl||"",onChange:n=>j({logoUrl:n.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Banner URL"}),t.jsx("input",{className:"form-control",value:d.bannerUrl||"",onChange:n=>j({bannerUrl:n.target.value})})]}),t.jsxs("div",{className:"col-12",children:[t.jsx("label",{className:"form-label",children:"Description"}),t.jsx("textarea",{className:"form-control",rows:4,value:d.description||"",onChange:n=>j({description:n.target.value})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Categories (comma-separated)"}),t.jsx("input",{className:"form-control",value:(d.categories||[]).join(", "),onChange:n=>j({categories:n.target.value.split(",").map(k=>k.trim()).filter(Boolean)})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Tags (comma-separated)"}),t.jsx("input",{className:"form-control",value:(d.tags||[]).join(", "),onChange:n=>j({tags:n.target.value.split(",").map(k=>k.trim()).filter(Boolean)})})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label",children:"Status"}),t.jsxs("select",{className:"form-select",value:d.status||"pending",onChange:n=>z(n.target.value),children:[t.jsx("option",{value:"active",children:"active"}),t.jsx("option",{value:"pending",children:"pending"}),t.jsx("option",{value:"suspended",children:"suspended"})]})]}),t.jsxs("div",{className:"col-md-6 d-flex align-items-end gap-2",children:[t.jsx("button",{className:"btn btn-success",type:"button",onClick:()=>z("active"),children:"Approve"}),t.jsx("button",{className:"btn btn-warning",type:"button",onClick:()=>z("pending"),children:"Mark pending"}),t.jsx("button",{className:"btn btn-danger",type:"button",onClick:()=>z("suspended"),children:"Suspend"})]}),t.jsxs("div",{className:"col-12",children:[t.jsxs("div",{className:"border rounded p-2",children:[t.jsx("div",{className:"text-muted small mb-1",children:"Profile preview"}),t.jsxs("div",{className:"d-flex align-items-center gap-3",children:[t.jsx("img",{src:d.logoUrl||"/assets/images/placeholder-1x1.png",alt:"logo",style:{width:64,height:64,objectFit:"cover",borderRadius:8}}),t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:d.name||"Vendor"}),t.jsx("div",{className:"text-muted small",children:d.email||"email"}),t.jsx("div",{className:"small",children:d.website?t.jsx("a",{href:d.website,target:"_blank",rel:"noreferrer",children:d.website}):"website"})]})]}),t.jsxs("div",{className:"d-flex gap-2 mt-3",children:[t.jsx("a",{className:"btn btn-outline-primary",href:`/profile-vendor?vendorId=${encodeURIComponent(d.vendorId)}`,target:"_blank",rel:"noreferrer",children:"Open profile"}),t.jsx("button",{className:"btn btn-outline-secondary",type:"button",onClick:M,children:"Propagate name to listings"})]})]}),d.lastUpdated&&t.jsxs("div",{className:"form-text mt-1",children:["Last updated: ",de(d.lastUpdated)]})]})]})}):t.jsx("div",{className:"text-muted mt-2",children:"Select a vendor to review."})})]})]})]})}function _e({items:e,onRestore:c}){return t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header fw-semibold d-flex justify-content-between",children:[t.jsx("span",{children:"Version history"}),t.jsx("span",{className:"text-muted small",children:"Latest checkpoints"})]}),t.jsxs("div",{className:"list-group list-group-flush",children:[!(e!=null&&e.length)&&t.jsxs("div",{className:"list-group-item text-muted small",children:["No checkpoints yet.",t.jsx("div",{className:"mt-1",children:"Offline cache keeps the two most recent checkpoints."})]}),e==null?void 0:e.map(m=>{var h,f,w,N,A,$;return t.jsx("div",{className:"list-group-item",children:t.jsxs("div",{className:"d-flex justify-content-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"fw-semibold",children:m.message||"(no message)"}),t.jsx("div",{className:"text-muted small",children:de(m.ts)}),t.jsxs("div",{className:"text-muted small",children:["Δ Cohorts: ",((h=m.delta)==null?void 0:h.cohorts)>=0?"+":"",((f=m.delta)==null?void 0:f.cohorts)??0," · Δ Courses: ",((w=m.delta)==null?void 0:w.courses)>=0?"+":"",((N=m.delta)==null?void 0:N.courses)??0," · Δ Lessons: ",((A=m.delta)==null?void 0:A.lessons)>=0?"+":"",(($=m.delta)==null?void 0:$.lessons)??0]})]}),t.jsxs("div",{className:"d-flex align-items-start gap-2",children:[t.jsx("button",{className:"btn btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 btn-sm",title:"Restore snapshot to LIVE",onClick:()=>c(m.id),children:"Restore"}),t.jsx("a",{className:"btn btn-outline-secondary btn-sm",title:"Download snapshot JSON",href:`${L}/checkpoints/${m.id}`,target:"_blank",rel:"noreferrer",children:"Download"})]})]})},m.id)})]})]})}export{Pe as default};
