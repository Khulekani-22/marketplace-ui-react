import{h as J,a as f,c as b,l as z,j as e,M as O,m as q}from"./index-BDu5z-7V.js";import{B as K}from"./Breadcrumb-DVRu1IC-.js";import{r as o}from"./vendor-C0neu5ZX.js";import{M as h}from"./Modal-BWS4rl-x.js";import"./firebase-DMviGkW7.js";import"./utils-B2rxisVD.js";import"./index-DbrnFe3V.js";import"./removeClass-yVR4guBs.js";import"./index-DWoOtcwh.js";function W(p){return e.jsxDEV("span",{children:[1,2,3,4,5].map(N=>e.jsxDEV("span",{style:{color:p>=N?"#f5a623":"#ccc",fontSize:16},children:"â˜…"},N,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:59,columnNumber:9},this))},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:57,columnNumber:5},this)}function le(){const[p,N]=o.useState({open:!1,service:null}),[c,d]=o.useState({open:!1,service:null,rating:0,comment:"",busy:!1,error:""});async function H(){if(c.service){if(c.rating<1||c.rating>5){d(s=>({...s,error:"Please select a star rating (1â€“5)."}));return}d(s=>({...s,busy:!0,error:""}));try{await f.post(`/api/data/services/${encodeURIComponent(c.service.id)}/reviews`,{rating:c.rating,comment:c.comment,author:b.currentUser?.displayName||b.currentUser?.email||"Guest",authorEmail:b.currentUser?.email||"",title:c.service.title||"",vendor:c.service.vendor||"",contactEmail:c.service.vendor||""}),d({open:!1,service:null,rating:0,comment:"",busy:!1,error:""}),alert("Review submitted. Thank you!")}catch(s){d(a=>({...a,error:s?.response?.data?.message||s?.message||"Failed to submit review",busy:!1}))}}}const[E,j]=o.useState(!0),[A,P]=o.useState([]),[M,V]=o.useState([]),[_,X]=o.useState([]),[g,w]=o.useState("subscriptions"),[C,v]=o.useState(""),[y,I]=o.useState({}),[U,F]=o.useState(!1),R=o.useMemo(()=>sessionStorage.getItem("tenantId")||"vendor",[]),{appData:S}=J(),x=o.useMemo(()=>Array.isArray(S?.services)?S.services:[],[S]),B=o.useCallback(async s=>{if(!s.size)return[];const a=Math.max(50,Math.min(500,s.size*3));try{const{data:i}=await f.get("/api/data/services",{params:{page:1,pageSize:a},suppressToast:!0,suppressErrorLog:!0}),r=(Array.isArray(i?.items)?i.items:[]).filter(m=>s.has(String(m?.id??""))),u=new Set(r.map(m=>String(m?.id??"")));if(u.size!==s.size&&x.length){const m=[...s].filter(l=>!u.has(l));if(m.length){const l=x.filter(n=>m.includes(String(n?.id??"")));if(l.length)return[...r,...l]}}return r}catch(i){if(console.warn("Failed to fetch services from API; using appData fallback",i),x.length)return x.filter(t=>s.has(String(t?.id??"")));throw i}},[x]),L=o.useCallback(async()=>{try{console.log("ðŸ”— Testing API connection..."),console.log("ðŸ”— Current API base URL:",f.defaults.baseURL);const s=await f.get("/api/health");if(console.log("âœ… API health check passed:",s.data),b.currentUser){console.log("ðŸ” Testing authenticated endpoint...");const a=await f.get("/api/subscriptions/my");console.log("âœ… Subscriptions endpoint test:",a.data)}}catch(s){console.error("âŒ API connection test failed:",s),console.error("âŒ Error details:",s?.response?.data)}},[]);o.useEffect(()=>{L()},[L]);const k=o.useCallback(async(s={})=>{const{silent:a,signal:i}=s;a?F(!0):j(!0),v("");try{if(!b.currentUser){console.log("ðŸ” No authenticated user found"),i?.aborted||(P([]),V([]),X([]));return}console.log("ðŸ“¡ Fetching subscriptions and bookings for user:",b.currentUser.email);const t=await z();console.log("ðŸ“‹ Raw subscriptions from API:",t),i?.aborted||X(t);const r=new Set(t.filter(l=>(l.type||"service")==="service"&&l.serviceId!=null).map(l=>String(l.serviceId)));console.log("ðŸ” Service IDs from subscriptions:",Array.from(r));const u=await B(r);console.log("âœ… Matched services:",u.length,u.map(l=>({id:l.id,title:l.title})));let m=[];try{const{data:l}=await f.get("/api/subscriptions/bookings/mine",{suppressToast:!0,suppressErrorLog:!0});Array.isArray(l?.bookings)&&(m=l.bookings.map(n=>({id:n.id||"",serviceId:String(n.serviceId||""),serviceTitle:n.serviceTitle||"Unknown Service",vendorName:n.vendorName||n.vendor||"",scheduledDate:n.scheduledDate||"",scheduledSlot:n.scheduledSlot||"",status:n.status||"scheduled",price:Number(n.price||0),bookedAt:n.bookedAt||n.createdAt||"",imageUrl:n.imageUrl||""})),console.log("ðŸ“… Fetched bookings:",m.length))}catch(l){console.warn("âš ï¸ Failed to fetch bookings:",l)}i?.aborted||(P(u),V(m))}catch(t){console.error("âŒ Failed to load data:",t),i?.aborted||v(t?.message||"Failed to load subscriptions")}finally{i?.aborted||(a?F(!1):j(!1))}},[B]);o.useEffect(()=>{const s=new AbortController;return k({silent:!1,signal:s.signal}),()=>{s.abort()}},[k,R]);async function $(s){const a=String(s);console.log("ðŸ”„ Starting unsubscribe process for service:",a),console.log("ðŸ”„ Current user:",b.currentUser?.email),console.log("ðŸ”„ Current tenant:",R),I(i=>({...i,[a]:!0}));try{console.log("ðŸ” Fetching current subscriptions before unsubscribe...");const i=await z();console.log("ðŸ“‹ Current subscriptions:",i);const t=i.find(r=>String(r.serviceId)===a);if(console.log("ðŸŽ¯ Target subscription to cancel:",t),!t){console.log("âš ï¸ No subscription found in cache for service:",a),P(r=>r.filter(u=>String(u.id)!==a)),alert(`âœ… Service ${a} removed from your subscriptions (was already cancelled)`);return}console.log("ðŸ“¡ Calling unsubscribeFromService API...");try{const r=await q(a);console.log("âœ… Unsubscribe API success:",r),alert(`âœ… Successfully unsubscribed from service ${a}`)}catch(r){if(r?.response?.status===404)console.log("âš ï¸ Backend says subscription not found (404) - treating as already cancelled"),alert(`âœ… Service ${a} removed from your subscriptions (was already cancelled on server)`);else throw r}P(r=>{const u=r.filter(m=>String(m.id)!==a);return console.log("ðŸ“ Updated items count:",u.length),u}),console.log("ï¿½ï¸ Clearing subscription from local cache...");try{const r=`sl_subscriptions_cache_v1:${b.currentUser?.uid||b.currentUser?.email}`,u=localStorage.getItem(r);if(u){const l=JSON.parse(u).filter(n=>String(n.serviceId)!==a);localStorage.setItem(r,JSON.stringify(l)),console.log("ðŸ—‘ï¸ Removed subscription from cache, remaining:",l.length)}}catch(r){console.log("âš ï¸ Failed to update cache:",r)}console.log("âœ… Unsubscribe completed - skipping refresh to prevent reappearing")}catch(i){console.error("âŒ Failed to unsubscribe:",i),console.error("âŒ Error response:",i?.response),console.error("âŒ Error data:",i?.response?.data),console.error("âŒ Error status:",i?.response?.status);const t=i?.response?.data?.message||i?.message||"Failed to unsubscribe";alert(`âŒ Unsubscribe failed for service ${a}: ${t}`)}finally{I(i=>({...i,[a]:!1})),console.log("ðŸ Unsubscribe process completed for service:",a)}}const D=s=>{if(!s)return"";try{return new Date(s).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"})}catch{return s}},T=s=>{if(!s)return"";const[a]=s.split(":"),i=parseInt(a,10),t=i>=12?"PM":"AM";return`${i>12?i-12:i===0?12:i}:00 ${t}`},G=(s="scheduled")=>{switch(s.toLowerCase()){case"completed":return"bg-success-600";case"scheduled":return"bg-primary-600";case"canceled":case"cancelled":return"bg-danger-600";default:return"bg-secondary-600"}};return e.jsxDEV(O,{children:[e.jsxDEV(K,{title:"My Subscriptions & Bookings"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:385,columnNumber:7},this),e.jsxDEV("div",{className:"card",children:[e.jsxDEV("div",{className:"card-header border-bottom py-16 px-24",children:e.jsxDEV("div",{className:"d-flex align-items-center justify-content-between gap-3 flex-wrap",children:[e.jsxDEV("div",{className:"d-flex gap-2",children:[e.jsxDEV("button",{type:"button",className:`btn btn-sm ${g==="subscriptions"?"btn-primary-600":"btn-outline-primary"}`,onClick:()=>w("subscriptions"),children:[e.jsxDEV("i",{className:"ri-shopping-cart-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:396,columnNumber:17},this),"Subscriptions (",A.length,")"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:391,columnNumber:15},this),e.jsxDEV("button",{type:"button",className:`btn btn-sm ${g==="bookings"?"btn-primary-600":"btn-outline-primary"}`,onClick:()=>w("bookings"),children:[e.jsxDEV("i",{className:"ri-calendar-check-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:404,columnNumber:17},this),"Bookings (",M.length,")"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:399,columnNumber:15},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:390,columnNumber:13},this),e.jsxDEV("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>k({silent:!0}),disabled:E||U,children:U?e.jsxDEV(e.Fragment,{children:[e.jsxDEV("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:416,columnNumber:19},this),"Refreshingâ€¦"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:415,columnNumber:17},this):e.jsxDEV(e.Fragment,{children:[e.jsxDEV("i",{className:"ri-refresh-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:421,columnNumber:19},this),"Refresh"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:420,columnNumber:17},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:408,columnNumber:13},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:389,columnNumber:11},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:388,columnNumber:9},this),e.jsxDEV("div",{className:"card-body",children:[C&&e.jsxDEV("div",{className:"alert alert-danger alert-dismissible fade show",role:"alert",children:[e.jsxDEV("i",{className:"ri-error-warning-line me-2"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:431,columnNumber:13},this),C,e.jsxDEV("button",{type:"button",className:"btn-close",onClick:()=>v(""),"aria-label":"Close"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:433,columnNumber:13},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:430,columnNumber:19},this),E?e.jsxDEV("div",{className:"text-center py-5",children:[e.jsxDEV("div",{className:"spinner-border text-primary-600",role:"status",children:e.jsxDEV("span",{className:"visually-hidden",children:"Loading..."},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:439,columnNumber:17},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:438,columnNumber:15},this),e.jsxDEV("p",{className:"text-secondary mt-3",children:["Loading your ",g,"..."]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:441,columnNumber:15},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:437,columnNumber:13},this):e.jsxDEV(e.Fragment,{children:[g==="subscriptions"&&e.jsxDEV("div",{className:"row g-3",children:[A.length===0&&e.jsxDEV("div",{className:"col-12 text-center py-5",children:[e.jsxDEV("i",{className:"ri-shopping-cart-line display-4 text-secondary mb-3"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:450,columnNumber:23},this),e.jsxDEV("h5",{className:"text-secondary",children:"No active subscriptions"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:451,columnNumber:23},this),e.jsxDEV("p",{className:"text-muted",children:"Browse the marketplace to subscribe to services"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:452,columnNumber:23},this),e.jsxDEV("a",{href:"/dashboard",className:"btn btn-primary-600 mt-2",children:[e.jsxDEV("i",{className:"ri-store-2-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:454,columnNumber:25},this),"Browse Marketplace"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:453,columnNumber:23},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:449,columnNumber:21},this),A.map(s=>{const a=_.find(t=>String(t.serviceId)===String(s.id)),i=a?.scheduledDate&&a?.scheduledSlot;return e.jsxDEV("div",{className:"col-12 col-md-6 col-lg-4",children:e.jsxDEV("div",{className:"card h-100 shadow-sm hover-shadow",children:[s.imageUrl&&e.jsxDEV("img",{src:s.imageUrl,className:"card-img-top",alt:s.title||"Listing",style:{height:180,objectFit:"cover"}},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:467,columnNumber:29},this),e.jsxDEV("div",{className:"card-body d-flex flex-column",children:[e.jsxDEV("h6",{className:"card-title mb-2",children:s.title||"Listing"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:475,columnNumber:29},this),e.jsxDEV("div",{className:"text-muted small mb-2",children:[e.jsxDEV("i",{className:"ri-building-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:477,columnNumber:31},this),s.vendor||"Unknown Vendor"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:476,columnNumber:29},this),e.jsxDEV("div",{className:"text-muted small mb-2",children:[e.jsxDEV("i",{className:"ri-price-tag-3-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:481,columnNumber:31},this),s.category||"General"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:480,columnNumber:29},this),s.description&&e.jsxDEV("p",{className:"flex-grow-1 text-secondary small mb-3",children:[s.description.slice(0,120),s.description.length>120?"â€¦":""]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:485,columnNumber:31},this),i&&e.jsxDEV("div",{className:"alert alert-info alert-sm p-2 mb-3",children:[e.jsxDEV("i",{className:"ri-calendar-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:491,columnNumber:33},this),e.jsxDEV("small",{children:[e.jsxDEV("strong",{children:"Next Session:"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:493,columnNumber:35},this),e.jsxDEV("br",{},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:493,columnNumber:65},this),D(a.scheduledDate)," at ",T(a.scheduledSlot)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:492,columnNumber:33},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:490,columnNumber:31},this),e.jsxDEV("div",{className:"d-flex justify-content-between align-items-center mt-auto pt-2 border-top",children:[e.jsxDEV("div",{children:[e.jsxDEV("strong",{className:"text-primary-600",children:["R ",Number(s.price||0).toLocaleString()]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:500,columnNumber:33},this),s.rating&&e.jsxDEV("div",{className:"small text-muted",children:[e.jsxDEV("i",{className:"ri-star-fill text-warning"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:503,columnNumber:37},this),Number(s.rating).toFixed(1)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:502,columnNumber:35},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:499,columnNumber:31},this),e.jsxDEV("div",{className:"d-flex gap-2",children:[e.jsxDEV("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>N({open:!0,service:s}),children:[e.jsxDEV("i",{className:"ri-eye-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:510,columnNumber:35},this),"View Details"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:509,columnNumber:33},this),e.jsxDEV("button",{className:"btn btn-sm btn-outline-success",onClick:()=>d({open:!0,service:s,rating:0,comment:"",busy:!1,error:""}),children:[e.jsxDEV("i",{className:"ri-star-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:513,columnNumber:35},this),"Review"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:512,columnNumber:33},this),e.jsxDEV("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>$(s.id),disabled:!!y[String(s.id)],children:y[String(s.id)]?e.jsxDEV(e.Fragment,{children:[e.jsxDEV("span",{className:"spinner-border spinner-border-sm me-1",role:"status"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:522,columnNumber:39},this),"Removingâ€¦"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:521,columnNumber:37},this):e.jsxDEV(e.Fragment,{children:[e.jsxDEV("i",{className:"ri-close-circle-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:527,columnNumber:39},this),"Unsubscribe"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:526,columnNumber:37},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:515,columnNumber:33},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:508,columnNumber:31},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:498,columnNumber:29},this),e.jsxDEV(h,{show:p.open,onHide:()=>N({open:!1,service:null}),centered:!0,children:[e.jsxDEV(h.Header,{closeButton:!0,children:e.jsxDEV(h.Title,{children:"Listing Details"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:539,columnNumber:9},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:538,columnNumber:7},this),e.jsxDEV(h.Body,{children:p.service&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("h5",{children:p.service.title},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:544,columnNumber:13},this),e.jsxDEV("div",{className:"mb-2 text-muted",children:p.service.vendor},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:545,columnNumber:13},this),e.jsxDEV("div",{className:"mb-2",children:["Category: ",p.service.category]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:546,columnNumber:13},this),e.jsxDEV("div",{className:"mb-2",children:["Price: R ",Number(p.service.price||0).toLocaleString()]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:547,columnNumber:13},this),e.jsxDEV("div",{className:"mb-2",children:["Rating: ",W(Number(p.service.rating||0))," ",Number(p.service.rating||0).toFixed(1)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:548,columnNumber:13},this),e.jsxDEV("div",{className:"mb-2",children:p.service.description},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:549,columnNumber:13},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:543,columnNumber:11},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:541,columnNumber:7},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:537,columnNumber:5},this),e.jsxDEV(h,{show:c.open,onHide:()=>d({open:!1,service:null,rating:0,comment:"",busy:!1,error:""}),centered:!0,children:[e.jsxDEV(h.Header,{closeButton:!0,children:e.jsxDEV(h.Title,{children:"Review Listing"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:558,columnNumber:9},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:557,columnNumber:7},this),e.jsxDEV(h.Body,{children:c.service&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"mb-2",children:c.service.title},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:563,columnNumber:13},this),e.jsxDEV("div",{className:"mb-3",children:[1,2,3,4,5].map(t=>e.jsxDEV("button",{type:"button",onClick:()=>d(r=>({...r,rating:t})),className:"btn btn-link p-0 me-1","aria-label":`Rate ${t} stars`,children:e.jsxDEV("span",{style:{fontSize:24,color:c.rating>=t?"#f5a623":"#ccc"},children:"â˜…"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:567,columnNumber:19},this)},t,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:566,columnNumber:17},this))},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:564,columnNumber:13},this),e.jsxDEV("textarea",{className:"form-control mb-3",rows:3,placeholder:"Write a quick comment (optional)",value:c.comment,onChange:t=>d(r=>({...r,comment:t.target.value}))},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:571,columnNumber:13},this),c.error&&e.jsxDEV("div",{className:"alert alert-danger py-2",children:c.error},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:572,columnNumber:35},this),e.jsxDEV("button",{className:"btn btn-primary",disabled:c.busy||c.rating<1,onClick:H,children:c.busy?"Submittingâ€¦":"Submit review"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:573,columnNumber:13},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:562,columnNumber:11},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:560,columnNumber:7},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:556,columnNumber:5},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:474,columnNumber:27},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:465,columnNumber:25},this)},String(s.id),!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:464,columnNumber:23},this)})]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:447,columnNumber:17},this),g==="bookings"&&e.jsxDEV("div",{className:"row g-3",children:[M.length===0&&e.jsxDEV("div",{className:"col-12 text-center py-5",children:[e.jsxDEV("i",{className:"ri-calendar-check-line display-4 text-secondary mb-3"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:593,columnNumber:23},this),e.jsxDEV("h5",{className:"text-secondary",children:"No bookings found"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:594,columnNumber:23},this),e.jsxDEV("p",{className:"text-muted",children:"Book service sessions to see them here"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:595,columnNumber:23},this),e.jsxDEV("a",{href:"/dashboard",className:"btn btn-primary-600 mt-2",children:[e.jsxDEV("i",{className:"ri-calendar-event-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:597,columnNumber:25},this),"Book a Session"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:596,columnNumber:23},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:592,columnNumber:21},this),M.map(s=>e.jsxDEV("div",{className:"col-12 col-md-6 col-lg-4",children:e.jsxDEV("div",{className:"card h-100 shadow-sm hover-shadow",children:e.jsxDEV("div",{className:"card-body",children:[e.jsxDEV("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[e.jsxDEV("h6",{className:"card-title mb-0",children:s.serviceTitle},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:607,columnNumber:29},this),e.jsxDEV("span",{className:`badge ${G(s.status)}`,children:s.status||"Scheduled"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:608,columnNumber:29},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:606,columnNumber:27},this),s.vendorName&&e.jsxDEV("div",{className:"text-muted small mb-2",children:[e.jsxDEV("i",{className:"ri-building-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:615,columnNumber:31},this),s.vendorName]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:614,columnNumber:29},this),s.scheduledDate&&e.jsxDEV("div",{className:"mb-2",children:[e.jsxDEV("div",{className:"d-flex align-items-center text-primary-600 mb-1",children:[e.jsxDEV("i",{className:"ri-calendar-event-fill me-2"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:623,columnNumber:33},this),e.jsxDEV("strong",{children:D(s.scheduledDate)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:624,columnNumber:33},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:622,columnNumber:31},this),s.scheduledSlot&&e.jsxDEV("div",{className:"d-flex align-items-center text-muted ms-4",children:[e.jsxDEV("i",{className:"ri-time-line me-2"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:628,columnNumber:35},this),T(s.scheduledSlot)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:627,columnNumber:33},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:621,columnNumber:29},this),s.price&&s.price>0&&e.jsxDEV("div",{className:"mb-2",children:[e.jsxDEV("i",{className:"ri-money-dollar-circle-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:637,columnNumber:31},this),e.jsxDEV("strong",{children:["R ",Number(s.price||0).toLocaleString()]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:638,columnNumber:31},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:636,columnNumber:29},this),s.bookedAt&&e.jsxDEV("div",{className:"text-muted small",children:[e.jsxDEV("i",{className:"ri-calendar-check-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:644,columnNumber:31},this),"Booked on ",D(s.bookedAt)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:643,columnNumber:29},this),e.jsxDEV("div",{className:"mt-3 pt-3 border-top",children:e.jsxDEV("div",{className:"d-flex gap-2",children:[e.jsxDEV("button",{className:"btn btn-sm btn-outline-primary flex-grow-1",onClick:()=>window.location.href=`/marketplace-details?id=${s.serviceId}`,children:[e.jsxDEV("i",{className:"ri-eye-line me-1"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:655,columnNumber:33},this),"View Service"]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:651,columnNumber:31},this),s.status?.toLowerCase()==="scheduled"&&e.jsxDEV("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>$(s.serviceId),disabled:!!y[s.serviceId],title:"Cancel booking",children:e.jsxDEV("i",{className:"ri-close-line"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:665,columnNumber:35},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:659,columnNumber:33},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:650,columnNumber:29},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:649,columnNumber:27},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:605,columnNumber:25},this)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:604,columnNumber:23},this)},s.id,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:603,columnNumber:21},this))]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:590,columnNumber:17},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:444,columnNumber:13},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:429,columnNumber:9},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:387,columnNumber:7},this)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/pages/MySubscriptionsPage.tsx",lineNumber:384,columnNumber:5},this)}export{le as default};
