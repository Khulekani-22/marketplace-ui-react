const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BannerInnerTwo-UYtTfLzx.js","assets/index-DEYsEGWU.js","assets/index-CUHJT0fJ.css"])))=>i.map(i=>d[i]);
import{r as p,l as fe,n as U,j as e,R as te,_ as ve}from"./index-DEYsEGWU.js";import{a as je}from"./appData-DzAG2zN5.js";import{S as Ne}from"./SideNavAdmin-CApNU8hE.js";import"./iconify-Cs0vGdB3.js";import"./ThemeToggleButton-BrtGvMq8.js";const C="/api/lms",ye=te.lazy(()=>ve(()=>import("./BannerInnerTwo-UYtTfLzx.js"),__vite__mapDeps([0,1,2]))),Y="listings_admin_draft_v1",z="listings_admin_undo_v1",Z="listings_admin_history_cache_v1";function J(a){try{return typeof a=="string"?JSON.parse(a):a}catch{return null}}function F(a){return JSON.parse(JSON.stringify(a))}function Q(){return Date.now().toString(36)+"-"+Math.random().toString(36).slice(2,8)}function we(a){return new Date(a).toLocaleString()}function Se(a=[]){const l=a.length,c=a.reduce((x,N)=>{const y=(N.status||"unknown").toLowerCase();return x[y]=(x[y]||0)+1,x},{}),m=a.filter(x=>!!x.isFeatured).length,v=new Set(a.map(x=>(x.category||"").trim()).filter(Boolean)).size;return{total:l,featured:m,categories:v,byStatus:c}}function ee(a){const l=a.vendorId||a.id||a.uid||(a.email?a.email.toLowerCase():Q());return{id:l,vendorId:a.vendorId||l,companyName:a.companyName||a.name||a.displayName||"",name:a.name||a.companyName||"",email:(a.email||a.contactEmail||"").toLowerCase(),website:a.website||"",phone:a.phone||a.phoneNumber||"",avatar:a.avatar||a.logoUrl||"",raw:a}}function Ce(a=[]){const l={},c={};return a.forEach(m=>{l[m.vendorId]=m,m.email&&(c[m.email]=m)}),{byId:l,byEmail:c}}function G(a){var l;return{id:a.id??Q(),title:a.title??"",category:a.category??"",vendor:a.vendor??a.vendorName??"",vendorId:a.vendorId??"",contactEmail:(a.contactEmail||a.email||"").toLowerCase(),price:typeof a.price=="number"?a.price:Number(a.price||0),rating:typeof a.rating=="number"?a.rating:Number(a.rating||0),reviewCount:typeof a.reviewCount=="number"?a.reviewCount:Number(a.reviewCount||((l=a.reviews)==null?void 0:l.length)||0),imageUrl:a.imageUrl??a.thumbnail??"",aiHint:a.aiHint??"",listingType:a.listingType??"service",status:a.status??"approved",isFeatured:!!a.isFeatured,description:a.description??"",reviews:Array.isArray(a.reviews)?a.reviews:[]}}function Ue(){var X;const a=p.useMemo(()=>sessionStorage.getItem("tenantId")||"public",[]),[l,c]=p.useState(()=>J(localStorage.getItem(Y))??je),m=p.useMemo(()=>((l==null?void 0:l.services)||[]).map(G),[l]),[v,x]=p.useState(()=>((l==null?void 0:l.startups)||[]).map(ee));p.useEffect(()=>{let t=!0;return(async()=>{try{const s=await fe.get("/api/data/vendors").then(i=>i.data||[]),n=Array.isArray(s)?s.map(ee):[];t&&n.length&&x(n)}catch{}})(),()=>{t=!1}},[a]);const{byId:N,byEmail:y}=p.useMemo(()=>Ce(v),[v]);l!=null&&l.startups;const[I,E]=p.useState(()=>JSON.stringify(l,null,2)),[D,P]=p.useState("visual"),[R,w]=p.useState(!1),[H,V]=p.useState(null),[d,j]=p.useState(null),O=p.useRef([]),[K,g]=p.useState(()=>J(localStorage.getItem(Z))??[]),q=p.useMemo(()=>["All",...Array.from(new Set(m.map(s=>(s.category||"").trim()).filter(Boolean)))],[m]),[T,f]=p.useState("All"),[r,b]=p.useState("All"),[A,ae]=p.useState(""),[W,L]=p.useState(((X=m[0])==null?void 0:X.id)||""),se=p.useMemo(()=>m.filter(t=>!(T!=="All"&&(t.category||"").trim()!==T||r!=="All"&&(t.status||"").toLowerCase()!==r||A&&!`${t.title} ${t.vendor} ${t.vendorId} ${t.contactEmail} ${t.category}`.toLowerCase().includes(A.toLowerCase()))),[m,T,r,A]),S=p.useMemo(()=>m.find(t=>t.id===W),[m,W]);function k(t){V(t),setTimeout(()=>V(null),2500)}function re(t){const s=J(localStorage.getItem(z))??[];s.unshift(t);const n=s.slice(0,10);localStorage.setItem(z,JSON.stringify(n)),O.current=n}function $(t){re(l),c(t),E(JSON.stringify(t,null,2)),localStorage.setItem(Y,JSON.stringify(t))}function ne(t){if(!S)return;const s=F(l),n=s.services.findIndex(i=>i.id===S.id);n>=0&&(s.services[n]={...G(s.services[n]),...t},$(s))}function ie(){const t=prompt("Service title?");if(!t)return;const s=F(l),n=Math.max(0,...s.services.map(i=>Number(i.id)).filter(i=>!Number.isNaN(i)))+1;s.services.push(G({id:String(n),title:t,vendor:"",vendorId:"",contactEmail:"",category:"",price:0,rating:0,reviewCount:0,imageUrl:"",listingType:"service",status:"approved",isFeatured:!1,description:"",aiHint:"",reviews:[]})),$(s),L(String(n))}function le(){if(!S)return;const t=F(l),s=F(S);s.id=Q(),s.title=`${s.title} (Copy)`,t.services.push(s),$(t),L(s.id)}function oe(){var s;if(!S||!window.confirm(`Delete "${S.title}"?`))return;const t=F(l);t.services=t.services.filter(n=>n.id!==S.id),$(t),L(((s=t.services[0])==null?void 0:s.id)||"")}function ce(){const t=O.current.length>0?O.current:J(localStorage.getItem(z))??[];if(!t.length)return;const s=t.shift();O.current=t,localStorage.setItem(z,JSON.stringify(t)),c(s),E(JSON.stringify(s,null,2))}p.useEffect(()=>{(async()=>{var t,s,n,i;w(!0);try{const o=await((s=(t=U.currentUser)==null?void 0:t.getIdToken)==null?void 0:s.call(t)),u=await fetch(`${C}/live`,{headers:{"x-tenant-id":a,...o?{Authorization:`Bearer ${o}`}:{}}});if(u.ok){const h=await u.json();c(h),E(JSON.stringify(h,null,2)),localStorage.setItem(Y,JSON.stringify(h)),L(((i=(n=h==null?void 0:h.services)==null?void 0:n[0])==null?void 0:i.id)||"")}await B()}catch{}finally{w(!1)}})()},[]);async function B(){var t,s;try{const n=await((s=(t=U.currentUser)==null?void 0:t.getIdToken)==null?void 0:s.call(t)),o=(await fetch(`${C}/checkpoints`,{headers:{"x-tenant-id":a,...n?{Authorization:`Bearer ${n}`}:{}}}).then(u=>u.ok?u.json():{items:[]})).items??[];g(o),localStorage.setItem(Z,JSON.stringify(o.slice(0,2)))}catch{}}async function de(){var t,s;j(null),w(!0);try{const n=await((s=(t=U.currentUser)==null?void 0:t.getIdToken)==null?void 0:s.call(t)),i=await fetch(`${C}/publish`,{method:"PUT",headers:{"Content-Type":"application/json","x-tenant-id":a,...n?{Authorization:`Bearer ${n}`}:{}},body:JSON.stringify({data:l})});if(!i.ok)throw new Error(await i.text());k("Published listings to live"),await B()}catch(n){j(n.message||"Publish failed")}finally{w(!1)}}async function me(t){var s,n;try{const i=await((n=(s=U.currentUser)==null?void 0:s.getIdToken)==null?void 0:n.call(s)),o=await fetch(`${C}/checkpoints`,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":a,...i?{Authorization:`Bearer ${i}`}:{}},body:JSON.stringify({message:t||"",data:l})});if(!o.ok)throw new Error(await o.text());k("Checkpoint saved"),await B()}catch(i){j(i.message||"Failed to save checkpoint")}}async function ue(t){var s,n;if(window.confirm("Restore this snapshot to LIVE appData.json?"))try{const i=await((n=(s=U.currentUser)==null?void 0:s.getIdToken)==null?void 0:n.call(s)),o=await fetch(`${C}/restore/${t}`,{method:"POST",headers:{"x-tenant-id":a,...i?{Authorization:`Bearer ${i}`}:{}}});if(!o.ok)throw new Error(await o.text());k("Restored snapshot"),await B();const u=await fetch(`${C}/live`).then(h=>h.json());$(u)}catch(i){j(i.message||"Restore failed")}}async function he(){var t,s;if(window.confirm("Delete ALL checkpoints on the server?"))try{const n=await((s=(t=U.currentUser)==null?void 0:t.getIdToken)==null?void 0:s.call(t)),i=await fetch(`${C}/checkpoints`,{method:"DELETE",headers:{"x-tenant-id":a,...n?{Authorization:`Bearer ${n}`}:{}}});if(!i.ok)throw new Error(await i.text());k("Cleared history"),await B()}catch(n){j(n.message||"Failed to clear")}}const _=Se(m);function pe(t){const s=t.vendorId&&N[t.vendorId],n=t.contactEmail&&y[t.contactEmail],i=s||n||null,o=(i==null?void 0:i.companyName)||(i==null?void 0:i.name)||t.vendor||t.contactEmail||"â€”",u=(i==null?void 0:i.email)||t.contactEmail||"",h=(i==null?void 0:i.vendorId)||t.vendorId||"",M=h?`/profile-vendor?vendorId=${encodeURIComponent(h)}`:null;return{v:i,name:o,email:u,vendorId:h,profileHref:M}}function xe(t){return!t||typeof t!="object"?"File is not valid JSON.":Array.isArray(t.services)?null:"JSON must include an array: services[]."}async function ge(t){var n,i,o;j(null);const s=(n=t.target.files)==null?void 0:n[0];if(s)try{const u=await s.text(),h=J(u),M=xe(h);if(M){j(M);return}$(h),L(((o=(i=h==null?void 0:h.services)==null?void 0:i[0])==null?void 0:o.id)||""),k(`Imported ${s.name}`)}catch(u){j("Import failed: "+((u==null?void 0:u.message)||"unknown error"))}finally{t.target.value=""}}function be(){try{const t=new Blob([JSON.stringify(l,null,2)],{type:"application/json;charset=utf-8"}),s=URL.createObjectURL(t),n=document.createElement("a");n.href=s;const i=new Date().toISOString().replace(/[:.]/g,"-");n.download=`appData-${a}-${i}.json`,document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(s),k("Exported current working copy")}catch(t){j("Export failed: "+((t==null?void 0:t.message)||"unknown error"))}}return e.jsx(Ne,{children:e.jsxs("div",{className:"container py-4",children:[e.jsx(te.Suspense,{fallback:null,children:e.jsx("div",{className:"row mb-3",children:e.jsx(ye,{})})}),e.jsxs("div",{className:"row g-3 mb-3",children:[e.jsx("div",{className:"col-md-3 col-sm-6",children:e.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 bg-gradient-start-5 bg-animated-gradient text-center p-3",children:[e.jsx("i",{className:"bi bi-bag-check text-primary fs-3 mb-2"}),e.jsx("h6",{className:"fw-bold mb-0",children:_.total}),e.jsx("small",{className:"text-muted",children:"Services"})]})}),e.jsx("div",{className:"col-md-3 col-sm-6",children:e.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 bg-gradient-start-5 text-center p-3",children:[e.jsx("i",{className:"bi bi-grid text-success fs-3 mb-2"}),e.jsx("h6",{className:"fw-bold mb-0",children:_.categories}),e.jsx("small",{className:"text-muted",children:"Categories"})]})}),e.jsx("div",{className:"col-md-3 col-sm-6",children:e.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 bg-gradient-start-5 text-center p-3",children:[e.jsx("i",{className:"bi bi-star-fill text-warning fs-3 mb-2"}),e.jsx("h6",{className:"fw-bold mb-0",children:_.featured}),e.jsx("small",{className:"text-muted",children:"Featured"})]})}),e.jsx("div",{className:"col-md-3 col-sm-6",children:e.jsxs("div",{className:"card px-24 py-16 shadow-none radius-12 border h-100 bg-gradient-start-5 p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("i",{className:"bi bi-flag text-danger fs-4","aria-hidden":"true"}),e.jsx("div",{className:"fw-semibold",children:"Status"})]}),e.jsxs("span",{className:"badge text-bg-light",children:[Object.values(_.byStatus||{}).reduce((t,s)=>t+s,0)," total"]})]}),(()=>{var i;const t=o=>o==="approved"?"success":o==="pending"?"warning":o==="rejected"?"danger":"secondary",s=Object.entries(_.byStatus||{}),n=s.reduce((o,[,u])=>o+u,0);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"progress",style:{height:10},"aria-label":"Status proportions",children:s.map(([o,u])=>{const h=n?Math.round(u/n*100):0;return e.jsx("div",{className:`progress-bar bg-${t(o)}`,role:"progressbar",style:{width:`${h}%`},"aria-label":`${o} ${h}%`,"aria-valuenow":h,"aria-valuemin":0,"aria-valuemax":100,title:`${o}: ${u} (${h}%)`},o)})}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:s.length?s.map(([o,u])=>e.jsxs("span",{className:`d-inline-flex align-items-center gap-2 px-2 py-1 rounded-pill border border-${t(o)} text-${t(o)} bg-${t(o)}-subtle small`,title:`${o}: ${u}`,"aria-label":`${o}: ${u}`,children:[e.jsx("i",{className:`bi ${o==="approved"?"bi-check-circle":o==="pending"?"bi-hourglass-split":o==="rejected"?"bi-x-octagon":"bi-dot"} `,"aria-hidden":"true"}),e.jsx("span",{className:"text-capitalize",children:o}),e.jsx("span",{className:"badge text-bg-light",children:u})]},o)):e.jsx("span",{className:"text-muted small",children:"No status data"})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsx("small",{className:"text-muted",children:"Total Approved: "}),e.jsxs("span",{className:"fw-semibold",children:[n?Math.round((((i=_.byStatus)==null?void 0:i.approved)??0)/n*100):0,"%"]})]})]})})()]})})]}),e.jsxs("div",{className:"pt-4 d-flex gap-2 mb-3",children:[e.jsxs("label",{className:"btn btn-light mb-0 d-none",children:["Import JSON",e.jsx("input",{type:"file",accept:"application/json",hidden:!0,onChange:ge})]}),e.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white",onClick:be,children:"Export Current"}),e.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:de,disabled:R,title:"Write working copy to live appData.json on the server",children:R?"Publishingâ€¦":"Publish to live"})]}),H&&e.jsx("div",{className:"alert alert-success py-2",children:H}),d&&e.jsx("div",{className:"alert alert-danger py-2",children:d}),e.jsx(Ie,{onSave:me,onClear:he,onUndo:ce,disabled:R}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsxs("ul",{className:"nav nav-tabs mb-3",children:[e.jsx("li",{className:"nav-item",children:e.jsx("button",{className:`nav-link ${D==="visual"?"active":""}`,onClick:()=>P("visual"),children:"Visual editor"})}),e.jsx("li",{className:"nav-item",children:e.jsx("button",{className:`nav-link ${D==="json"?"active":""}`,onClick:()=>P("json"),children:"JSON editor"})})]}),D==="json"?e.jsx(ke,{text:I,setText:E,onApply:()=>{const t=J(I);if(!t){j("Invalid JSON");return}$(t),k("Applied JSON to working copy")}}):e.jsx($e,{services:m,vendors:v,vendorsById:N,vendorsByEmail:y,resolveVendor:pe,category:T,setCategory:f,status:r,setStatus:b,allCategories:q,search:A,setSearch:ae,filtered:se,selectedId:W,setSelectedId:L,selected:S,addService:ie,duplicateService:le,deleteService:oe,updateService:ne})]}),e.jsx("div",{style:{width:380},children:e.jsx(Ee,{items:K,onRestore:ue})})]})]})})}function Ie({onSave:a,onClear:l,onUndo:c,disabled:m}){const[v,x]=p.useState("");return e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-3",children:[e.jsx("input",{className:"form-control",placeholder:"Checkpoint message (e.g. 'Tweaked pricing & featured items')",value:v,onChange:N=>x(N.target.value)}),e.jsx("button",{className:"btn btn-sm rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6",onClick:()=>a(v),disabled:m,children:"Save checkpoint"}),e.jsx("button",{className:"btn btn-sm rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white",onClick:l,children:"Clear history"}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:c,children:"Undo"})]})}function ke({text:a,setText:l,onApply:c}){return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header fw-semibold",children:"Working copy (JSON)"}),e.jsxs("div",{className:"card-body",children:[e.jsx("textarea",{value:a,onChange:m=>l(m.target.value),rows:22,spellCheck:!1,className:"form-control font-monospace"}),e.jsxs("div",{className:"d-flex justify-content-between mt-2",children:[e.jsxs("small",{className:"text-muted",children:["Tip: Press ",e.jsx("kbd",{children:"âŒ˜/Ctrl"}),"+",e.jsx("kbd",{children:"A"})," then ",e.jsx("kbd",{children:"âŒ˜/Ctrl"}),"+",e.jsx("kbd",{children:"C"})," to copy."]}),e.jsx("button",{className:"btn btn-outline-primary",onClick:c,children:"Apply JSON"})]})]})]})}function $e(a){const{services:l,vendors:c,vendorsById:m,vendorsByEmail:v,resolveVendor:x,category:N,setCategory:y,status:I,setStatus:E,allCategories:D,search:P,setSearch:R,filtered:w,selectedId:H,setSelectedId:V,selected:d,addService:j,duplicateService:O,deleteService:K,updateService:g}=a,q=p.useMemo(()=>c.map(r=>({id:r.vendorId,label:`${r.companyName||r.name||"(unnamed)"}${r.email?" â€” "+r.email:""}`})),[c]);function T(r){const b=m[r];g({vendorId:r||"",vendor:b&&(b.companyName||b.name)||"",contactEmail:(b==null?void 0:b.email)||(d==null?void 0:d.contactEmail)||""})}const f=d?x(d):null;return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[e.jsx("span",{className:"fw-semibold",children:"Visual editor"}),e.jsx("span",{className:"text-muted small",children:"CRUD for services (listings)"})]}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row g-2 align-items-end mb-3",children:[e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsx("select",{className:"form-select",value:N,onChange:r=>y(r.target.value),children:D.map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsx("select",{className:"form-select",value:I,onChange:r=>E(r.target.value),children:["All","approved","pending","rejected"].map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsxs("div",{className:"col",children:[e.jsx("label",{className:"form-label",children:"Search"}),e.jsx("input",{className:"form-control",placeholder:"Title, vendor, email, vendorId, categoryâ€¦",value:P,onChange:r=>R(r.target.value)})]}),e.jsx("div",{className:"col-auto",children:e.jsx("button",{className:"btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 w-100",onClick:j,children:"+ Add service"})}),e.jsx("div",{className:"col-auto",children:e.jsx("button",{className:"btn rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-primary-700 text-hover-white w-100",onClick:O,disabled:!d,children:"Duplicate"})}),e.jsx("div",{className:"col-auto",children:e.jsx("button",{className:"btn btn-danger-500 rounded-pill border text-neutral-500 border-neutral-700 radius-8 px-12 py-6 bg-hover-danger-700 text-hover-white w-100",onClick:K,disabled:!d,children:"Delete"})})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-4",children:[e.jsxs("div",{className:"list-group mb-2",style:{maxHeight:420,overflow:"auto"},children:[w.map(r=>{const b=x(r);return e.jsxs("button",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center "+(H===r.id?"active":""),onClick:()=>V(r.id),title:b.email||"",children:[e.jsxs("span",{className:"text-truncate",children:[r.title,e.jsx("span",{className:"text-muted",children:" Â· "}),e.jsx("span",{className:"text-truncate",children:b.name})]}),b.profileHref?e.jsx("a",{className:"badge bg-light text-dark text-decoration-none",href:b.profileHref,target:"_blank",rel:"noreferrer",onClick:A=>A.stopPropagation(),title:"Open vendor profile",children:b.vendorId}):e.jsx("span",{className:"badge bg-light text-dark",children:r.category||"â€”"})]},r.id)}),!w.length&&e.jsx("div",{className:"text-muted small p-2",children:"No services match your filters."})]}),e.jsxs("div",{className:"small text-muted",children:["Showing ",w.length," of ",l.length]})]}),e.jsx("div",{className:"col",children:d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Title"}),e.jsx("input",{className:"form-control",value:d.title,onChange:r=>g({title:r.target.value})})]}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsx("input",{className:"form-control",value:d.category||"",onChange:r=>g({category:r.target.value})})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Listing type"}),e.jsxs("select",{className:"form-select",value:d.listingType||"service",onChange:r=>g({listingType:r.target.value}),children:[e.jsx("option",{value:"service",children:"Service"}),e.jsx("option",{value:"saas",children:"SaaS"})]})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:d.status||"approved",onChange:r=>g({status:r.target.value}),children:[e.jsx("option",{value:"approved",children:"approved"}),e.jsx("option",{value:"pending",children:"pending"}),e.jsx("option",{value:"rejected",children:"rejected"})]})]})]}),e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Bind to vendor (by company or email)"}),e.jsxs("select",{className:"form-select",value:d.vendorId||"",onChange:r=>T(r.target.value),children:[e.jsx("option",{value:"",children:"â€”"}),q.map(r=>e.jsx("option",{value:r.id,children:r.label},r.id))]}),e.jsxs("div",{className:"form-text",children:["Saves both ",e.jsx("code",{children:"vendorId"})," and display"," ",e.jsx("code",{children:"vendor"})," name on the listing."]})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"Contact email"}),e.jsx("input",{className:"form-control",value:d.contactEmail||"",onChange:r=>g({contactEmail:r.target.value.toLowerCase()})})]}),e.jsx("div",{className:"col-md-3 d-flex align-items-end",children:f!=null&&f.profileHref?e.jsx("a",{className:"btn btn-outline-primary w-100",href:f.profileHref,target:"_blank",rel:"noreferrer",title:"Open vendor profile",children:"View profile"}):e.jsx("button",{className:"btn btn-outline-secondary w-100",disabled:!0,children:"No profile linked"})})]}),e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Price (R)"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:Number(d.price||0),onChange:r=>g({price:Number(r.target.value||0)})})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Rating (0â€“5)"}),e.jsx("input",{type:"number",min:"0",max:"5",step:"0.1",className:"form-control",value:Number(d.rating||0),onChange:r=>g({rating:Number(r.target.value||0)})})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Review count"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:Number(d.reviewCount||0),onChange:r=>g({reviewCount:Number(r.target.value||0)})})]})]}),e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsxs("div",{className:"col-md-8",children:[e.jsx("label",{className:"form-label",children:"Image URL"}),e.jsx("input",{className:"form-control",value:d.imageUrl||"",onChange:r=>g({imageUrl:r.target.value})})]}),e.jsx("div",{className:"col-md-4 d-flex align-items-end gap-3",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{id:"isFeatured",type:"checkbox",className:"form-check-input",checked:!!d.isFeatured,onChange:r=>g({isFeatured:!!r.target.checked})}),e.jsx("label",{htmlFor:"isFeatured",className:"form-check-label",children:"Featured"})]})})]}),e.jsxs("div",{className:"mb-3 mt-2",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-control",rows:4,value:d.description||"",onChange:r=>g({description:r.target.value})})]}),e.jsxs("div",{className:"border rounded p-2",children:[e.jsx("div",{className:"text-muted small mb-1",children:"Card preview"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("img",{src:d.imageUrl||"/assets/images/placeholder-4x3.png",alt:"",style:{width:120,height:72,objectFit:"cover",borderRadius:6}}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:d.title||"Untitled service"}),e.jsxs("div",{className:"text-muted small",children:[(f==null?void 0:f.name)||"Vendor",f!=null&&f.email?` Â· ${f.email}`:""]}),e.jsxs("div",{className:"small",children:["R",Number(d.price||0).toLocaleString()," Â· â˜…"," ",Number(d.rating||0).toFixed(1)]})]})]})]})]}):e.jsx("div",{className:"text-muted mt-2",children:"Select a service to edit details."})})]})]})]})}function Ee({items:a,onRestore:l}){return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header fw-semibold d-flex justify-content-between",children:[e.jsx("span",{children:"Version history"}),e.jsx("span",{className:"text-muted small",children:"Latest checkpoints"})]}),e.jsxs("div",{className:"list-group list-group-flush",children:[!(a!=null&&a.length)&&e.jsxs("div",{className:"list-group-item text-muted small",children:["No checkpoints yet.",e.jsx("div",{className:"mt-1",children:"Offline cache keeps the two most recent checkpoints."})]}),a==null?void 0:a.map(c=>{var m,v,x,N,y,I;return e.jsx("div",{className:"list-group-item",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:c.message||"(no message)"}),e.jsx("div",{className:"text-muted small",children:we(c.ts)}),e.jsxs("div",{className:"text-muted small",children:["Î” Cohorts: ",((m=c.delta)==null?void 0:m.cohorts)>=0?"+":"",((v=c.delta)==null?void 0:v.cohorts)??0," Â· Î” Courses:"," ",((x=c.delta)==null?void 0:x.courses)>=0?"+":"",((N=c.delta)==null?void 0:N.courses)??0," Â· Î” Lessons:"," ",((y=c.delta)==null?void 0:y.lessons)>=0?"+":"",((I=c.delta)==null?void 0:I.lessons)??0]})]}),e.jsxs("div",{className:"d-flex align-items-start gap-2",children:[e.jsx("button",{className:"btn btn rounded-pill text-primary-50 hover-text-primary-200 bg-primary-500 bg-hover-primary-800 radius-8 px-12 py-6 btn-sm",title:"Restore snapshot to LIVE",onClick:()=>l(c.id),children:"Restore"}),e.jsx("a",{className:"btn btn-outline-secondary btn-sm",title:"Download snapshot JSON",href:`${C}/checkpoints/${c.id}`,target:"_blank",rel:"noreferrer",children:"Download"})]})]})},c.id)})]})]})}export{Ue as default};
