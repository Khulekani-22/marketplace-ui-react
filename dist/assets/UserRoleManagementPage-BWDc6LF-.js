import{r as d,c as T,f as c,C as we,j as e,w as Se}from"./index-C9a1Nhcx.js";import{M as Ke}from"./MasterLayout-DrERsAgF.js";import{B as Je}from"./Breadcrumb-DiuFWBhu.js";import"./iconify-53c4nGdq.js";function Xe(){var ge,be,xe,fe,ye,ve,je;const[j,w]=d.useState([]),[B,Q]=d.useState(!1),[W,Ne]=d.useState(""),[G,Ie]=d.useState(""),[H,m]=d.useState(""),[K,g]=d.useState(""),[J,X]=d.useState([{id:"vendor",name:"Vendor"}]),D=(((ge=T.currentUser)==null?void 0:ge.email)||sessionStorage.getItem("userEmail")||"").toLowerCase(),[E,Y]=d.useState({}),[ke,Ce]=d.useState({}),[Ue,Ae]=d.useState({}),[h,Ee]=d.useState({}),[Z,ee]=d.useState({}),[ae,te]=d.useState({}),[Ye,Ze]=d.useState({}),[V,Le]=d.useState(""),[S,se]=d.useState([]),[x,ne]=d.useState(!1),[ie,L]=d.useState(""),[N,re]=d.useState(""),[$,Fe]=d.useState(100),[P,Re]=d.useState({}),[M,le]=d.useState(!0),[v,O]=d.useState(null),[_,oe]=d.useState(!1),[z,de]=d.useState(!1),ce=d.useRef(!1),me=d.useMemo(()=>[...j].sort((a,n)=>(a.email||"").localeCompare(n.email||"")),[j]),[q,Te]=d.useState(""),[F,Be]=d.useState("All"),ue=d.useMemo(()=>{const a=q.trim().toLowerCase();return me.filter(n=>F!=="All"&&(n.role||"member")!==F?!1:a?`${n.email} ${n.tenantId} ${n.role}`.toLowerCase().includes(a):!0)},[me,q,F]);function he(a){return(Array.isArray(a)?a:[]).map(s=>({email:(s.email||"").toLowerCase(),tenantId:s.tenantId==="vendor"?"public":s.tenantId||"public",role:s.role||"member"}))}async function k(){var a,n;Q(!0),m("");try{const{data:s}=await c.get("/api/users"),i=Array.isArray(s)?s:[];w(i.map(t=>({email:(t.email||"").toLowerCase(),tenantId:!t.tenantId||t.tenantId==="public"?"vendor":t.tenantId,role:t.role||"member"})));try{const t=await c.get("/api/data/vendors").then(o=>o.data||[]),r={},l={},u={};t.forEach(o=>{const b=(o.contactEmail||o.email||"").toLowerCase(),y=o.ownerUid||"",f=String(o.id||""),p=String(o.vendorId||"");b&&(r[b]=o),y&&(l[y]=o),f&&(u[f]=o),p&&(u[p]=o)}),Y(r),Ce(l),Ae(u)}catch{}}catch(s){m(((n=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:n.message)||(s==null?void 0:s.message)||"Failed to load users")}finally{Q(!1)}}d.useEffect(()=>{k()},[]),d.useEffect(()=>{(async()=>{try{if(!D)return;await c.get("/api/users/lookup",{params:{email:D}}),le(!0)}catch{le(!1)}})()},[]),d.useEffect(()=>{(async()=>{try{const{data:a}=await c.get("/api/tenants"),n=Array.isArray(a)?a:[],s=[{id:"vendor",name:"Vendor"},...n.map(t=>typeof t=="string"?{id:t,name:t}:{id:t==null?void 0:t.id,name:(t==null?void 0:t.name)||(t==null?void 0:t.id)}).map(t=>t.id==="public"?{...t,id:"vendor",name:t.name||"Vendor"}:t)].filter(t=>t&&t.id),i=new Map;s.forEach(t=>i.set(t.id,t)),X(Array.from(i.values()))}catch{X([{id:"vendor",name:"Vendor"}])}})()},[]);async function De(a){var i,t,r;a.preventDefault(),m(""),g("");const n=W.trim(),s=G.trim();if(!n||!s){m("Email and new tenant id are required");return}try{await c.post("/api/users/upgrade",{email:n,newTenantId:s}),g("Upgraded successfully");const l=(window==null?void 0:window.localStorage)&&window.localStorage.getItem("userEmail")||((i=window==null?void 0:window.sessionStorage)==null?void 0:i.getItem("userEmail"));l&&l.toLowerCase()===n.toLowerCase()&&(sessionStorage.setItem("tenantId",s),sessionStorage.setItem("role","admin")),await k()}catch(l){m(((r=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:r.message)||(l==null?void 0:l.message)||"Upgrade failed")}}async function R({email:a,tenantId:n,role:s}){const i=n==="vendor"?"public":n;await c.post("/api/users",{email:a,tenantId:i,role:s}),a.toLowerCase()===D&&(sessionStorage.setItem("tenantId",n),sessionStorage.setItem("role",s))}async function Ve(a){var s,i;m(""),g("");const n=a.role==="admin"?"member":"admin";try{await R({email:a.email,tenantId:a.tenantId||"vendor",role:n}),w(t=>t.map(r=>r.email===a.email?{...r,role:n}:r)),g(`${a.email} is now ${n}`)}catch(t){m(((i=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:i.message)||(t==null?void 0:t.message)||"Failed to update role")}}async function $e(a,n){var s,i;m(""),g("");try{await R({email:a.email,tenantId:n,role:a.role||"member"}),w(t=>t.map(r=>r.email===a.email?{...r,tenantId:n}:r)),g(`${a.email} moved to ${n}`)}catch(t){m(((i=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:i.message)||(t==null?void 0:t.message)||"Failed to change tenant")}}async function Pe(a){var s,i;m(""),g("");const n=(a.email||"").toLowerCase();if(n&&window.confirm(`Delete user ${n}? This removes their account and role mapping but keeps listings.`))try{await c.delete("/api/users",{data:{email:n}}),w(t=>t.filter(r=>(r.email||"").toLowerCase()!==n)),g(`Deleted ${n}`)}catch(t){m(((i=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:i.message)||(t==null?void 0:t.message)||"Failed to delete user")}}async function Me(a){var n,s;m(""),g("");try{let i="";try{const{data:l}=await c.get("/api/users/lookup",{params:{email:a.email}});i=(l==null?void 0:l.uid)||""}catch{i=""}const t=(a.email||"").split("@")[0]||"Vendor",r={id:i||void 0,name:t,contactEmail:a.email,ownerUid:i||void 0,status:"pending",kycStatus:"pending",categories:[],tags:[]};await c.post("/api/data/vendors",r),Y(l=>({...l,[a.email]:!0})),g(`Created vendor profile for ${a.email}`)}catch(i){m(((s=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Failed to create vendor profile")}}async function Oe(a,n={}){var i,t;const s=(a.email||"").toLowerCase();te(r=>({...r,[s]:!0})),m(""),g("");try{let r="";try{const{data:o}=await c.get("/api/users/lookup",{params:{email:s}});r=(o==null?void 0:o.uid)||""}catch{m("Could not find Firebase UID for this email");return}await c.post("/api/users",{email:s,tenantId:a.tenantId||"vendor",role:a.role||"member",uid:r});let l=!1;const u=E[s];if(u){const o=String(u.id||u.vendorId||"");if(o)try{await c.put(`/api/data/vendors/${encodeURIComponent(o)}`,{ownerUid:r}),l=!0}catch{}}else try{const o=await c.get("/api/tenants"),y=(Array.isArray(o.data)?o.data:[]).map(p=>typeof p=="string"?p:p==null?void 0:p.id).filter(Boolean),f=Array.from(new Set(["vendor",...y]));for(const p of f)try{const{data:U}=await c.get("/api/data/vendors",{headers:{"x-tenant-id":p}}),I=Array.isArray(U)?U.find(A=>(A.contactEmail||A.email||"").toLowerCase()===s):null;if(I){const A=String(I.id||I.vendorId||"");if(A){await c.put(`/api/data/vendors/${encodeURIComponent(A)}`,{ownerUid:r},{headers:{"x-tenant-id":p}}),l=!0;break}}}catch{}}catch{}if(!l){const o=s.split("@")[0]||"Vendor";try{await c.post("/api/data/vendors",{name:o,contactEmail:s,ownerUid:r,status:"pending",kycStatus:"pending",categories:[]})}catch{}}n.doRefresh!==!1&&await k(),g(`Synced Firebase UID for ${s}`)}catch(r){m(((t=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Failed to sync UID")}finally{te(r=>({...r,[s]:!1}))}}function _e(a){const n={},s={},i={};return(a||[]).forEach(t=>{const r=(t.contactEmail||t.email||"").toLowerCase(),l=t.ownerUid||"",u=String(t.id||""),o=String(t.vendorId||"");r&&(n[r]=t),l&&(s[l]=t),u&&(i[u]=t),o&&(i[o]=t)}),{byEmail:n,byOwner:s,byId:i}}async function ze(a){const n=(a.email||"").toLowerCase();ee(s=>({...s,[n]:!0}));try{let s=E[n]||null,i="",t=null,r=null;try{const{data:l}=await c.get("/api/users/lookup",{params:{email:n}});i=(l==null?void 0:l.uid)||""}catch{}if(i&&(t=ke[i]||null,r=Ue[i]||null),!s&&!t&&!r)try{const l=await c.get("/api/tenants"),o=(Array.isArray(l.data)?l.data:[]).map(p=>typeof p=="string"?p:p==null?void 0:p.id).filter(Boolean),b=[],y=Array.from(new Set(["vendor",...o]));for(const p of y)try{const{data:U}=await c.get("/api/data/vendors",{headers:{"x-tenant-id":p}});Array.isArray(U)&&b.push(...U.map(I=>({...I,_tenantId:I.tenantId||p})))}catch{}const f=_e(b);s=f.byEmail[n]||null,i&&(t=f.byOwner[i]||t,r=f.byId[i]||r)}catch{}Ee(l=>({...l,[n]:{uid:i,viaEmail:s,viaUid:t,viaId:r}}))}finally{ee(s=>({...s,[n]:!1}))}}async function C(a=!0){var n,s,i,t,r;L(""),ne(!0);try{const l={search:V,pageSize:$};!a&&N&&(l.pageToken=N);const{data:u}=await c.get("/api/users/all",{params:l}),o=Array.isArray(u==null?void 0:u.items)?u.items:[];se(b=>a?o:[...b,...o]),re((u==null?void 0:u.nextPageToken)||"")}catch(l){const u=(n=l==null?void 0:l.response)==null?void 0:n.status;if(u===401||u===403)try{await we();const o={search:V,pageSize:$};!a&&N&&(o.pageToken=N);const{data:b}=await c.get("/api/users/all",{params:o}),y=Array.isArray(b==null?void 0:b.items)?b.items:[];se(f=>a?y:[...f,...y]),re((b==null?void 0:b.nextPageToken)||""),L("");return}catch(o){L(((i=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:i.message)||(o==null?void 0:o.message)||"Failed to search platform users")}else L(((r=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:r.message)||(l==null?void 0:l.message)||"Failed to search platform users")}finally{ne(!1)}}const pe=d.useRef(!1);d.useEffect(()=>{if(pe.current)return;pe.current=!0;let a=!0;return(async()=>{try{if(await we(),!a)return;await C(!0)}catch{}})(),()=>{a=!1}},[]),d.useEffect(()=>{if(!ce.current&&!x&&Array.isArray(S)&&S.length===0){const a=setTimeout(()=>{ce.current=!0,C(!0)},800);return()=>clearTimeout(a)}},[x,S]);async function qe(a){var s,i;const n=P[a]||"vendor";try{await R({email:a,tenantId:n,role:"admin"}),w(t=>t.find(l=>l.email===a)?t.map(l=>l.email===a?{...l,role:"admin",tenantId:n}:l):[...t,{email:a,role:"admin",tenantId:n}]),g(`${a} granted admin (${n})`)}catch(t){m(((i=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:i.message)||(t==null?void 0:t.message)||"Failed to grant admin")}}function Qe(a){const n=(a||"").toLowerCase();return j.some(s=>s.email===n&&(s.role||"member")==="admin")}async function We(a){var i,t;const n=j.find(r=>r.email===(a||"").toLowerCase()),s=(n==null?void 0:n.tenantId)||P[a]||"vendor";try{await R({email:a,tenantId:s,role:"member"}),w(r=>r.map(l=>l.email===a?{...l,role:"member"}:l)),g(`${a} admin revoked`)}catch(r){m(((t=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Failed to revoke admin")}}async function Ge(){var a,n,s;m(""),g(""),oe(!0);try{const i=await c.get("/api/lms/live").then(l=>l.data||{}),t=he(j),r={...i,users:t};await c.put("/api/users/bulk",{users:t}),await c.put("/api/lms/publish",{data:r});try{await Se({action:"USERS_SAVE_ALL",userEmail:(a=T.currentUser)==null?void 0:a.email,targetType:"appData",targetId:"users",metadata:{count:t.length}})}catch{}g("All changes saved to appData.json"),await k()}catch(i){m(((s=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Failed to save changes")}finally{oe(!1)}}async function He(){var a,n,s;m(""),g(""),de(!0);try{const i=await c.get("/api/lms/live").then(l=>l.data||{}),t=he(j),r={...i,users:t};await c.put("/api/users/bulk",{users:t}),await c.post("/api/lms/checkpoints",{message:"User Roles checkpoint",data:r});try{await Se({action:"USERS_CHECKPOINT",userEmail:(a=T.currentUser)==null?void 0:a.email,targetType:"appData",targetId:"users",metadata:{count:t.length}})}catch{}g("Checkpoint saved"),await k()}catch(i){m(((s=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Failed to save checkpoint")}finally{de(!1)}}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card h-100 p-0 radius-12 overflow-hidden",children:[e.jsx("div",{className:"card-header border-bottom bg-base py-16 px-24 d-flex align-items-center justify-content-between gap-3 flex-wrap",children:e.jsx("h6",{className:"mb-0",children:"Upgrade Public Tenant to Private Admin"})}),e.jsxs("div",{className:"card-body p-24",children:[e.jsxs("form",{onSubmit:De,className:"row g-3 align-items-end mb-24",children:[e.jsxs("div",{className:"col-sm-5",children:[e.jsx("label",{className:"form-label text-sm",children:"User Email"}),e.jsx("input",{type:"email",className:"form-control",value:W,onChange:a=>Ne(a.target.value),placeholder:"user@example.com",required:!0})]}),e.jsxs("div",{className:"col-sm-5",children:[e.jsx("label",{className:"form-label text-sm",children:"New Tenant ID (private)"}),e.jsx("input",{type:"text",className:"form-control",value:G,onChange:a=>Ie(a.target.value),placeholder:"acme-inc",required:!0})]}),e.jsx("div",{className:"col-sm-2",children:e.jsx("button",{type:"submit",className:"btn btn-primary w-100",children:"Upgrade"})})]}),H&&e.jsx("div",{className:"alert alert-danger py-8 px-12 mb-16",children:H}),K&&e.jsx("div",{className:"alert alert-success py-8 px-12 mb-16",children:K}),e.jsx("div",{className:"d-flex flex-wrap align-items-end justify-content-between gap-2 mb-3",children:e.jsxs("div",{className:"d-flex align-items-end gap-2 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label text-sm",children:"Search"}),e.jsx("input",{className:"form-control",placeholder:"Filter by email, tenant, role",value:q,onChange:a=>Te(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label text-sm",children:"Role"}),e.jsxs("select",{className:"form-select",value:F,onChange:a=>Be(a.target.value),children:[e.jsx("option",{children:"All"}),e.jsx("option",{children:"admin"}),e.jsx("option",{children:"member"})]})]}),e.jsxs("div",{className:"align-self-end mb-1 d-flex gap-2",children:[e.jsx("button",{className:"btn btn-outline-secondary",onClick:He,disabled:z||_,title:"Create a checkpoint containing the current user role assignments",children:z?"Saving…":"Save Checkpoint"}),e.jsx("button",{className:"btn btn-primary",onClick:Ge,disabled:_||z,title:"Publish all user role/tenant mappings to live appData.json",children:_?"Saving…":"Save All Changes"})]})]})}),e.jsx("div",{className:"table-responsive scroll-sm",children:e.jsxs("table",{className:"table bordered-table sm-table mb-0 align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Email"}),e.jsx("th",{style:{minWidth:160},children:"Tenant"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Vendor"}),e.jsx("th",{style:{minWidth:320},children:"Actions / Trace"})]})}),e.jsxs("tbody",{children:[B&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,children:"Loading…"})}),!B&&ue.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,children:"No users match your filters."})}),!B&&ue.map(a=>{var n;return e.jsxs("tr",{children:[e.jsx("td",{children:a.email}),e.jsx("td",{children:e.jsx("select",{className:"form-select form-select-sm w-auto bg-base border text-secondary-light rounded-pill",value:a.tenantId||"vendor",onChange:s=>$e(a,s.target.value),title:"Switch tenant",children:J.map(s=>e.jsx("option",{value:s.id,children:s.name||s.id},s.id))})}),e.jsx("td",{children:e.jsx("span",{className:a.role==="admin"?"badge bg-success-focus text-success-700":"badge bg-neutral-200 text-neutral-900",children:a.role||"member"})}),e.jsxs("td",{children:[E[a.email]?e.jsx("span",{className:"badge bg-primary-subtle text-primary-700",children:"Has vendor"}):e.jsx("span",{className:"badge bg-neutral-200 text-neutral-900",children:"No vendor"}),h[a.email]&&e.jsx("div",{className:"small text-secondary mt-1",children:h[a.email].uid?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["uid: ",e.jsx("code",{children:h[a.email].uid})]}),e.jsxs("div",{children:["by email: ",h[a.email].viaEmail?e.jsxs(e.Fragment,{children:[e.jsx("code",{children:String(h[a.email].viaEmail.contactEmail||h[a.email].viaEmail.email||"")})," ","(vendorId: ",e.jsx("code",{children:String(h[a.email].viaEmail.id||h[a.email].viaEmail.vendorId)}),", tenant: ",e.jsx("code",{children:String(h[a.email].viaEmail.tenantId||h[a.email].viaEmail._tenantId||"vendor")}),")"]}):"—"]}),e.jsxs("div",{children:["by ownerUid: ",h[a.email].viaUid?e.jsxs(e.Fragment,{children:[e.jsx("code",{children:String(h[a.email].viaUid.ownerUid||"")})," ","(vendorId: ",e.jsx("code",{children:String(h[a.email].viaUid.id||h[a.email].viaUid.vendorId)}),", tenant: ",e.jsx("code",{children:String(h[a.email].viaUid.tenantId||h[a.email].viaUid._tenantId||"vendor")}),")"]}):"—"]}),e.jsxs("div",{children:["by id==uid: ",h[a.email].viaId?e.jsxs(e.Fragment,{children:[e.jsx("code",{children:String(h[a.email].viaId.id||h[a.email].viaId.vendorId)})," ","(tenant: ",e.jsx("code",{children:String(h[a.email].viaId.tenantId||h[a.email].viaId._tenantId||"vendor")}),")"]}):"—"]})]}):e.jsxs("div",{children:[e.jsx("span",{className:"me-1",children:"uid:"}),e.jsx("span",{className:"text-secondary",children:"—"}),e.jsx("div",{className:"text-secondary small mt-1",children:M?e.jsx(e.Fragment,{children:"UID not linked. Use “Sync UID” to fetch from Firebase."}):e.jsx(e.Fragment,{children:"UID lookup not available on this server."})})]})})]}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:a.role==="admin"?"btn btn-outline-danger btn-sm":"btn btn-outline-success btn-sm",onClick:()=>Ve(a),title:a.role==="admin"?"Revoke admin":"Grant admin",children:a.role==="admin"?"Revoke Admin":"Make Admin"}),!E[a.email]&&e.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>Me(a),title:"Create vendor profile for this user",children:"Create Vendor"}),e.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>ze(a),disabled:!!Z[a.email],title:"Trace vendor status via email, UID, or vendor id",children:Z[a.email]?"Tracing…":"Trace"}),e.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>Oe(a),disabled:!!ae[a.email]||!M,title:M?"Lookup Firebase UID and link it to this user's vendor":"UID lookup is not available on this server",children:ae[a.email]?"Syncing…":"Sync UID"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>Pe(a),title:"Delete user from Firebase and remove role mapping (keeps listings)",disabled:(((n=T.currentUser)==null?void 0:n.email)||"").toLowerCase()===(a.email||"").toLowerCase(),children:"Delete User"})]})})]},a.email)})]})]})}),e.jsxs("div",{className:"mt-24",children:[e.jsx("h6",{className:"mb-2",children:"Onboard Admins"}),e.jsxs("div",{className:"d-flex flex-wrap align-items-end gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label text-sm",children:"Search users"}),e.jsx("input",{className:"form-control",placeholder:"Search by email or name",value:V,onChange:a=>Le(a.target.value)})]}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:C,disabled:x,children:x?"Searching…":"Search"}),ie&&e.jsx("div",{className:"text-danger small",children:ie})]}),e.jsxs("div",{className:"table-responsive scroll-sm",children:[e.jsxs("table",{className:"table bordered-table sm-table mb-0 align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"UID"}),e.jsx("th",{children:"Tenant"}),e.jsx("th",{children:"Action"})]})}),e.jsxs("tbody",{children:[x&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:"Loading…"})}),!x&&S.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:"No results"})}),!x&&S.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:a.email}),e.jsx("td",{children:a.displayName||"—"}),e.jsx("td",{children:e.jsx("code",{children:a.uid})}),e.jsx("td",{children:e.jsx("select",{className:"form-select form-select-sm w-auto bg-base border text-secondary-light rounded-pill",value:P[a.email]||"vendor",onChange:n=>Re(s=>({...s,[a.email]:n.target.value})),children:J.map(n=>e.jsx("option",{value:n.id,children:n.name||n.id},n.id))})}),e.jsx("td",{children:Qe(a.email)?e.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>We((a.email||"").toLowerCase()),children:"Revoke Admin"}):e.jsx("button",{className:"btn btn-sm btn-outline-success",onClick:()=>qe((a.email||"").toLowerCase()),children:"Grant Admin"})})]},a.uid))]})]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mt-2",children:[e.jsxs("div",{className:"text-secondary small",children:["Showing ",S.length," user(s)"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("label",{className:"text-sm",children:"Page size"}),e.jsx("select",{className:"form-select form-select-sm w-auto",value:$,onChange:a=>Fe(Number(a.target.value)||100),children:[50,100,200,500,1e3].map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>C(!0),disabled:x,children:"Refresh"}),e.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>C(!1),disabled:x||!N,children:x?"Loading…":N?"Load more":"End"})]})]})]})]})]})]}),v&&e.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100",style:{background:"rgba(0,0,0,0.5)",zIndex:1070},onClick:a=>a.target===a.currentTarget&&O(null),children:e.jsxs("div",{className:"card",style:{maxWidth:520,margin:"12vh auto"},children:[e.jsxs("div",{className:"card-header d-flex align-items-center justify-content-between",children:[e.jsx("h6",{className:"mb-0",children:"Vendor ID Aligned"}),e.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>O(null),children:"Close"})]}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-2",children:["Email: ",e.jsx("code",{children:v.email})]}),e.jsx("div",{className:"mb-2",children:"Updated records in current tenant:"}),e.jsxs("ul",{className:"mb-0",children:[e.jsxs("li",{children:["Vendors/startups: ",Number(((be=v.changes)==null?void 0:be.startups)||0)+Number(((xe=v.changes)==null?void 0:xe.vendors)||0)]}),e.jsxs("li",{children:["Listings (services): ",Number(((fe=v.changes)==null?void 0:fe.services)||0)]}),e.jsxs("li",{children:["Subscriptions: ",Number(((ye=v.changes)==null?void 0:ye.subscriptions)||0)]}),e.jsxs("li",{children:["Bookings: ",Number(((ve=v.changes)==null?void 0:ve.bookings)||0)]}),e.jsxs("li",{children:["Message threads: ",Number(((je=v.changes)==null?void 0:je.threads)||0)]})]})]}),e.jsx("div",{className:"card-footer d-flex justify-content-end gap-2",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>O(null),children:"OK"})})]})})]})}function na(){return e.jsxs(Ke,{children:[e.jsx(Je,{title:"User Role Management"}),e.jsx(Xe,{})]})}export{na as default};
