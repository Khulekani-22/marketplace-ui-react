import{r as a,u as j,c as S,b,j as e}from"./index-DGewQ82u.js";import{f as N,u as y,s as w}from"./subscriptions-BFTGdMx-.js";function E(){const[o,h]=a.useState([]),[c,x]=a.useState(""),[f,u]=a.useState(!0),[n,i]=a.useState(()=>new Set),g=j(),p=a.useMemo(()=>sessionStorage.getItem("tenantId")||"vendor",[]),l=a.useCallback(async()=>{u(!0);const{data:s}=await S.get("/api/data/services",{params:{q:c||void 0,page:1,pageSize:40,featured:"true"}});h(s.items||[]),u(!1)},[c]);a.useEffect(()=>{l()},[l]),a.useEffect(()=>{(async()=>{try{if(!b.currentUser)return;const s=await N(),r=new Set(s.filter(t=>(t.type||"service")==="service").map(t=>String(t.serviceId)));i(r)}catch{}})()},[p]);async function v(s){var r;try{if(!b.currentUser){g("/login",{replace:!0,state:{from:((r=window.location)==null?void 0:r.pathname)||"/"}});return}const t=String(s);n.has(t)?(await y(t),i(d=>{const m=new Set(Array.from(d));return m.delete(t),m})):(await w(t),i(d=>new Set([...Array.from(d),t])))}catch{}}return e.jsxs("div",{className:"container py-4",children:[e.jsxs("div",{className:"d-flex align-items-end justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"h4 mb-1",children:"Featured Marketplace"}),e.jsx("small",{className:"text-muted",children:"Discover services from trusted vendors"})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("input",{className:"form-control",placeholder:"Search…",value:c,onChange:s=>x(s.target.value)}),e.jsx("button",{className:"btn btn-primary",onClick:l,children:"Search"})]})]}),f?e.jsx("p",{children:"Loading…"}):e.jsxs("div",{className:"row g-3",children:[o.length===0&&e.jsx("p",{className:"text-muted",children:"No featured services yet."}),o.map(s=>e.jsx("div",{className:"col-12 col-md-6 col-lg-4",children:e.jsx("div",{className:"card h-100",children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("h5",{className:"card-title",children:s.title}),s.isFeatured&&e.jsx("span",{className:"badge text-bg-success",children:"Featured"})]}),e.jsxs("div",{className:"text-muted mb-2",children:[s.category," · ",s.vendor]}),e.jsx("p",{className:"flex-grow-1",children:s.description||"Quality service for SMMEs."}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("strong",{children:["R ",Number(s.price).toLocaleString()]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-outline-primary btn-sm",onClick:()=>alert("Checkout flow to be wired"),children:"Select"}),e.jsx("button",{className:n.has(String(s.id))?"btn btn-sm btn-secondary":"btn btn-sm btn-primary",onClick:()=>v(s.id),children:n.has(String(s.id))?"Subscribed":"Subscribe"})]})]})]})})},s.id))]})]})}export{E as default};
