var dt=e=>{throw TypeError(e)};var J=(e,t,r)=>t.has(e)||dt("Cannot "+r);var s=(e,t,r)=>(J(e,t,"read from private field"),r?r.call(e):t.get(e)),p=(e,t,r)=>t.has(e)?dt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),u=(e,t,r,i)=>(J(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),l=(e,t,r)=>(J(e,t,"access private method"),r);import{S as Ct,q as ft,r as R,v as K,x as N,y as $,z as X,A as pt,C as Et,D as z,E as It,F as wt,G as yt,H as Rt,I as Tt,J as Mt}from"./index-AR0poqkx.js";import{r as C}from"./vendor-CzT6oPac.js";var g,a,q,y,T,_,O,E,A,F,P,M,Q,I,U,n,L,Y,Z,tt,et,st,rt,it,St,vt,Qt=(vt=class extends Ct{constructor(t,r){super();p(this,n);p(this,g);p(this,a);p(this,q);p(this,y);p(this,T);p(this,_);p(this,O);p(this,E);p(this,A);p(this,F);p(this,P);p(this,M);p(this,Q);p(this,I);p(this,U,new Set);this.options=r,u(this,g,t),u(this,E,null),u(this,O,ft()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(s(this,a).addObserver(this),bt(s(this,a),this.options)?l(this,n,L).call(this):this.updateResult(),l(this,n,et).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return at(s(this,a),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return at(s(this,a),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,l(this,n,st).call(this),l(this,n,rt).call(this),s(this,a).removeObserver(this)}setOptions(t){const r=this.options,i=s(this,a);if(this.options=s(this,g).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof R(this.options.enabled,s(this,a))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");l(this,n,it).call(this),s(this,a).setOptions(this.options),r._defaulted&&!K(this.options,r)&&s(this,g).getQueryCache().notify({type:"observerOptionsUpdated",query:s(this,a),observer:this});const o=this.hasListeners();o&&gt(s(this,a),i,this.options,r)&&l(this,n,L).call(this),this.updateResult(),o&&(s(this,a)!==i||R(this.options.enabled,s(this,a))!==R(r.enabled,s(this,a))||N(this.options.staleTime,s(this,a))!==N(r.staleTime,s(this,a)))&&l(this,n,Y).call(this);const c=l(this,n,Z).call(this);o&&(s(this,a)!==i||R(this.options.enabled,s(this,a))!==R(r.enabled,s(this,a))||c!==s(this,I))&&l(this,n,tt).call(this,c)}getOptimisticResult(t){const r=s(this,g).getQueryCache().build(s(this,g),t),i=this.createResult(r,t);return _t(this,i)&&(u(this,y,i),u(this,_,this.options),u(this,T,s(this,a).state)),i}getCurrentResult(){return s(this,y)}trackResult(t,r){return new Proxy(t,{get:(i,o)=>(this.trackProp(o),r?.(o),o==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&s(this,O).status==="pending"&&s(this,O).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(i,o))})}trackProp(t){s(this,U).add(t)}getCurrentQuery(){return s(this,a)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=s(this,g).defaultQueryOptions(t),i=s(this,g).getQueryCache().build(s(this,g),r);return i.fetch().then(()=>this.createResult(i,r))}fetch(t){return l(this,n,L).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),s(this,y)))}createResult(t,r){const i=s(this,a),o=this.options,c=s(this,y),h=s(this,T),D=s(this,_),v=t!==i?t.state:s(this,q),{state:k}=t;let d={...k},j=!1,b;if(r._optimisticResults){const m=this.hasListeners(),B=!m&&bt(t,r),x=m&&gt(t,i,r,o);(B||x)&&(d={...d,...wt(k.data,t.options)}),r._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:ot,errorUpdatedAt:ht,status:w}=d;b=d.data;let ut=!1;if(r.placeholderData!==void 0&&b===void 0&&w==="pending"){let m;c?.isPlaceholderData&&r.placeholderData===D?.placeholderData?(m=c.data,ut=!0):m=typeof r.placeholderData=="function"?r.placeholderData(s(this,P)?.state.data,s(this,P)):r.placeholderData,m!==void 0&&(w="success",b=yt(c?.data,m,r),j=!0)}if(r.select&&b!==void 0&&!ut)if(c&&b===h?.data&&r.select===s(this,A))b=s(this,F);else try{u(this,A,r.select),b=r.select(b),b=yt(c?.data,b,r),u(this,F,b),u(this,E,null)}catch(m){u(this,E,m)}s(this,E)&&(ot=s(this,E),b=s(this,F),ht=Date.now(),w="error");const V=d.fetchStatus==="fetching",W=w==="pending",G=w==="error",ct=W&&V,lt=b!==void 0,S={status:w,fetchStatus:d.fetchStatus,isPending:W,isSuccess:w==="success",isError:G,isInitialLoading:ct,isLoading:ct,data:b,dataUpdatedAt:d.dataUpdatedAt,error:ot,errorUpdatedAt:ht,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>v.dataUpdateCount||d.errorUpdateCount>v.errorUpdateCount,isFetching:V,isRefetching:V&&!W,isLoadingError:G&&!lt,isPaused:d.fetchStatus==="paused",isPlaceholderData:j,isRefetchError:G&&lt,isStale:nt(t,r),refetch:this.refetch,promise:s(this,O),isEnabled:R(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const m=H=>{S.status==="error"?H.reject(S.error):S.data!==void 0&&H.resolve(S.data)},B=()=>{const H=u(this,O,S.promise=ft());m(H)},x=s(this,O);switch(x.status){case"pending":t.queryHash===i.queryHash&&m(x);break;case"fulfilled":(S.status==="error"||S.data!==x.value)&&B();break;case"rejected":(S.status!=="error"||S.error!==x.reason)&&B();break}}return S}updateResult(){const t=s(this,y),r=this.createResult(s(this,a),this.options);if(u(this,T,s(this,a).state),u(this,_,this.options),s(this,T).data!==void 0&&u(this,P,s(this,a)),K(r,t))return;u(this,y,r);const i=()=>{if(!t)return!0;const{notifyOnChangeProps:o}=this.options,c=typeof o=="function"?o():o;if(c==="all"||!c&&!s(this,U).size)return!0;const h=new Set(c??s(this,U));return this.options.throwOnError&&h.add("error"),Object.keys(s(this,y)).some(D=>{const f=D;return s(this,y)[f]!==t[f]&&h.has(f)})};l(this,n,St).call(this,{listeners:i()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&l(this,n,et).call(this)}},g=new WeakMap,a=new WeakMap,q=new WeakMap,y=new WeakMap,T=new WeakMap,_=new WeakMap,O=new WeakMap,E=new WeakMap,A=new WeakMap,F=new WeakMap,P=new WeakMap,M=new WeakMap,Q=new WeakMap,I=new WeakMap,U=new WeakMap,n=new WeakSet,L=function(t){l(this,n,it).call(this);let r=s(this,a).fetch(this.options,t);return t?.throwOnError||(r=r.catch($)),r},Y=function(){l(this,n,st).call(this);const t=N(this.options.staleTime,s(this,a));if(X||s(this,y).isStale||!pt(t))return;const i=Et(s(this,y).dataUpdatedAt,t)+1;u(this,M,z.setTimeout(()=>{s(this,y).isStale||this.updateResult()},i))},Z=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(s(this,a)):this.options.refetchInterval)??!1},tt=function(t){l(this,n,rt).call(this),u(this,I,t),!(X||R(this.options.enabled,s(this,a))===!1||!pt(s(this,I))||s(this,I)===0)&&u(this,Q,z.setInterval(()=>{(this.options.refetchIntervalInBackground||It.isFocused())&&l(this,n,L).call(this)},s(this,I)))},et=function(){l(this,n,Y).call(this),l(this,n,tt).call(this,l(this,n,Z).call(this))},st=function(){s(this,M)&&(z.clearTimeout(s(this,M)),u(this,M,void 0))},rt=function(){s(this,Q)&&(z.clearInterval(s(this,Q)),u(this,Q,void 0))},it=function(){const t=s(this,g).getQueryCache().build(s(this,g),this.options);if(t===s(this,a))return;const r=s(this,a);u(this,a,t),u(this,q,t.state),this.hasListeners()&&(r?.removeObserver(this),t.addObserver(this))},St=function(t){Rt.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(s(this,y))}),s(this,g).getQueryCache().notify({query:s(this,a),type:"observerResultsUpdated"})})},vt);function xt(e,t){return R(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function bt(e,t){return xt(e,t)||e.state.data!==void 0&&at(e,t,t.refetchOnMount)}function at(e,t,r){if(R(t.enabled,e)!==!1&&N(t.staleTime,e)!=="static"){const i=typeof r=="function"?r(e):r;return i==="always"||i!==!1&&nt(e,t)}return!1}function gt(e,t,r,i){return(e!==t||R(i.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&nt(e,r)}function nt(e,t){return R(t.enabled,e)!==!1&&e.isStaleByTime(N(t.staleTime,e))}function _t(e,t){return!K(e.getCurrentResult(),t)}var Ot=C.createContext(!1),Ft=()=>C.useContext(Ot);Ot.Provider;function Pt(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Ut=C.createContext(Pt()),Dt=()=>C.useContext(Ut),kt=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Lt=e=>{C.useEffect(()=>{e.clearReset()},[e])},Nt=({result:e,errorResetBoundary:t,throwOnError:r,query:i,suspense:o})=>e.isError&&!t.isReset()&&!e.isFetching&&i&&(o&&e.data===void 0||Tt(r,[e.error,i])),qt=e=>{if(e.suspense){const r=o=>o==="static"?o:Math.max(o??1e3,1e3),i=e.staleTime;e.staleTime=typeof i=="function"?(...o)=>r(i(...o)):r(i),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},At=(e,t)=>e.isLoading&&e.isFetching&&!t,jt=(e,t)=>e?.suspense&&t.isPending,mt=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function Bt(e,t,r){if(typeof e!="object"||Array.isArray(e))throw new Error('Bad argument type. Starting with v5, only the "Object" form is allowed when calling query related functions. Please use the error stack to find the culprit call. More info here: https://tanstack.com/query/latest/docs/react/guides/migrating-to-v5#supports-a-single-signature-one-object');const i=Ft(),o=Dt(),c=Mt(),h=c.defaultQueryOptions(e);c.getDefaultOptions().queries?._experimental_beforeQuery?.(h),h.queryFn||console.error(`[${h.queryHash}]: No queryFn was passed as an option, and no default queryFn was found. The queryFn parameter is only optional when using a default queryFn. More info here: https://tanstack.com/query/latest/docs/framework/react/guides/default-query-function`),h._optimisticResults=i?"isRestoring":"optimistic",qt(h),kt(h,o),Lt(o);const D=!c.getQueryCache().get(h.queryHash),[f]=C.useState(()=>new t(c,h)),v=f.getOptimisticResult(h),k=!i&&e.subscribed!==!1;if(C.useSyncExternalStore(C.useCallback(d=>{const j=k?f.subscribe(Rt.batchCalls(d)):$;return f.updateResult(),j},[f,k]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),C.useEffect(()=>{f.setOptions(h)},[h,f]),jt(h,v))throw mt(h,f,o);if(Nt({result:v,errorResetBoundary:o,throwOnError:h.throwOnError,query:c.getQueryCache().get(h.queryHash),suspense:h.suspense}))throw v.error;return c.getDefaultOptions().queries?._experimental_afterQuery?.(h,v),h.experimental_prefetchInRender&&!X&&At(v,i)&&(D?mt(h,f,o):c.getQueryCache().get(h.queryHash)?.promise)?.catch($).finally(()=>{f.updateResult()}),h.notifyOnChangeProps?v:f.trackResult(v)}function Gt(e,t){return Bt(e,Qt)}export{Gt as u};
