import{a as b,j as e}from"./index-2aihh3Fa.js";import{i as E,b as M,r as l}from"./vendor-5dkO6nAt.js";import"./firebase-DMFzVTL_.js";import"./utils-B2rxisVD.js";const w=()=>{const[s]=E(),d=M(),[O,c]=l.useState(!0),[A,o]=l.useState(null),[a,v]=l.useState(null),[h,u]=l.useState(!1);l.useEffect(()=>{g()},[]);const g=async()=>{try{const n=b.currentUser;if(!n){o("Please sign in to authorize"),c(!1);return}const r=s.get("client_id"),m=s.get("redirect_uri"),i=s.get("response_type"),N=s.get("scope"),x=s.get("state"),P=s.get("code_challenge"),j=s.get("code_challenge_method");if(!r||!m||!i||!N){o("Invalid authorization request - missing required parameters"),c(!1);return}const t=new URL("/api/oauth/authorize",window.location.origin);t.searchParams.set("client_id",r),t.searchParams.set("redirect_uri",m),t.searchParams.set("response_type",i),t.searchParams.set("scope",N),x&&t.searchParams.set("state",x),P&&t.searchParams.set("code_challenge",P),j&&t.searchParams.set("code_challenge_method",j);const D=await n.getIdToken(),f=await fetch(t.toString(),{headers:{Authorization:`Bearer ${D}`}}),p=await f.json();if(!f.ok){o(p.message||"Failed to load authorization request"),c(!1);return}if(f.redirected||p.redirect){window.location.href=p.redirect;return}v(p.data),c(!1)}catch(n){console.error("Load consent error:",n),o("Failed to load authorization request"),c(!1)}},k=async()=>{try{u(!0);const r=await b.currentUser.getIdToken(),i=await(await fetch("/api/oauth/authorize",{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({client_id:s.get("client_id"),redirect_uri:s.get("redirect_uri"),scope:s.get("scope"),state:s.get("state"),code_challenge:s.get("code_challenge"),approved:!0})})).json();i.success&&i.redirect?window.location.href=i.redirect:(o(i.message||"Failed to authorize"),u(!1))}catch(n){console.error("Approve error:",n),o("Failed to process authorization"),u(!1)}},C=async()=>{try{u(!0);const r=await b.currentUser.getIdToken(),i=await(await fetch("/api/oauth/authorize",{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({client_id:s.get("client_id"),redirect_uri:s.get("redirect_uri"),scope:s.get("scope"),state:s.get("state"),approved:!1})})).json();i.redirect?window.location.href=i.redirect:d("/")}catch(n){console.error("Deny error:",n),d("/")}};return O?e.jsxDEV("div",{className:"oauth-consent",children:e.jsxDEV("div",{className:"consent-container",children:e.jsxDEV("div",{className:"loading",children:"Loading authorization request..."},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:157,columnNumber:11},void 0)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:156,columnNumber:9},void 0)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:155,columnNumber:7},void 0):A?e.jsxDEV("div",{className:"oauth-consent",children:e.jsxDEV("div",{className:"consent-container",children:e.jsxDEV("div",{className:"error-state",children:[e.jsxDEV("h2",{children:"Authorization Error"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:168,columnNumber:13},void 0),e.jsxDEV("p",{children:A},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:169,columnNumber:13},void 0),e.jsxDEV("button",{onClick:()=>d("/"),className:"btn-primary",children:"Return Home"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:170,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:167,columnNumber:11},void 0)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:166,columnNumber:9},void 0)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:165,columnNumber:7},void 0):a?e.jsxDEV("div",{className:"oauth-consent",children:e.jsxDEV("div",{className:"consent-container",children:[e.jsxDEV("div",{className:"consent-header",children:[e.jsxDEV("div",{className:"app-icon",children:"🔐"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:187,columnNumber:11},void 0),e.jsxDEV("h1",{children:"Authorization Request"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:188,columnNumber:11},void 0),e.jsxDEV("p",{className:"user-info",children:["Signing in as ",e.jsxDEV("strong",{children:a.user.email},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:190,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:186,columnNumber:9},void 0),e.jsxDEV("div",{className:"client-info",children:[e.jsxDEV("h2",{children:a.client.name},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:195,columnNumber:11},void 0),a.client.description&&e.jsxDEV("p",{className:"client-description",children:a.client.description},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:197,columnNumber:13},void 0),e.jsxDEV("p",{className:"permission-intro",children:"This application is requesting permission to:"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:199,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:194,columnNumber:9},void 0),e.jsxDEV("div",{className:"scopes-list",children:a.requestedScopes.map(n=>e.jsxDEV("div",{className:"scope-item",children:[e.jsxDEV("span",{className:"scope-icon",children:"✓"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:207,columnNumber:15},void 0),e.jsxDEV("div",{className:"scope-details",children:[e.jsxDEV("div",{className:"scope-name",children:n.scope},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:209,columnNumber:17},void 0),e.jsxDEV("div",{className:"scope-description",children:n.description},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:210,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:208,columnNumber:15},void 0)]},n.scope,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:206,columnNumber:13},void 0))},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:204,columnNumber:9},void 0),e.jsxDEV("div",{className:"consent-actions",children:[e.jsxDEV("button",{onClick:C,disabled:h,className:"btn-secondary",children:"Deny"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:217,columnNumber:11},void 0),e.jsxDEV("button",{onClick:k,disabled:h,className:"btn-primary",children:h?"Authorizing...":"Authorize"},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:224,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:216,columnNumber:9},void 0),e.jsxDEV("div",{className:"consent-footer",children:e.jsxDEV("p",{children:["By authorizing, you allow ",e.jsxDEV("strong",{children:a.client.name},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:235,columnNumber:39},void 0)," to access your account information according to the permissions listed above. You can revoke this authorization at any time from your account settings."]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:234,columnNumber:11},void 0)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:233,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:185,columnNumber:7},void 0)},void 0,!1,{fileName:"/Applications/XAMPP/xamppfiles/htdocs/firebase sloane hub/ui/marketplace-ui-react/src/components/OAuth/OAuthConsent.jsx",lineNumber:184,columnNumber:5},void 0):null};export{w as default};
